var wn=Object.create;var Ct=Object.defineProperty,Rn=Object.defineProperties,vn=Object.getOwnPropertyDescriptor,Cn=Object.getOwnPropertyDescriptors,Pn=Object.getOwnPropertyNames,ut=Object.getOwnPropertySymbols,jn=Object.getPrototypeOf,Pt=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable;var Yt=n=>{throw TypeError(n)};var vt=(n,e,t)=>e in n?Ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$=(n,e)=>{for(var t in e||(e={}))Pt.call(e,t)&&vt(n,t,e[t]);if(ut)for(var t of ut(e))Xt.call(e,t)&&vt(n,t,e[t]);return n},ne=(n,e)=>Rn(n,Cn(e));var de=(n,e)=>{var t={};for(var r in n)Pt.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ut)for(var r of ut(n))e.indexOf(r)<0&&Xt.call(n,r)&&(t[r]=n[r]);return t};var Tn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var xn=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Pn(e))!Pt.call(n,o)&&o!==t&&Ct(n,o,{get:()=>e[o],enumerable:!(r=vn(e,o))||r.enumerable});return n};var In=(n,e,t)=>(t=n!=null?wn(jn(n)):{},xn(e||!n||!n.__esModule?Ct(t,"default",{value:n,enumerable:!0}):t,n));var je=(n,e,t)=>vt(n,typeof e!="symbol"?e+"":e,t),jt=(n,e,t)=>e.has(n)||Yt("Cannot "+t);var y=(n,e,t)=>(jt(n,e,"read from private field"),t?t.call(n):e.get(n)),T=(n,e,t)=>e.has(n)?Yt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),J=(n,e,t,r)=>(jt(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),q=(n,e,t)=>(jt(n,e,"access private method"),t);var We=(n,e,t,r)=>({set _(o){J(n,e,o,t)},get _(){return y(n,e,r)}});var k=(n,e,t)=>new Promise((r,o)=>{var l=u=>{try{s(t.next(u))}catch(c){o(c)}},a=u=>{try{s(t.throw(u))}catch(c){o(c)}},s=u=>u.done?r(u.value):Promise.resolve(u.value).then(l,a);s((t=t.apply(n,e)).next())});var ln=Tn((sn,gt)=>{(function(n,e){typeof define=="function"&&define.amd?define("uri-templates",[],e):typeof gt!="undefined"&&gt.exports?gt.exports=e():n.UriTemplate=e()})(sn,function(){var n={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},e={"*":!0},t=/[:/&?#]/;function r(s){return encodeURI(s).replace(/%25[0-9][0-9]/g,function(u){return"%"+u.substring(3)})}function o(s){return s=s.replace(/%../g,""),encodeURIComponent(s)===s}function l(s){var u="";n[s.charAt(0)]&&(u=s.charAt(0),s=s.substring(1));var c="",i="",p=!0,f=!1,g=!1;u=="+"?p=!1:u=="."?(i=".",c="."):u=="/"?(i="/",c="/"):u=="#"?(i="#",p=!1):u==";"?(i=";",c=";",f=!0,g=!0):u=="?"?(i="?",c="&",f=!0):u=="&"&&(i="&",c="&",f=!0);for(var m=[],d=s.split(","),S=[],A={},h=0;h<d.length;h++){var b=d[h],O=null;if(b.indexOf(":")!=-1){var P=b.split(":");b=P[0],O=parseInt(P[1])}for(var D={};e[b.charAt(b.length-1)];)D[b.charAt(b.length-1)]=!0,b=b.substring(0,b.length-1);var F={truncate:O,name:b,suffices:D};S.push(F),A[b]=F,m.push(b)}var B=function(R){for(var C="",H=0,K=0;K<S.length;K++){var j=S[K],w=R(j.name);if(w==null||Array.isArray(w)&&w.length==0||typeof w=="object"&&Object.keys(w).length==0){H++;continue}if(K==H?C+=i:C+=c||",",Array.isArray(w)){f&&(C+=j.name+"=");for(var ee=0;ee<w.length;ee++)ee>0&&(C+=j.suffices["*"]&&c||",",j.suffices["*"]&&f&&(C+=j.name+"=")),C+=p?encodeURIComponent(w[ee]).replace(/!/g,"%21"):r(w[ee])}else if(typeof w=="object"){f&&!j.suffices["*"]&&(C+=j.name+"=");var I=!0;for(var E in w)I||(C+=j.suffices["*"]&&c||","),I=!1,C+=p?encodeURIComponent(E).replace(/!/g,"%21"):r(E),C+=j.suffices["*"]?"=":",",C+=p?encodeURIComponent(w[E]).replace(/!/g,"%21"):r(w[E])}else f&&(C+=j.name,(!g||w!="")&&(C+="=")),j.truncate!=null&&(w=w.substring(0,j.truncate)),C+=p?encodeURIComponent(w).replace(/!/g,"%21"):r(w)}return C},pe=function(R,C,H){if(i&&(R=R.substring(i.length)),S.length==1&&S[0].suffices["*"]){for(var K=S[0],j=K.name,w=K.suffices["*"]?R.split(c||","):[R],ee=p&&R.indexOf("=")!=-1,I=1;I<w.length;I++){var R=w[I];ee&&R.indexOf("=")==-1&&(w[I-1]+=(c||",")+R,w.splice(I,1),I--)}for(var I=0;I<w.length;I++){var R=w[I];p&&R.indexOf("=")!=-1&&(ee=!0);var E=R.split(",");E.length==1?w[I]=E[0]:w[I]=E}if(f||ee){for(var te=C[j]||{},V=0;V<w.length;V++){var ve=R;if(!(f&&!ve)){if(typeof w[V]=="string"){var R=w[V],G=R.split("=",1)[0],R=R.substring(G.length+1);if(p){if(H&&!o(R))return;R=decodeURIComponent(R)}ve=R}else{var R=w[V][0],G=R.split("=",1)[0],R=R.substring(G.length+1);if(p){if(H&&!o(R))return;R=decodeURIComponent(R)}w[V][0]=R,ve=w[V]}if(p){if(H&&!o(G))return;G=decodeURIComponent(G)}te[G]!==void 0?Array.isArray(te[G])?te[G].push(ve):te[G]=[te[G],ve]:te[G]=ve}}Object.keys(te).length==1&&te[j]!==void 0?C[j]=te[j]:C[j]=te}else{if(p)for(var V=0;V<w.length;V++){var E=w[V];if(Array.isArray(E))for(var Ge=0;Ge<E.length;Ge++){if(H&&!o(E[Ge]))return;E[Ge]=decodeURIComponent(E[Ge])}else{if(H&&!o(E))return;w[V]=decodeURIComponent(E)}}C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(w):C[j]=[C[j]].concat(w):w.length==1&&!K.suffices["*"]?C[j]=w[0]:C[j]=w}}else{for(var w=S.length==1?[R]:R.split(c||","),at={},I=0;I<w.length;I++){for(var Ce=0;Ce<S.length-1&&Ce<I&&!S[Ce].suffices["*"];Ce++);if(Ce==I){at[I]=I;continue}else{for(var Pe=S.length-1;Pe>0&&S.length-Pe<w.length-I&&!S[Pe].suffices["*"];Pe--);if(S.length-Pe==w.length-I){at[I]=Pe;continue}}at[I]=Ce}for(var I=0;I<w.length;I++){var R=w[I];if(!(!R&&f)){var E=R.split(","),ee=!1;if(f){var R=E[0],j=R.split("=",1)[0],R=R.substring(j.length+1);E[0]=R;var K=A[j]||S[0]}else var K=S[at[I]],j=K.name;for(var V=0;V<E.length;V++)if(p){if(H&&!o(E[V]))return;E[V]=decodeURIComponent(E[V])}(f||K.suffices["*"])&&C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(E):C[j]=[C[j]].concat(E):E.length==1&&!K.suffices["*"]?C[j]=E[0]:C[j]=E}}}return 1};return{varNames:m,prefix:i,substitution:B,unSubstitution:pe}}function a(s){if(!(this instanceof a))return new a(s);for(var u=s.split("{"),c=[u.shift()],i=[],p=[],f=[],g=[];u.length>0;){var m=u.shift(),d=m.split("}")[0],S=m.substring(d.length+1),A=l(d);p.push(A.substitution),f.push(A.unSubstitution),i.push(A.prefix),c.push(S),g=g.concat(A.varNames)}this.fill=function(h){if(h&&typeof h!="function"){var b=h;h=function(F){return b[F]}}for(var O=c[0],P=0;P<p.length;P++){var D=p[P];O+=D(h),O+=c[P+1]}return O},this.fromUri=function(h,b){b=b||{};for(var O={},P=0;P<c.length;P++){var D=c[P];if(h.substring(0,D.length)!==D)return;if(h=h.substring(D.length),P>=c.length-1){if(h=="")break;return}var F=i[P];if(!(F&&h.substring(0,F.length)!==F)){for(var B=c[P+1],pe=P;;){if(pe==c.length-2){var R=h.substring(h.length-B.length);if(R!==B)return;var C=h.substring(0,h.length-B.length);h=R}else if(B){var H=h.indexOf(B),C=h.substring(0,H);h=h.substring(H)}else if(i[pe+1]){var H=h.indexOf(i[pe+1]);H===-1&&(H=h.length);var C=h.substring(0,H);h=h.substring(H)}else if(c.length>pe+2){pe++,B=c[pe+1];continue}else{var C=h;h=""}break}if(!f[P](C,O,b.strict))return}}return O},this.varNames=g,this.template=s}return a.prototype={toString:function(){return this.template},fillFromObject:function(s){return this.fill(s)},test:function(s,u){return!!this.fromUri(s,u)}},a})});import et from"mithril";function v(n){return typeof n=="object"&&!Array.isArray(n)&&n!==null}function Q(n,e,t){let r,o={},l;return typeof n=="string"?r=n:typeof n=="function"?l=n:n!=null&&(o=n),typeof e=="function"?l=e:e!=null&&(o=e),typeof t=="function"&&(l=t),typeof l=="undefined"&&(l=(a=>a.default(o))),[r,o,l]}import ye from"mithril";function fe(n,e,t){let r=Object.assign({},n),o={value:t.value};return me("selection",r,e,t,o)}import En from"mithril";var W=typeof window!="undefined";function N(){W&&En.redraw()}var yr=Symbol.for("@pre"),hr=Symbol.for("@post");function Jn(n,e){return n.parentArgs.store!==e.parentArgs.store||n.selector!==e.selector||n.parentArgs.value!==e.parentArgs.value}var pt=n=>{let e=Symbol("SelectionRenderer"),t=!1,r=n.attrs,o,l={};function a(){let i=!1,p=o==null,f=[];if(o==null){let m=Reflect.ownKeys(l);for(let d of m)f.includes(d)||(i=!0,delete l[d]);i&&N();return}for(let m=0;m<o.result.length;m++){let d=o.result[m],S=Symbol.for(d.pointer);if(f.push(S),Object.hasOwn(l,S)){let b=d,O=l[S].selectionResult;if(O.type==="value"&&b.type==="value"&&b.value===O.value)continue;if(O.type==="entity"&&b.type==="entity"&&b.ok===O.ok&&b.status===O.status&&b.value===O.value)continue}i=!0;let A={index:m,value:d.value,propType:d.type==="entity"?void 0:d.propType},h=fe(r.args,r.parentArgs,A);l[S]={octiron:h,selectionResult:d}}let g=Reflect.ownKeys(l);for(let m of g)f.includes(m)||(i=!0,delete l[m]);!p&&i&&N()}function s(i){return k(this,null,function*(){if(i.length===0)return;if(!W&&!r.args.mainEntity&&r.args.defer){t=!0;return}let p=[];for(let f of i)p.push(r.parentArgs.store.fetch(f,r.args.accept,{mainEntity:r.args.mainEntity}));yield Promise.allSettled(p)})}function u(i){let p=[];if(typeof o=="undefined")p=i.required;else for(let f of i.required)o.required.includes(f)||p.push(f);o=i,p.length>0&&s(p),a()}function c(){let{entity:i,selector:p,parentArgs:{value:f,store:g}}=r;if(!i&&!v(f)){g.unsubscribe(e),a();return}o=g.subscribe({key:e,selector:p,fragment:r.args.fragment,accept:r.args.accept,value:i?void 0:f,listener:u,mainEntity:r.args.mainEntity}),s(o.required),a()}return{oninit:({attrs:i})=>{r=i,c()},onbeforeupdate:({attrs:i})=>{let p=Jn(i,r);r=i,p&&(i.parentArgs.store.unsubscribe(e),c())},onbeforeremove:({attrs:i})=>{r=i,i.parentArgs.store.unsubscribe(e)},view:({attrs:i})=>{if(t)return r.args.loading;if(o==null||!o.complete)return i.args.loading;if((o.hasErrors||o.hasMissing)&&typeof i.args.fallback!="function")return i.args.fallback;if(o.result[0]!=null&&o.result[0].type==="alternative"){if(o.result[0].integration.render!=null)return o.result[0].integration.render(i.parentArgs.parent,i.args.fragment);if(o.result[0].integration.error!=null)return o.result[0].integration.error(i.args.fallback)}let p=i.view,{pre:f,sep:g,post:m,start:d,end:S,predicate:A,loading:h,fallback:b}=r.args,O=[],P=Reflect.ownKeys(l).map((D=>{let F=l[D];return F.octiron.position=-1,F}));(d!=null||S!=null)&&(P=P.slice(d!=null?d:0,S)),A!=null&&(P=P.filter(({octiron:D})=>A(D))),f!=null&&O.push(ye.fragment({},[f]));for(let D=0;D<P.length;D++){let{selectionResult:F,octiron:B}=P[D];B.position=D+1,D!==0&&O.push(ye.fragment({},[g])),F.type==="value"?O.push(ye.fragment({},[p(B)])):!F.ok&&typeof b=="function"?O.push(ye.fragment({},[b(B,F.reason)])):F.ok?O.push(ye.fragment({},[p(B)])):O.push(ye.fragment({},[b]))}return m!=null&&O.push(ye.fragment({},[m])),O}}};import kn from"mithril";function _t({style:n,propType:e,type:t,firstPickComponent:r,typeDefs:o,fallbackComponent:l}){var a,s,u;if(r!=null)return r;if(e!=null&&((a=o[e])==null?void 0:a[n])!=null)return o[e][n];if(!Array.isArray(t)&&t!=null&&((s=o[t])==null?void 0:s[n])!=null)return o[t][n];if(Array.isArray(t)){for(let c of t)if(((u=o[c])==null?void 0:u[n])!=null)return o[c][n]}if(l!=null)return l}function Te(n){if(v(n)){if(typeof n["@type"]=="string")return!0;if(!Array.isArray(n["@type"]))return!1}else return!1;for(let e of n["@type"])if(typeof e!="string")return!1;return!0}function ft(n){if(Te(n))return n["@type"]}var xe=(n,e,t,r,o)=>{var c,i,p,f;let l=Object.assign({},(c=r==null?void 0:r.attrs)!=null?c:o==null?void 0:o.attrs),a=(i=r==null?void 0:r.component)!=null?i:(r==null?void 0:r.component)!==null?o==null?void 0:o.component:null,s=(p=r==null?void 0:r.fallbackComponent)!=null?p:(r==null?void 0:r.component)!==null?o==null?void 0:o.fallbackComponent:null,u=_t({style:n,propType:t==null?void 0:t.propType,type:ft(t.value),firstPickComponent:a,fallbackComponent:s,typeDefs:(f=r==null?void 0:r.typeDefs)!=null?f:e.typeDefs});return[l,u]};var en=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=xe("present",t,r,n,e);return{view({attrs:{o:a,rendererArgs:s},children:u}){return l==null?null:kn(l,{o:a,renderType:"present",value:s.value,attrs:o},u)}}};function X(n){if(Array.isArray(n))return!0;if(v(n)){if(Array.isArray(n["@list"]))return!0;if(Array.isArray(n["@set"]))return!0}return!1}function re(n){return Array.isArray(n)?n:Array.isArray(n["@list"])?n["@list"]:Array.isArray(n["@set"])?n["@set"]:[]}import Ut from"mithril";function oe(n,e,t){let r="",o=n,l=0,a=-1;for(;(a=o.indexOf(e))>-1;)r+=n.substring(l,l+a)+t,o=o.substring(a+e.length,o.length),l+=a+e.length;return o.length>0&&(r+=n.substring(n.length-o.length,n.length)),r}function Nn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(decodeURIComponent(n[e]),"~1","/"),"~0","~"):r[e]=n[e];return r}function Mn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=encodeURIComponent(oe(oe(n[e],"~","~0"),"/","~1")):r[e]=n[e];return r}function rn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(n[e],"~1","/"),"~0","~"):r[e]=n[e];return r}function Dn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(n[e],"~","~0"),"/","~1"):r[e]=n[e];return r}function Vn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0)return[];if(n[0]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax. Non-empty pointer must begin with a solidus `/`.");return rn(n.substring(1).split("/"))}function Ze(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"":"/".concat(Dn(n).join("/"))}function Ln(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0||n[0]!=="#")throw new ReferenceError("Invalid JSON Pointer syntax; URI fragment identifiers must begin with a hash.");if(n.length===1)return[];if(n[1]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax.");return Nn(n.substring(2).split("/"))}function Ie(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"#":"#/".concat(Mn(n).join("/"))}var Tt="Invalid Relative JSON Pointer syntax. Relative pointer must begin with a non-negative integer, followed by either the number sign (#), or a JSON Pointer.";function tn(n){if(typeof n!="string")throw new TypeError("Invalid type: Relative JSON Pointers are represented as strings.");if(n.length===0)throw new ReferenceError(Tt);let e=n.split("/"),t=e[0];if(t[t.length-1]=="#"){if(e.length>1)throw new ReferenceError(Tt);t=t.substr(0,t.length-1)}let r=-1,o=t.length;for(;++r<o;)if(t[r]<"0"||t[r]>"9")throw new ReferenceError(Tt);let l=rn(e.slice(1));return l.unshift(e[0]),l}function Jt(n,e){if(typeof e=="number")return e;let t=e.length;if(!t)return-1;let r=0;if(t===1&&e[0]==="-")return Array.isArray(n)?n.length:0;for(;++r<t;)if(e[r]<"0"||e[r]>"9")return-1;return parseInt(e,10)}function Hn(n){let e="if (typeof(it) !== 'undefined'";return n.length===0?t=>t:(e=n.reduce((t,r,o)=>t+`
	&& it !== null && typeof((it = it['`+oe(oe(n[o]+"","\\","\\\\"),"'","\\'")+"'])) !== 'undefined'","if (typeof(it) !== 'undefined'"),e=e+`) {
	return it;
 }`,new Function("it",e))}function Fn(n,e,t,r=!1){if(t.length===0)throw new Error("Cannot set the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot set values on undefined");let o=n,l=t.length,a=t.length-1,s,u=-1,c,i;for(;++u<l;){if(s=t[u],typeof s!="string"&&typeof s!="number")throw new TypeError("PathSegments must be a string or a number.");if(s==="__proto__"||s==="constructor"||s==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(o)){if(s==="-"&&u===a){o.push(e);return}if(i=Jt(o,s),o.length>i){if(u===a){c=o[i],o[i]=e;break}o=o[i]}else if(u===a&&i===o.length){if(r){o.push(e);return}}else r&&(o=o[i]=u===a?e:{})}else{if(typeof o[s]=="undefined"){if(r){if(u===a){o[s]=e;return}let p=Number(t[u+1]);if(Number.isInteger(p)&&Jt(o[s],p)!==-1){o=o[s]=[];continue}o=o[s]={};continue}return}if(u===a){c=o[s],o[s]=e;break}o=o[s]}}return c}function Un(n,e){if(e.length===0)throw new Error("Cannot unset the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot unset values on undefined");let t=n,r=e.length,o=e.length-1,l,a=-1,s,u;for(;++a<r;){if(l=e[a],typeof l!="string"&&typeof l!="number")throw new TypeError("PathSegments must be a string or a number.");if(l==="__proto__"||l==="constructor"||l==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(t)){if(u=Jt(t,l),u>=t.length)return;if(a===o){s=t[u],delete t[u];break}t=t[u]}else{if(typeof t[l]=="undefined")return;if(a===o){s=t[l],delete t[l];break}t=t[l]}}return s}function $n(n){return typeof n=="string"&&n.length>0&&n[0]==="#"}function on(n){return $n(n)?Ln:Vn}function nn(n){return Array.isArray(n)?n.slice(0):on(n)(n)}function kt(n){return typeof n=="object"&&n!==null}function qn(n){return kt(n)&&!Xe.isReference(n)}function Qe(n,e,t){let r=new Map,o=[{obj:n,path:[]}];for(;o.length;){let{obj:l,path:a}=o.shift();if(e(t(a),l),qn(l))if(r.set(l,new le(Ie(a))),Array.isArray(l)){let s=-1,u=l.length;for(;++s<u;){let c=l[s];kt(c)&&r.has(c)?o.push({obj:new Xe(r.get(c)),path:a.concat([s+""])}):o.push({obj:c,path:a.concat([s+""])})}}else{let s=Object.keys(l),u=s.length,c=-1;for(;++c<u;){let i=l[s[c]];kt(i)&&r.has(i)?o.push({obj:new Xe(r.get(i)),path:a.concat(s[c])}):o.push({obj:i,path:a.concat(s[c])})}}}}var xt=Symbol("pointer"),It=Symbol("fragmentId"),Et=Symbol("getter"),le=class n{constructor(e){this.path=nn(e)}static create(e){return new n(e)}static has(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.has(e)}static get(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.get(e)}static set(e,t,r,o=!1){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.set(e,r,o)}static unset(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.unset(e)}static decode(e){return on(e)(e)}static visit(e,t,r=!1){Qe(e,t,r?Ie:Ze)}static listPointers(e){let t=[];return Qe(e,(r,o)=>{t.push({pointer:r,value:o})},Ze),t}static listFragmentIds(e){let t=[];return Qe(e,(r,o)=>{t.push({fragmentId:r,value:o})},Ie),t}static flatten(e,t=!1){let r={};return Qe(e,(o,l)=>{r[o]=l},t?Ie:Ze),r}static map(e,t=!1){let r=new Map;return Qe(e,r.set.bind(r),t?Ie:Ze),r}get(e){return this[Et]||(this[Et]=Hn(this.path)),this[Et](e)}set(e,t,r=!1){return Fn(e,t,this.path,r)}unset(e){return Un(e,this.path)}has(e){return typeof this.get(e)!="undefined"}parent(e){let t=this.path;return t.length==1?void 0:new n(t.slice(0,t.length-1)).get(e)}relative(e){let t=this.path,r=tn(e),o=parseInt(r[0]);if(o>t.length)throw new Error("Relative location does not exist.");let l=t.slice(0,t.length-o).concat(r.slice(1));if(r[0][r[0].length-1]=="#"){let a=l[l.length-1];throw new Error(`We won't compile a pointer that will always return '${a}'. Use JsonPointer.rel(target, ptr) instead.`)}return new n(l)}rel(e,t){let r=this.path,o=tn(t),l=parseInt(o[0]);if(l>r.length)return;let a=r.slice(0,r.length-l).concat(o.slice(1)),s=new n(a);if(o[0][o[0].length-1]=="#"){let u=a[a.length-1],c=s.parent(e);return Array.isArray(c)?parseInt(u,10):u}return s.get(e)}concat(e){return new n(this.path.concat(e instanceof n?e.path:nn(e)))}get pointer(){return this[xt]===void 0&&(this[xt]=Ze(this.path)),this[xt]}get uriFragmentIdentifier(){return this[It]||(this[It]=Ie(this.path)),this[It]}toString(){return this.pointer}},mt=Symbol("pointer"),Xe=class{constructor(e){this[mt]=e instanceof le?e:new le(e),this.$ref=this[mt].uriFragmentIdentifier}static isReference(e){if(!e)return!1;let t=e;return typeof t.$ref=="string"&&typeof t.resolve=="function"}resolve(e){return this[mt].get(e)}pointer(){return this[mt]}toString(){return this.$ref}};var Nt=()=>{let n,e;function t(r){if(r.submitResult==null)n=void 0,e=void 0;else if(n==null||r.submitResult.ok!==n.ok||r.submitResult.status!==n.status||r.submitResult.value!==n.value){n=r.submitResult;let o={index:0,value:r.submitResult.value};e=fe(r.args,r.parentArgs,o)}}return{oninit:({attrs:r})=>{t(r)},onbeforeupdate:({attrs:r})=>{t(r)},view:c=>{var i=c,{attrs:p}=i,f=p,{type:r,selector:o,args:l,view:a}=f,s=de(f,["type","selector","args","view"]),{children:u}=i;if(r==="initial"&&n==null)return u;if(n==null||e==null)return null;let g=r==="success"&&n.ok||r==="failure"&&!n.ok;return s.not&&(g=!g),e.position=1,g&&o!=null?e.select(o,l,a):g&&a!=null?a(e):g&&l!=null?e.present(l):(e.position=-1,null)}}};var cn=In(ln());function Mt({payload:n,action:e}){let t,r,o="get",l,a,s=e["https://schema.org/target"];if(Array.isArray(s)){for(let f of s)if(f==="string"){s=f;break}else if(v(s)&&(s["https://schema.org/contentType"]==null||s["https://schema.org/contentType"]==="mutipart/form-data"||s["https://schema.org/contentType"]==="application/ld+json")){s=f;break}}if(typeof s=="string"?t=s:v(s)&&(typeof s["https://schema.org/urlTemplate"]=="string"&&(t=s["https://schema.org/urlTemplate"]),typeof s["https://schema.org/httpMethod"]=="string"&&(o=s["https://schema.org/httpMethod"].toLowerCase()),typeof s["https://schema.org/contentType"]=="string"&&(l=s["https://schema.org/contentType"]),typeof s["https://schema.org/encodingType"]=="string"&&(a=s["https://schema.org/encodingType"])),typeof t!="string")throw new Error("Action has invalid https://schema.org/target");let u={},c=Object.assign({},n);for(let[f,g]of Object.entries(e)){if(!Te(g)||g["@type"]!=="https://schema.org/PropertyValueSpecification")continue;let m=g["https://schema.org/valueName"];if(m!=null){let d=f.replace(/-input$/,"");u[m]=n[d],delete c[m]}}let p=(0,cn.default)(t).fill(u);return o!=="get"&&o!=="delete"?r=JSON.stringify(c):(l=void 0,a=void 0),{url:p,method:o,contentType:l,encodingType:a,body:r}}import Dt from"mithril";import Bn from"mithril";var an=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=xe("edit",t,r,n,e);return{view({attrs:{o:a,rendererArgs:s},children:u}){return l==null?null:Bn(l,{o:a,attrs:o,renderType:"edit",name:a.inputName,value:s.value,spec:s.spec,onchange:s.update,onChange:s.update},u)}}};function dt(n,e){let t={};for(let[r,o]of Object.entries(e))t[n.expand(r)]=o;return t}function un(n,e,t){var a,s,u;let r=Object.assign({},n),o={action:e.action,submitting:e.submitting,value:t.value},l=me("action-selection",r,e,t,o);return l.readonly=t.spec==null?!0:(a=t.spec.readonly)!=null?a:!1,l.inputName=((s=t.spec)==null?void 0:s.name)!=null?(u=t.spec)==null?void 0:u.name:t.propType,l.submitting=e.submitting,l.action=e.action,o.updatePointer=(c,i,p,f=r.interceptor)=>{var S;let g=t.value;if(!v(g)){console.warn("Non object action change intercepted.");return}let m=Object.assign({},g),d=le.create(c);i==null?d.unset(m):d.set(m,i,!0),typeof f=="function"&&(m=f(m,g,(S=t.actionValue)==null?void 0:S.value)),e.updatePointer(t.pointer,m,p)},l.update=(c,i)=>k(null,null,function*(){let p=t.value;if(!v(p))throw new Error("Cannot call update on a non object selection instance");typeof c=="function"?t.update(c(p)):c!=null&&t.update(c),i!=null&&i.submit||i!=null&&i.submitOnChange?yield e.submit():N()}),l.submit=()=>e.submit(),l.select=(c,i,p)=>{if(!v(t.value))return null;let[f,g,m]=Q(c,i,p);return Dt(yt,{parentArgs:o,selector:f,value:t.value,actionValue:t.actionValue.value,args:g,view:m})},l.edit=c=>l.readonly?l.present(c):Dt(an,{o:l,args:c,factoryArgs:r,parentArgs:e,rendererArgs:t}),l.default=c=>l.edit(Object.assign({component:null},c)),l.initial=e.action.initial,l.success=e.action.success,l.failure=e.action.failure,l.remove=(c={})=>{if(t.propType==null)return;let i=e.parent.value,p=i[t.propType];if(X(p)){let f=re(p);f.splice(l.index,1),f.length===0&&delete i[t.propType]}else v(p)&&delete i[t.propType];N()},l.append=(c,i={},p={})=>{if(!v(t.value)){console.warn(`Attempt to append to non object octiron selection ${c}`);return}let f,g=e.store.expand(c),m=t.value[g];return v(i)&&(i=dt(l.store,i)),m==null?f=i:Array.isArray(m)?f=[...m,i]:f=[m,i],e.updatePointer(t.pointer,Object.assign({},t.value,{[g]:f}),p)},l}function pn(...n){return`${n.map(t=>t.replace(/~/g,"~0").replace(/\//g,"~1")).join("/")}`}function z(n){return v(n)&&typeof n["@id"]=="string"&&n["@id"]!==""}function ge(n){let e=Object.keys(n);if(e.length===0)return!1;for(let t of e)if(!t.startsWith("@")||t==="@value"||t==="@list"||t==="@set")return!1;return!0}function Ee(n){return typeof n["@value"]!="undefined"}var Kn=new RegExp("\\s*(?<subject>([^\\[\\s]+))(\\[(?<filter>([^\\]])+)\\])?\\s*","g");function Vt(n,e){var o,l;let t,r=[];for(;t=Kn.exec(n);){let a=(o=t.groups)==null?void 0:o.subject,s=(l=t.groups)==null?void 0:l.filter;if(typeof s=="string"&&typeof a=="string")r.push({subject:e.expand(a),filter:s});else if(typeof a=="string")r.push({subject:e.expand(a)});else throw new Error(`Invalid selector: ${n}`)}return r}var zn=/^https?\:\/\//,fn=/^https?\:\/\/schema\.org/,Gn=new RegExp("^https?\\:\\/\\/schema\\.org\\/(?<term>(readonlyValue|valueName|valueRequired|defaultValue|minValue|maxValue|stepValue|valuePattern|multipleValues|valueMinLength|valueMaxLength))");function mn({spec:n,store:e}){var l;let t={readonlyValue:!1,valueRequired:!1},r,o=e.vocab==null?!1:fn.test(e.vocab);for(let[a,s]of Object.entries(e.aliases))if(fn.test(s)){r=[a,s];break}for(let[a,s]of Object.entries(n)){let u;if(zn.test(a)?u=a:o&&!a.includes(":")?u=`${e.vocab}${a}`:r&&a.startsWith(`${r[0]}:`)&&(u=a.replace(`${r[0]}:`,r[1])),!u)continue;let c=Gn.exec(u);(l=c==null?void 0:c.groups)!=null&&l.term&&(t[c.groups.term]=s)}return{readonly:t.readonlyValue,required:t.valueRequired,name:t.valueName,min:t.minValue,max:t.maxValue,step:t.stepValue,pattern:t.valuePattern,multiple:t.multipleValues,minLength:t.valueMinLength,maxLength:t.valueMaxLength}}var Lt=class extends Error{};function gn(n){for(let e=0;e<n.result.length;e++){let t=n.result[e];t.key=Symbol.for(t.keySource),delete t.keySource}return n}function Je({selector:n,value:e,fragment:t,accept:r,actionValue:o,defaultValue:l,store:a}){let s={selector:n,complete:!1,hasErrors:!1,hasMissing:!1,required:[],dependencies:[],result:[]};if(e==null){let[{subject:c,filter:i},...p]=Vt(n,a),[f,g]=c.split("#");return _e({keySource:"",pointer:"",iri:f,fragment:g!=null?g:t,accept:r,filter:i,selector:p.length>0?p:void 0,store:a,details:s}),s.complete=s.required.length===0,gn(s)}let u=Vt(n,a);Ye({keySource:"",pointer:"",value:e,actionValue:o,selector:u,store:a,details:s,defaultValue:l}),s.complete=s.required.length===0;for(let c=0;c<s.result.length;c++){let i=s.result[c];i.key=Symbol.for(i.keySource)}return gn(s)}function Z(n,e){return`${n}/${pn(e.toString())}`}function Ht({value:n,filter:e}){return typeof e!="string"?!0:Array.isArray(n["@type"])?n["@type"].includes(e):n["@type"]===e}function Ft(n){return n!==null&&typeof n!="undefined"&&typeof n!="boolean"&&typeof n!="number"&&typeof n!="string"}function ht({keySource:n,pointer:e,value:t,propType:r,filter:o,spec:l,actionValue:a,store:s,details:u}){if(t===void 0){u.hasMissing=!0;return}else if(t===null&&v(a)){for(let c of Object.values(a))if(Te(c)&&c["@type"]==="https://schema.org/PropertyValueSpecification")return}if(l!=null&&(!X(t)||!v(a))){let c=mn({spec:l,store:s});v(t)&&Ee(t)&&(t=t["@value"]),u.result.push({keySource:e,pointer:e,type:"action-value",propType:r,value:t,actionValue:a,spec:c,readonly:c.readonly});return}if(Ft(t)){if(X(t)){let c=re(t);for(let i=0;i<c.length;i++){let p=c[i];if(z(p)||(n=Z(n,i)),ht({keySource:n,pointer:Z(e,i),value:p,spec:l,actionValue:a,propType:r,filter:o,store:s,details:u}),u.hasErrors||u.hasMissing)return}return}}else{u.result.push({keySource:e,pointer:e,type:"value",propType:r,value:t});return}if(!(typeof o=="string"&&!Ht({value:t,filter:o}))){if(Ee(t)){ht({keySource:n,pointer:e,value:t["@value"],propType:r,store:s,details:u});return}else if(ge(t)){_e({keySource:n,pointer:e,iri:t["@id"],filter:o,store:s,details:u});return}if(z(t)){let c=t["@id"];u.result.push({keySource:n,pointer:e,type:"entity",iri:c,ok:!0,value:t});return}u.result.push({keySource:n,pointer:e,type:"value",propType:r,value:t})}}function dn({keySource:n,pointer:e,propType:t,value:r,actionValue:o,filter:l,store:a,details:s}){if(e=Z(e,t),!Ft(r))return;if(X(r)){let c=re(r);for(let i=0;i<c.length;i++){let p=c[i];if(z(p)||(n=Z(n,i)),dn({keySource:n,pointer:Z(e,i),propType:t,value:p,actionValue:o,filter:l,store:a,details:s}),s.hasErrors||s.hasMissing)return}return}if(ge(r)&&z(r)){_e({keySource:n,pointer:e,iri:r["@id"],selector:[{subject:t,filter:l}],store:a,details:s});return}else if(ge(r))return;let u;v(o)&&o[`${t}-input`]==null||(v(o)&&(u=o[`${t}-input`]),ht({keySource:n,pointer:e,value:r[t],spec:u,actionValue:o==null?void 0:o[t],propType:t,filter:l,store:a,details:s}))}function Ye({keySource:n,pointer:e,selector:t,value:r,actionValue:o,store:l,details:a,defaultValue:s}){if(t.length===0)return;if(!Ft(r))return;if(X(r)){let g=re(r);for(let m=0;m<g.length;m++){let d=g[m];if(z(d)||(n=Z(n,m)),Ye({keySource:n,pointer:Z(e,m),selector:t,value:d,actionValue:o,store:l,details:a,defaultValue:s}),a.hasErrors||a.hasMissing)return}return}else Ee(r)&&Ye({keySource:n,pointer:e,selector:t,value:r["@value"],actionValue:o,store:l,details:a,defaultValue:s});if(ge(r)&&z(r)){_e({keySource:n,pointer:e,selector:t,iri:r["@id"],store:l,details:a});return}v(r)&&o!==void 0&&r[t[0].subject]==null&&(r={[t[0].subject]:s!=null?s:null});let[u,...c]=t,{subject:i,filter:p}=u;if(r[i]===void 0){a.hasMissing=!0;return}if(c.length===0&&v(o==null?void 0:o[i])){e=Z(e,i),ht({keySource:e,pointer:e,value:r[i],propType:i,details:a,store:l,actionValue:o==null?void 0:o[i],spec:o[`${i}-input`],filter:p});return}else if(c.length===0){dn({keySource:n,pointer:e,propType:i,filter:p,value:r,actionValue:o,store:l,details:a});return}if(typeof p=="string"&&!Ht({value:r,filter:p}))return;let f;v(o==null?void 0:o[i])&&(f=o[i]),Ye({keySource:Z(n,i),pointer:Z(e,i),selector:c,value:r[i],actionValue:f,store:l,details:a})}function _e({keySource:n,pointer:e,iri:t,fragment:r,accept:o,filter:l,selector:a,store:s,details:u,handledIRIs:c}){n=Z(n,t),e=Z(e,t);let i=s.entity(t,o);if(u.dependencies.push(t),i==null||i.loading){u.required.includes(t)||(u.required.push(t),u.accept=o,u.fragment=r);return}if(!i.ok){if(u.hasErrors=!0,a==null||a.length===0)return;u.result.push({keySource:n,pointer:e,type:"entity",iri:i.iri,ok:!1,status:i.status,value:i.value,reason:i.reason});return}if(i.type==="alternative-success"){u.result.push({keySource:n,pointer:e,type:"alternative",contentType:i.integration.contentType,integration:i.integration});return}let p=i.value;if(ge(p)){if(c==null)c=new Set([p["@id"]]);else if(!c.has(p["@id"]))c.add(p["@id"]);else throw new Lt("Circular selection loop detected");return _e({keySource:n,pointer:e,iri:p["@id"],filter:l,selector:a,details:u,store:s,handledIRIs:c})}if(!(typeof l=="string"&&!Ht({filter:l,value:p}))){if(typeof a=="undefined"){u.result.push({keySource:n,pointer:e,type:"entity",iri:i.iri,ok:!0,value:i.value});return}Ye({keySource:n,pointer:e,value:p,selector:a,store:s,details:u})}}var yt=n=>{let e=n.attrs,t,r={};function o(){let a=!1,{parentArgs:s,selectionArgs:u}=e,c=[];for(let p=0;p<t.result.length;p++){let f=t.result[p];if(c.push(f.pointer),r[f.pointer]!=null){let{rendererArgs:h,octiron:b}=r[f.pointer],O=P=>s.updatePointer(f.pointer,P,u);h.value=b.value=f.value,h.spec=f.spec,h.update=O;continue}a=!0;let g=h=>s.updatePointer(f.pointer,h,u),m={index:p,value:f.actionValue,propType:f.propType},d=fe(e.args,s,m),S={index:p,update:g,actionValue:d,pointer:f.pointer,propType:f.propType,value:f.value,spec:f.spec},A=un(e.args,s,S);r[f.pointer]={rendererArgs:S,selection:d,octiron:A,selectionResult:f}}let i=Object.keys(r);for(let p of i)c.includes(p)||(a=!0,delete r[p]);a&&typeof window!="undefined"&&N()}function l(){let{selector:a,value:s,actionValue:u}=e,{store:c}=e.parentArgs;v(s)&&(t=Je({selector:a,store:c,actionValue:u,value:s,defaultValue:e.args.initialValue}),o())}return{oninit:({attrs:a})=>{e=a,l()},onbeforeupdate:({attrs:a})=>{e=a;for(let s of Object.values(r))s.octiron._updateArgs("args",a.args);l()},view:({attrs:{view:a,args:s}})=>{if(t==null)return null;let{pre:u,sep:c,post:i,fallback:p}=s;if(typeof a=="undefined")return;let f=Object.values(r),g=[u];for(let m=0;m<f.length;m++){let{octiron:d,selectionResult:S}=f[m];d.position=m+1,m!==0&&g.push(c),S.value==null&&typeof p=="function"?g.push(null):S.value==null&&p!=null?g.push(p):g.push(a(d))}return g.push(i),g}}};function yn(n,e,t){let r=Object.assign(Object.create(null),n),o=Object.create(null),l;v(n.initialValue)?o=dt(e.store,n.initialValue):n.initialValue!=null&&console.warn("o.perform() only supports receiving JSON objects as initial values.");function a(){return k(this,null,function*(){let{url:g,method:m,body:d,contentType:S,encodingType:A}=Mt({payload:o,action:t.value,store:e.store});i.submitting=!0,i.url=new URL(g,i.store.rootIRI),N();try{l=yield e.store.submit(g,{method:m,body:d,contentType:S,encodingType:A})}catch(h){console.error(h)}i.submitting=!1,N()})}function s(g){let m=o,d=$($({},m),g);typeof n.interceptor=="function"?o=n.interceptor(d,m,e.parent.value):o=d,c.value=i.value=g,N()}let c={value:o,submitting:!1,submit:a,updatePointer:(g,m,d)=>{let S=Object.assign({},o),A=le.create(g);m==null?A.unset(S):A.set(S,m,!0),s(S)}},i=me("action",r,e,t,c);i.value=o,i.action=e.parent,i.actionValue=t.actionValue,c.action=i,c.submitting=i.submitting,i.select=(g,m,d)=>{let[S,A,h]=Q(g,m,d);return Ut(yt,{parentArgs:c,selector:S,value:i.value,actionValue:e.parent.value,args:A,view:h})},i.submit=function(g){return k(this,null,function*(){return typeof g=="function"?s(g(o)):g!=null&&s(g),yield a()})},i.update=function(g,m){return k(this,null,function*(){typeof g=="function"?s(g(o)):g!=null&&s(g),m!=null&&m.submit||m!=null&&m.submitOnChange?yield a():N()})},i.append=(g,m={},d={})=>{let S=e.store.expand(g);if(!v(i.value))return;let A=i.value[S],h=[];return A!=null&&!Array.isArray(A)?h.push(A):Array.isArray(A)&&(h=[...A.filter(b=>b!=null)]),h.push(m),i.update(ne($({},i.value),{[S]:h}),d)};let p=g=>m=>Ut(Nt,{not:g,type:"initial",args:{},submitResult:l,parentArgs:c},m),f=(g,m)=>(d,S,A)=>{let[h,b,O]=Q(d,S,A);return Ut(Nt,{not:m,type:g,selector:h,args:b,view:O,submitResult:l,parentArgs:c})};i.initial=p(),i.not.initial=p(!0),i.success=f("success"),i.not.success=f("success",!0),i.failure=f("failure"),i.not.failure=f("failure",!0);try{let g=Mt({payload:i.value,action:t.value,store:e.store});i.url=new URL(g.url),i.method=g.method}catch(g){console.error(g)}return i.url!=null&&(l=e.store.entity(i.url.toString())),(typeof window=="undefined"&&n.submitOnInit&&l==null||typeof window!="undefined"&&n.submitOnInit)&&i.submit(),i}var hn=({attrs:n})=>{let e=Symbol("PerformRenderer"),t=n,r,o={};function l(){let c=!1,{args:i,parentArgs:p}=t,f=[];for(let m=0;m<r.result.length;m++){let d=r.result[m];if(f.push(d.pointer),Object.hasOwn(o,d.pointer)){let O=d,P=o[d.pointer].selectionResult;if(P.type==="value"&&O.type==="value"&&O.value===P.value)continue;if(P.type==="entity"&&O.type==="entity"&&(O.ok!==P.ok||O.status!==P.status||O.value!==P.value))continue;continue}c=!0;let S={index:m,value:d.value},A=fe(i,p,S),h={index:m,value:d.value,actionValue:A},b=yn(i,p,h);o[d.pointer]={action:b,octiron:A,selectionResult:d}}let g=Object.keys(o);for(let m of g)f.includes(m)||(c=!0,delete o[m]);c&&N()}function a(c){return k(this,null,function*(){if(c.length===0)return;let i=[];for(let p of c)i.push(t.parentArgs.store.fetch(p));yield Promise.allSettled(i)})}function s(c){let i=[];if(typeof r=="undefined")i=c.required;else for(let p of c.required)r.required.includes(p)||i.push(p);r=c,i.length>0&&a(i),l()}function u(){let{selector:c,parentArgs:i}=t;if(c==null){let p;z(i.parent.value)?p={pointer:"/local",key:Symbol.for("/local"),type:"entity",iri:i.parent.value["@id"],ok:!0,value:i.parent.value}:p={pointer:"/local",key:Symbol.for("/local"),type:"value",value:i.parent.value},r={selector:"",complete:!0,hasErrors:!1,hasMissing:!1,dependencies:[],required:[],result:[p]}}else r=i.store.subscribe({key:e,selector:c,value:i.parent.value,listener:s}),a(r.required);l()}return{oninit:({attrs:c})=>{t=c,u()},onbeforeupdate:({attrs:c})=>{c.selector!==t.selector&&(c.parentArgs.store.unsubscribe(e),u()),t=c;for(let i of Object.values(o))i.action._updateArgs("args",c.args)},onbeforeremove:({attrs:c})=>{t=c,c.parentArgs.store.unsubscribe(e)},view:({attrs:{view:c,args:i}})=>{if(r==null||!r.complete)return i.loading;let{pre:p,sep:f,post:g,fallback:m}=i;if(typeof c=="undefined")return;let d=Object.values(o),S=[p];for(let A=0;A<d.length;A++){let{selectionResult:h,action:b,octiron:O}=d[A];b.position=A+1,A!==0&&S.push(f),h.type==="value"?S.push(c(b)):!h.ok&&typeof m=="function"?S.push(m(O,h.reason)):h.ok?S.push(c(b)):S.push(m)}return S.push(g),S}}};var he={root:0,selection:1,action:2,"action-selection":3};function me(n,e,t,r={},o={}){var c,i,p,f,g,m;let l=he[n],a=z(r.value)?r.value["@id"]:(c=r.propType)!=null?c:"octiron",s={[a]:(d,S)=>d(s)?S:null}[a];s.id=t.store.key(),s.isOctiron=!0,s.octironType=n,s.readonly=!0,s.value=(i=r.value)!=null?i:null,s.store=t.store,s.index=(p=r.index)!=null?p:0,s.position=-1,s.expand=d=>t.store.expand(d),o.parent=s,o.store=(f=e.store)!=null?f:t.store,o.typeDefs=(g=e.typeDefs)!=null?g:t.typeDefs,l!==he.root&&(s.propType=r.propType,s.dataType=ft(r.value)),s.not=(d,S)=>s==null||d(s)?null:S,s.get=d=>{var h,b;if(!v(s.value))return null;if(d.startsWith("@"))return s.value[d];let S=s.store.expand(d),A=(h=s.value[S])!=null?h:null;return X(A)?re(A):(b=s.value[S])!=null?b:null},s.enter=(d,S,A)=>{let[h,b,O]=Q(d,S,A);return et(pt,{entity:!0,selector:h,args:b,view:O,parentArgs:o})};let u=ne($({},o),{value:(m=t.store.entity(t.store.rootIRI))==null?void 0:m.value});switch(s.root=(d,S,A)=>{let h,[b,O,P]=Q(d,S,A);return b==null?h=t.store.rootIRI:h=`${t.store.rootIRI} ${b}`,et(pt,{entity:!0,selector:h,args:O,view:P,parentArgs:u})},l){case he.root:s.select=s.root;break;case he.selection:s.select=(d,S,A)=>{let[h,b,O]=Q(d,S,A);return v(r.value)?et(pt,{selector:h,args:b,view:O,parentArgs:o}):null}}switch(l){case he.root:s.present=s.root;break;default:s.present=d=>et(en,{o:s,args:d,factoryArgs:e,parentArgs:t,rendererArgs:r})}switch(s.default=d=>s.present(Object.assign({component:null},d)),l){case he.root:s.perform=(d,S,A)=>{let[h,b,O]=Q(d,S,A);return s.root(h,b,P=>P.perform(b,O))};break;default:{s.perform=(d,S,A)=>{let[h,b,O]=Q(d,S,A);return typeof h=="string"?s.select(h,b,P=>P.perform(b,O)):et(hn,{selector:h,args:b,view:O,parentArgs:o})};break}}if(l!==he.root){let d=(S,A)=>{let h=S==="args"?e:S==="parent"?t:r;for(let b of Object.keys(h))delete h[b];for(let[b,O]of Object.entries(A))h[b]=O};s._updateArgs=d}return s}function $t(n){return me("root",{},n)}import qt from"mithril";import{processTemplate as Bt}from"@longform/longform";function Wn(n){let e="";for(let t=0;t<n.length;t++)e+=n[t].outerHTML;return e}var Zn=()=>{let n,e;function t(o){var u;if(n===o.fragment)return;if(n=o.fragment,o.fragment==null){e=o.output.root;return}let[l,a]=o.fragment.split("?");if(a==null){e=(u=o.output.fragments[l])==null?void 0:u.html;return}let s=o.output.templates[l];if(s!=null)try{let c=Object.fromEntries(new URLSearchParams(a));e=Bt(s,c,i=>{var p;return(p=o.output.fragments[i])==null?void 0:p.html})}catch(c){console.error(c)}}function r(o){if(o.fragment==null){if(o.output.root!=null&&o.output.dom==null){let c=document.createElement("template");c.innerHTML=o.output.root,o.output.dom=Array.from(c.content.children)}e=o.output.dom;return}let[l,a]=o.fragment.split("?");if(!(a!=null||o.output.templates[l]!=null)){let c=o.output.fragments[l];if(c==null)return;if(c.type==="text"){e=c.html;return}else if(c.dom==null&&c.html!=null){let i=document.createElement("template");i.innerHTML=c.html,c.dom=Array.from(i.content.children)}else if(c.dom==null)return;e=c.dom;return}let u=o.output.templates[l];if(u!=null)try{let c=Object.fromEntries(new URLSearchParams(a));e=Bt(u,c,i=>{var p;return o.output.fragments[i]!=null&&o.output.fragments[i].html==null&&o.output.fragments[i].dom!=null&&(o.output.fragments[i].html=Wn(o.output.fragments[i].dom)),(p=o.output.fragments[i])==null?void 0:p.html})}catch(c){console.error(c)}}return{oninit({attrs:o}){W?r(o):t(o)},view(){return W&&Array.isArray(e)?qt.dom(e):typeof e=="string"?qt.trust(e):null}}},ke,Ne,Se,Ae,At,M,Me,St,bt=class bt{constructor(e,{iri:t,contentType:r,output:o}){T(this,Me);je(this,"integrationType","html-fragments");T(this,ke,!1);T(this,Ne,new Set);T(this,Se);T(this,Ae);T(this,At);T(this,M);J(this,At,e),J(this,Se,t),J(this,Ae,r),J(this,M,o)}get iri(){return y(this,Se)}get contentType(){return y(this,Ae)}get output(){return y(this,M)}getFragment(e){var t,r,o;return e!=null?(r=(t=y(this,M).fragments[e])==null?void 0:t.html)!=null?r:null:(o=y(this,M).root)!=null?o:null}text(e){if(e==null)return this.output.root==null&&y(this,M).dom&&(this.output.root=q(this,Me,St).call(this,y(this,M).dom)),this.output.root;let[t,r]=e.split("?");if(r==null){let l=y(this,M).fragments[t];return l==null?void 0:(l.html==null&&l.dom&&(l.html=q(this,Me,St).call(this,l.dom)),l.html)}let o=y(this,M).templates[t];if(o!=null)try{let l=Object.fromEntries(new URLSearchParams(r));return Bt(o,l,a=>{let s=y(this,M).fragments[a];if(s!=null)return s.html==null&&s.dom!=null&&(s.html=q(this,Me,St).call(this,s.dom)),s.html})}catch(l){console.error(l)}}render(e,t){return W||(t==null?J(this,ke,!0):y(this,Ne).add(t)),qt(Zn,{o:e,integration:this,fragment:t,output:y(this,M)})}getStateInfo(){let e={},t=[],r=Object.values(y(this,M).fragments);for(let o=0;o<r.length;o++)r[o].type==="text"?e[r[o].id]=r[o].html:t.push({id:r[o].id,type:r[o].type,selector:r[o].selector,rendered:y(this,Ne).has(r[o].id)});return{iri:y(this,Se),contentType:y(this,Ae),rendered:y(this,ke),selector:y(this,M).selector,templates:y(this,M).templates,texts:e,fragments:t}}toInitialState(){let e="",t=Object.values(y(this,M).fragments);y(this,M).root!=null&&!y(this,ke)&&(e+=`<template id="htmlfrag:${y(this,Se)}|${y(this,Ae)}">${y(this,M).root}</template>
`);for(let r=0;r<t.length;r++)t[r].type!=="text"&&(y(this,Ne).has(t[r].id)||(e+=`<template data-htmlfrag="${t[r].id}">${t[r].html}</template>
`));return e}static fromInitialState({iri:e,contentType:t,rendered:r,selector:o,texts:l,fragments:a,templates:s},u){let c=Object.create(null);if(c.fragments=Object.create(null),c.templates=s,o!=null&&r){let p=document.querySelector(o);p!=null&&(c.root=p.outerHTML)}else if(o!=null){let p=document.getElementById(`htmlfrag:${e}|${t}`);c.root=p==null?void 0:p.textContent}let i=Object.entries(l);for(let p=0;p<i.length;p++)c.fragments[i[p][0]]={id:i[p][0],type:"text",html:i[p][1],selector:""};for(let p=0;p<a.length;p++){let f=a[p],g=document.createDocumentFragment();if(f.rendered){let m;switch(f.type){case"embed":{if(m=document.getElementById(f.id),m==null)break;c.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"bare":{if(m=document.querySelector(f.selector),m==null)break;c.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"range":{let d=document.querySelectorAll(f.selector);c.fragments[f.id]={id:f.id,type:f.type,selector:f.selector,dom:Array.from(d)}}}}else{let m=document.querySelector(`[data-htmlfrag="${f.id}"]`);if(m==null)continue;c.fragments[f.id]={id:f.id,type:f.type,dom:Array.from(m.content.children),selector:f.selector}}}return new bt(u,{contentType:t,iri:e,output:c})}};ke=new WeakMap,Ne=new WeakMap,Se=new WeakMap,Ae=new WeakMap,At=new WeakMap,M=new WeakMap,Me=new WeakSet,St=function(e){let t="";for(let r=0;r<e.children.length;r++)t+=e.children[r].outerHTML;return t},je(bt,"type","html-fragments");var De=bt;var Ve,tt,Ot=class{constructor(e,t){T(this,Ve);T(this,tt);J(this,Ve,e),J(this,tt,t)}get status(){return y(this,Ve)}get res(){return y(this,tt)}undefined(){return null}http(e){return typeof e=="function"?e(y(this,Ve)):e}unparserable(){return null}};Ve=new WeakMap,tt=new WeakMap;function Le(n,e=[]){if(Array.isArray(n))for(let t of n)Le(t,e);else if(v(n)){if(ge(n))return e;if(z(n)&&e.push(n),Ee(n))Le(n["@value"],e);else if(X(n))Le(re(n),e);else for(let[t,r]of Object.entries(n))t.startsWith("@")||Le(r,e)}return e}var He,Fe,wt=class wt{constructor(e){je(this,"integrationType","unrecognized");T(this,He);T(this,Fe);J(this,He,e.iri),J(this,Fe,e.contentType)}error(e){return typeof e=="function"?e({type:"unrecognized-content-type"}):e}get iri(){return y(this,He)}get contentType(){return y(this,Fe)}getStateInfo(){return{iri:y(this,He),contentType:y(this,Fe)}}static fromInitialState({iri:e,contentType:t}){return new wt({iri:e,contentType:t})}};He=new WeakMap,Fe=new WeakMap,je(wt,"type","unrecognized-integration");var Ue=wt;var $e="application/problem+json, application/ld+json",Qn={[De.type]:De,[Ue.type]:Ue};function Xn(n,e){let t=new Map,r={};if(n!=null&&(r["@vocab"]=n),e==null)return[t,r];for(let[o,l]of Object.entries(e))r[o]=l,t.set(o,l);return[t,r]}function Yn(n,e){let t=new Headers([["accept",$e]]),r=new Map;if(n!=null)for(let[o,l]of Object.entries(n))t.set(o,l);if(e!=null)for(let[o,l]of Object.entries(e)){let a=new Headers([["accept",$e]]);for(let[s,u]of Object.entries(l))a.set(s,u);r.set(o,a)}return[t,r]}var ce,rt,ot,ae,be,Oe,qe,Y,Be,ie,it,st,lt,ct,Ke,ze,se,we,ue,U,Kt,zt,Gt,Sn,Wt,nt=class nt{constructor(e){T(this,U);T(this,ce);T(this,rt);T(this,ot);T(this,ae);T(this,be);T(this,Oe);T(this,qe);T(this,Y,new Map);T(this,Be,new Set);T(this,ie,new Map);T(this,it);T(this,st,new Set);T(this,lt);T(this,ct,new Map);T(this,Ke);T(this,ze);T(this,se,new Map);T(this,we,new Map);T(this,ue,new Map);var t,r;J(this,rt,e.rootIRI),J(this,ot,new URL(e.rootIRI).origin),J(this,Oe,e.vocab),J(this,Ke,e.fetcher),J(this,ze,e.responseHook),[We(this,ae)._,We(this,be)._]=Yn(e.headers,e.origins),[We(this,qe)._,We(this,lt)._]=Xn(e.vocab,e.aliases),J(this,it,new Map((r=(t=e.handlers)==null?void 0:t.map)==null?void 0:r.call(t,o=>[o.contentType,o]))),e.primary!=null&&J(this,Y,new Map(Object.entries(e.primary))),y(this,ae).has("accept")||y(this,ae).set("accept",$e);for(let o of Object.values(y(this,be)))o.has("accept")||o.set("accept",$e);if(e.acceptMap!=null)for(let[o,l]of Object.entries(e.acceptMap))y(this,ue).set(o,new Map(l));e.alternatives!=null&&J(this,ie,e.alternatives)}get httpStatus(){return y(this,ce)}get rootIRI(){return y(this,rt)}entity(e,t){var l,a,s,u;if(t==null)return(l=y(this,Y).get(e))!=null?l:null;let r=(s=(a=y(this,ue).get(e))==null?void 0:a.get)==null?void 0:s.call(a,t);if(r==null)return null;let o=(u=y(this,ie).get(r))==null?void 0:u.get(e);return o==null?null:{type:"alternative-success",iri:e,loading:!1,ok:!0,integration:o}}text(e,t){let[r,o]=e.split("#"),l=this.entity(r,t);if(l!=null&&(l==null?void 0:l.type)==="alternative-success"&&l.integration.text!=null)return l.integration.text(o)}get vocab(){return y(this,Oe)}get aliases(){return Object.fromEntries(y(this,qe).entries().map(([e,t])=>[e.replace(/^/,""),t]))}get context(){return y(this,lt)}expand(e){let t=Symbol.for(e),r=y(this,ct).get(t);if(r!=null)return r;let o;if(y(this,Oe)!=null&&!/^[\w\d]+\:/.test(e))o=y(this,Oe)+e;else if(/https?:\/\//.test(e))o=e;else for(let[l,a]of y(this,qe)){let s=new RegExp(`^${l}:`);if(s.test(e)){o=e.replace(s,a);break}}return y(this,ct).set(t,o!=null?o:e),o!=null?o:e}select(e,t,{accept:r}={}){return Je({selector:e,value:t,accept:r,store:this})}key(){for(;;){let e=`oct-${Math.random().toString(36).slice(2,7)}`;if(!y(this,st).has(e))return y(this,st).add(e),e}}isLoading(e){let t=q(this,U,zt).call(this,e,"get");return y(this,Be).has(t)}handleResponse(r){return k(this,arguments,function*(e,t=e.url.toString()){var a,s,u;let o=(u=(s=(a=e.headers.get("content-type"))==null?void 0:a.split)==null?void 0:s.call(a,";"))==null?void 0:u[0];if(o==null)throw new Error("Content type not specified in response");let l=y(this,it).get(o);if(l==null){console.log("UNRECOGNIZED",t,o);let c=new Ue({iri:t,contentType:o}),i=y(this,ie).get(o);i==null&&(i=new Map,y(this,ie).set(o,i)),i.set(t,c)}else if(l.integrationType==="jsonld"){let c=yield l.handler({res:e,store:this});q(this,U,Sn).call(this,{iri:t,res:e,output:c})}else{if(l.integrationType==="problem-details")throw new Error("Problem details response types not supported yet");if(l.integrationType==="html-fragments"){let c=yield l.handler({res:e,store:this}),i=y(this,ie).get(o);i==null&&(i=new Map,y(this,ie).set(o,i)),i.set(t,new De(l,{iri:t,contentType:o,output:c}))}}(l==null?void 0:l.integrationType)!=="jsonld"&&q(this,U,Gt).call(this,t,o)})}subscribe({key:e,selector:t,fragment:r,accept:o,value:l,listener:a,mainEntity:s}){let u=Je({selector:t,fragment:r,accept:o,value:l,store:this}),c=q(this,U,Kt).call(this,e,u);for(let i of u.dependencies){let p=y(this,se).get(i);p==null?y(this,se).set(i,new Set([e])):p.add(e)}return y(this,we).set(e,{key:e,selector:t,value:l,fragment:r,accept:o,required:u.required,dependencies:u.dependencies,listener:a,cleanup:c}),!W&&s&&u.hasMissing&&y(this,ce)<400&&J(this,ce,404),u}unsubscribe(e){var t;(t=y(this,we).get(e))==null||t.cleanup()}fetch(o,l){return k(this,arguments,function*(e,t,{mainEntity:r}={}){return yield q(this,U,Wt).call(this,e,{accept:t,mainEntity:r}),y(this,Y).get(e)})}submit(e,t){return k(this,null,function*(){return yield q(this,U,Wt).call(this,e,ne($({},t),{contentType:"application/ld+json"})),this.entity(e)})}static fromInitialState({disableLogs:e,rootIRI:t,vocab:r,aliases:o,headers:l,origins:a,handlers:s=[]}){performance.mark("octiron:from-initial-state:start");let u={rootIRI:t,vocab:r,aliases:o,handlers:s,headers:l,origins:a};try{let c=document.getElementById("oct-state");if(c==null)return e||console.warn("Failed to construct Octiron state from initial state"),new nt(u);let i=JSON.parse(c.innerText),p=new Map,f=s.reduce((m,d)=>ne($({},m),{[d.contentType]:d}),{});for(let[m,d]of Object.entries(i.alternatives))for(let S of d){let A=f[S.contentType],h=Qn[m];if(h.type!==A.integrationType)continue;let b=h.fromInitialState(S,A);if(b==null)continue;let O=p.get(b.contentType);O==null&&(O=new Map,p.set(b.contentType,O)),O.set(b.iri,b)}let g=new nt(ne($({},u),{alternatives:p,primary:i.primary,acceptMap:i.acceptMap}));return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),g}catch(c){e||(console.warn("Failed to construct Octiron state from initial state"),console.error(c));let i=new nt(u);return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),i}}toInitialState(){let e="",t={primary:Object.fromEntries(y(this,Y)),alternatives:{},acceptMap:{}};for(let[r,o]of y(this,ue).entries())t.acceptMap[r]=Array.from(o.entries());for(let r of y(this,ie).values())for(let o of r.values())t.alternatives[o.integrationType]==null?t.alternatives[o.integrationType]=[o.getStateInfo()]:t.alternatives[o.integrationType].push(o.getStateInfo()),o.toInitialState!=null&&(e+=o.toInitialState());return e+=`<script id="oct-state" type="application/json">${JSON.stringify(t)}<\/script>`,e}};ce=new WeakMap,rt=new WeakMap,ot=new WeakMap,ae=new WeakMap,be=new WeakMap,Oe=new WeakMap,qe=new WeakMap,Y=new WeakMap,Be=new WeakMap,ie=new WeakMap,it=new WeakMap,st=new WeakMap,lt=new WeakMap,ct=new WeakMap,Ke=new WeakMap,ze=new WeakMap,se=new WeakMap,we=new WeakMap,ue=new WeakMap,U=new WeakSet,Kt=function(e,t){return()=>{y(this,we).delete(e);for(let r of t.dependencies)y(this,se).delete(r),W&&setTimeout(()=>{var o;((o=y(this,se).get(r))==null?void 0:o.size)===0&&y(this,Y).delete(r)},5e3)}},zt=function(e,t,r){var o;return r=(o=r!=null?r:y(this,ae).get("accept"))!=null?o:$e,`${t==null?void 0:t.toLowerCase()}|${e}|${r.toLowerCase()}`},Gt=function(e,t){let r=y(this,se).get(e);if(r!=null)for(let o of r){let l=y(this,we).get(o);if(l==null)continue;let a=Je({selector:l.selector,value:l.value,fragment:l.fragment,accept:l.accept,store:this}),s=q(this,U,Kt).call(this,o,a);for(let u of a.dependencies){let c=y(this,se).get(u);c==null?(c=new Set([o]),y(this,se).set(u,c)):c.add(o)}l.cleanup=s,l.listener(a)}},Sn=function({iri:e,res:t,output:r}){let o=[e];if(t.ok)y(this,Y).set(e,{type:"entity-success",iri:e,loading:!1,ok:!0,value:r.jsonld,headers:t.headers});else{let l=new Ot(t.status,t);y(this,Y).set(e,{type:"entity-failure",iri:e,loading:!1,ok:!1,value:r.jsonld,status:t.status,headers:t.headers,reason:l})}for(let l of Le(r.jsonld))o.includes(l["@id"])||y(this,Y).set(l["@id"],{type:"entity-success",iri:l["@id"],loading:!1,ok:!0,value:l});for(let l of o)q(this,U,Gt).call(this,l)},Wt=function(r){return k(this,arguments,function*(e,t={}){var g,m,d;let o,l=new URL(e);l.hash="";let a=t.method||"get",s=(m=(g=t.accept)!=null?g:y(this,ae).get("accept"))!=null?m:$e,u=this.entity(e,s),c=(d=u==null?void 0:u.headers)==null?void 0:d.get("Etag"),i=l.toString(),p=q(this,U,zt).call(this,i,a,t.accept);if(l.origin===y(this,ot))o=new Headers(y(this,ae));else if(y(this,be).has(l.origin))o=new Headers(y(this,be).get(l.origin));else throw new Error("Unconfigured origin");o.set("accept",s),t.body!=null&&t.contentType!=null&&o.set("content-type",t.contentType),(a==="GET"&&c!=null||a==="HEAD"&&c!=null)&&o.set("If-None-Match",c),y(this,Be).add(p),N();let f=new Promise(S=>{k(this,null,function*(){var h;let A;y(this,Ke)!=null?A=yield y(this,Ke).call(this,i,{method:a,headers:o,body:t.body}):A=yield fetch(i,{method:a,headers:o,body:t.body}),!W&&(y(this,ce)==null||y(this,ce)<400)&&!A.status.toString().startsWith("3")&&J(this,ce,A.status),t.accept!=null&&y(this,ue).has(i)?(h=y(this,ue).get(i))==null||h.set(t.accept,A.headers.get("content-type")):t.accept!=null&&y(this,ue).set(i,new Map([[t.accept,A.headers.get("content-type")]])),yield this.handleResponse(A,e),y(this,Be).delete(p),N(),S(A)})});y(this,ze)!=null&&y(this,ze).call(this,f),yield f})};var Re=nt;function Zt(n,...e){let t={};if(n instanceof Re)for(let r of e)t[n.expand(r.type)]=r;else{t[n.type]=n;for(let r of e)t[r.type]=r}return t}function An(...n){let e=[];for(let t of n)if(!(typeof t=="undefined"||t===null))if(typeof t=="string")e.push(t);else if(Array.isArray(t))for(let r of t)e.push(r);else for(let[r,o]of Object.entries(t))o&&e.push(r);return e.join(" ")}function Di(n){return n}import bn from"jsonld";var Fi={integrationType:"jsonld",contentType:"application/ld+json",handler:e=>k(null,[e],function*({res:n}){let t=yield n.json();if(!v(t)&&!Array.isArray(t))throw new Error("JSON-LD Document should be an object");let r=yield bn.expand(t,{documentLoader:l=>k(null,null,function*(){let s=yield(yield fetch(l,{headers:{accept:"application/ld+json"}})).json();return{documentUrl:l,document:s}})});return{jsonld:yield bn.compact(r,{})}})};import{longform as _n}from"@longform/longform";var Bi={integrationType:"html-fragments",contentType:"text/longform",handler:e=>k(null,[e],function*({res:n}){return _n(yield n.text())})};import x from"mithril";var Qt=()=>{function n(s){return x("code",[x("span.oct-json-quote",'"'),x("a.oct-json-iri",{href:s},s),x("span.oct-json-quote",'"')])}function e(s){let u=typeof s=="boolean"?"oct-json-boolean":typeof s=="number"?"oct-json-number":"oct-json-string",c;return typeof s=="boolean"&&s?c="true":typeof s=="boolean"||(typeof s=="string"?c=[x("span.oct-json-quote",'"'),s,x("span.oct-json-quote",'"')]:c=s),x("code",{className:u},c)}function t(s,u,c=""){let i=[];for(let p=0;p<s.length;p++){let f=s[p];i.push(x("li.oct-json-arr-item",l(null,f,u,c)))}return x("ul.oct-json-arr",i)}let r=["@id","@type","@context"];function o(s,u,c=""){let i=[],p=Object.entries(s).toSorted();for(let f=0;f<p.length;f++){let[g,m]=p[f],d,S=[x("span.oct-json-quote",'"'),x("span.oct-json-obj-key",g),x("span.oct-json-quote",'"'),x("span.oct-json-obj-colon",": ")];if(g==="@id")d=[x("code",S),n(m)];else if(u==null||r.includes(g))d=l(S,m);else if(g.startsWith("@"))d=l(S,m,u,c);else{let A=`${c} ${g}`,h=new URL(u);h.searchParams.set("selector",A);let b=[x("span.oct-json-quote",'"'),x("span.oct-json-obj-key",x("a",{href:h},g)),x("span.oct-json-quote",'"'),x("span.oct-json-obj-colon",": ")];d=l(b,m,u,A)}i.push(x("li.oct-json-obj-item",d))}return x("ul.oct-json-obj",i)}function l(s,u,c,i=""){return v(u)?[x("details.oct-json-details",{open:!0},x("summary.oct-json-details-sum",x("code",s,x("span.oct-json-obj-open","{"))),a(u,c,i)),x("code.oct-json-obj-close","}")]:Array.isArray(u)?[x("details.oct-json-details",{open:!0},x("summary.oct-json-details-sum",x("code",s,x("span.oct-json-obj-open","["))),a(u,c,i)),x("code.oct-json-obj-close","]")]:[x("code",s),a(u,c,i)]}function a(s,u,c=""){return v(s)?o(s,u,c):Array.isArray(s)?t(s,u,c):e(s)}return{view:({attrs:{value:s,selector:u,location:c}})=>{let i=c!=null?new URL(c):void 0;return x(".oct-json",[l(null,s,i,typeof u=="string"?u.trim():void 0)])}}};import _ from"mithril";var Rt=({attrs:n})=>{var c;let e=n,t=n.o.value,r,o=(c=n.initialPresentationStyle)!=null?c:"value";function l(i=!0){let{o:p}=e;o==="value"?r=_(Qt,{value:t,selector:e.selector,location:e.location}):o==="action-value"&&(p.octironType==="action"||p.octironType==="action-selection")&&(r=_(Qt,{value:p.actionValue.value,selector:e.selector,location:e.location})),i&&N()}function a(i){i.redraw=!1,o="value",l()}function s(i){i.redraw=!1,o="action-value",l()}function u(i){i.redraw=!1,o="component",l()}return{oninit:({attrs:i})=>{e=i,l(!1)},onbeforeupdate:({attrs:i})=>{i.o.value!==t&&(t=i.o.value,l(!0))},view:({attrs:{o:i,availableControls:p}})=>{let f,g,m=[];return o==="component"?f=_(".oct-debug-body",i.default()):f=_(".oct-debug-body",r),(i.octironType==="action"||i.octironType==="action-selection")&&(g=_("button.oct-button",{type:"button",onclick:s},"Action value")),p==null||p.includes("value")?m.push(_("button.oct-button",{type:"button",onclick:a},"Value")):g!=null&&(p==null||p.includes("action-value"))?m.push(g):p==null||p.includes("component")?m.push(_("button.oct-button",{type:"button",onclick:u},"Component")):(p==null||p.includes("log"))&&m.push(_("button.oct-button",{type:"button",onclick:()=>console.debug(i)},"Log")),_("aside.oct-debug",_(".oct-debug-controls",_(".oct-button-group",...m)),f)}}};import L from"mithril";var ns=({attrs:n})=>{let e=n.selector||"",t=e,r=e,o=n.presentationStyle||"debug",l=n.onChange,a={view:({attrs:{o:f}})=>L(Rt,{o:f,location:n.location})};function s(f){e=f.target.value}function u(f){f.key==="Enter"&&c()}function c(){r=e,typeof l=="function"&&l(r,o)}function i(f){f.preventDefault(),o="debug",typeof l=="function"&&l(r,o)}function p(f){f.preventDefault(),o="components",typeof l=="function"&&l(r,o)}return{oninit:({attrs:f})=>{l=f.onChange},onbeforeupdate:({attrs:f})=>{var g;r=(g=f.selector)!=null?g:"",r!==t&&(e=t=r),l=f.onChange},view:({attrs:{autofocus:f,o:g}})=>{var h,b;let m,d,S,A;if(r.length!==0&&o==="debug"?m=g.root(r,O=>L(Rt,{o:O,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?[]:void 0})):r.length!==0?m=g.root(r,O=>L("div",O.default({fallbackComponent:a,attrs:{selector:r}}))):o==="debug"?m=g.root(O=>L(Rt,{o:O,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?void 0:[]})):m=g.root(O=>L("div",O.default({fallbackComponent:a,attrs:{selector:r}}))),n.location!=null&&r.length!==0){let O=n.selector.trim().includes(" ")?n.selector.replace(/\s+([^\s]+)$/,""):"";d=new URL(n.location),O!=null?d.searchParams.set("selector",O):d.searchParams.delete("selector")}return n.location!=null&&(S=new URL(n.location),A=new URL(n.location),S.searchParams.set("presentationStyle","debug"),A.searchParams.set("presentationStyle","components")),L(".oct-explorer",L(".oct-explorer-controls",L("form.oct-form-group",{action:(b=(h=n.location)==null?void 0:h.toString)==null?void 0:b.call(h),onsubmit:O=>{O.preventDefault(),c()}},[d!=null?L("a.oct-button",{href:d.toString()},"Up"):L("button.oct-button",{type:"button",disabled:!0},"Up"),L("input",{name:"selector",value:e,autofocus:f,oninput:s,onkeypress:u}),L("button.oct-button",{type:"submit",disabled:r===e&&typeof window!="undefined"},"Apply")]),L(".oct-button-group",o==="debug"||S==null?L("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:i},"Debug"):L("a.oct-button",{href:S.toString(),onclick:i},"Debug"),o==="components"||A==null?L("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:p},"Components"):L("a.oct-button",{href:A.toString(),onclick:p},"Components"))),L("pre.oct-explorer-body",m))}}};import er from"mithril";var is=n=>{var o;let t=((o=n.attrs.o.method)==null?void 0:o.toUpperCase())||"POST",r={GET:"application/x-www-form-urlencoded",POST:"multipart/form-data"};return{view:u=>{var c=u,{attrs:i}=c,p=i,{o:l}=p,a=de(p,["o"]),{children:s}=c;return er("form.oct-form",ne($({},a),{method:t,enctype:r[t||"GET"],action:l.url,onsubmit:f=>{f.preventDefault(),l.submit()}}),s)}}};import tr from"mithril";var us=()=>({view:({attrs:n,children:e})=>tr("button.oct-button.oct-submit-button",{id:n.id,type:"submit",class:An(n.class)},e)});function On(t){var r=t,{typeDefs:n}=r,e=de(r,["typeDefs"]);let o=new Re(e),l=n!=null?Zt(o,...n):{};return $t({store:o,typeDefs:l})}On.fromInitialState=t=>{var r=t,{typeDefs:n}=r,e=de(r,["typeDefs"]);let o=Re.fromInitialState($({},e)),l=n!=null?Zt(o,...n):{};return $t({store:o,typeDefs:l})};export{Rt as OctironDebug,ns as OctironExplorer,is as OctironForm,Qt as OctironJSON,us as OctironSubmitButton,Re as Store,An as classes,On as default,Fi as jsonLDHandler,Bi as longformHandler,Di as makeTypeDef,Zt as makeTypeDefs};
//# sourceMappingURL=octiron.min.js.map
