var yn=Object.create;var bt=Object.defineProperty,hn=Object.defineProperties,Sn=Object.getOwnPropertyDescriptor,bn=Object.getOwnPropertyDescriptors,An=Object.getOwnPropertyNames,it=Object.getOwnPropertySymbols,On=Object.getPrototypeOf,At=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable;var Wt=n=>{throw TypeError(n)};var St=(n,e,t)=>e in n?bt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$=(n,e)=>{for(var t in e||(e={}))At.call(e,t)&&St(n,t,e[t]);if(it)for(var t of it(e))Kt.call(e,t)&&St(n,t,e[t]);return n},Z=(n,e)=>hn(n,bn(e));var me=(n,e)=>{var t={};for(var r in n)At.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&it)for(var r of it(n))e.indexOf(r)<0&&Kt.call(n,r)&&(t[r]=n[r]);return t};var wn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Rn=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of An(e))!At.call(n,o)&&o!==t&&bt(n,o,{get:()=>e[o],enumerable:!(r=Sn(e,o))||r.enumerable});return n};var vn=(n,e,t)=>(t=n!=null?yn(On(n)):{},Rn(e||!n||!n.__esModule?bt(t,"default",{value:n,enumerable:!0}):t,n));var Ot=(n,e,t)=>St(n,typeof e!="symbol"?e+"":e,t),wt=(n,e,t)=>e.has(n)||Wt("Cannot "+t);var h=(n,e,t)=>(wt(n,e,"read from private field"),t?t.call(n):e.get(n)),I=(n,e,t)=>e.has(n)?Wt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),D=(n,e,t,r)=>(wt(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),F=(n,e,t)=>(wt(n,e,"access private method"),t);var qe=(n,e,t,r)=>({set _(o){D(n,e,o,t)},get _(){return h(n,e,r)}});var J=(n,e,t)=>new Promise((r,o)=>{var c=a=>{try{i(t.next(a))}catch(s){o(s)}},u=a=>{try{i(t.throw(a))}catch(s){o(s)}},i=a=>a.done?r(a.value):Promise.resolve(a.value).then(c,u);i((t=t.apply(n,e)).next())});var en=wn((Zt,at)=>{(function(n,e){typeof define=="function"&&define.amd?define("uri-templates",[],e):typeof at!="undefined"&&at.exports?at.exports=e():n.UriTemplate=e()})(Zt,function(){var n={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},e={"*":!0},t=/[:/&?#]/;function r(i){return encodeURI(i).replace(/%25[0-9][0-9]/g,function(a){return"%"+a.substring(3)})}function o(i){return i=i.replace(/%../g,""),encodeURIComponent(i)===i}function c(i){var a="";n[i.charAt(0)]&&(a=i.charAt(0),i=i.substring(1));var s="",l="",p=!0,f=!1,d=!1;a=="+"?p=!1:a=="."?(l=".",s="."):a=="/"?(l="/",s="/"):a=="#"?(l="#",p=!1):a==";"?(l=";",s=";",f=!0,d=!0):a=="?"?(l="?",s="&",f=!0):a=="&"&&(l="&",s="&",f=!0);for(var m=[],y=i.split(","),S=[],A={},g=0;g<y.length;g++){var b=y[g],O=null;if(b.indexOf(":")!=-1){var j=b.split(":");b=j[0],O=parseInt(j[1])}for(var q={};e[b.charAt(b.length-1)];)q[b.charAt(b.length-1)]=!0,b=b.substring(0,b.length-1);var U={truncate:O,name:b,suffices:q};S.push(U),A[b]=U,m.push(b)}var ce=function(R){for(var C="",L=0,B=0;B<S.length;B++){var P=S[B],w=R(P.name);if(w==null||Array.isArray(w)&&w.length==0||typeof w=="object"&&Object.keys(w).length==0){L++;continue}if(B==L?C+=l:C+=s||",",Array.isArray(w)){f&&(C+=P.name+"=");for(var X=0;X<w.length;X++)X>0&&(C+=P.suffices["*"]&&s||",",P.suffices["*"]&&f&&(C+=P.name+"=")),C+=p?encodeURIComponent(w[X]).replace(/!/g,"%21"):r(w[X])}else if(typeof w=="object"){f&&!P.suffices["*"]&&(C+=P.name+"=");var T=!0;for(var k in w)T||(C+=P.suffices["*"]&&s||","),T=!1,C+=p?encodeURIComponent(k).replace(/!/g,"%21"):r(k),C+=P.suffices["*"]?"=":",",C+=p?encodeURIComponent(w[k]).replace(/!/g,"%21"):r(w[k])}else f&&(C+=P.name,(!d||w!="")&&(C+="=")),P.truncate!=null&&(w=w.substring(0,P.truncate)),C+=p?encodeURIComponent(w).replace(/!/g,"%21"):r(w)}return C},le=function(R,C,L){if(l&&(R=R.substring(l.length)),S.length==1&&S[0].suffices["*"]){for(var B=S[0],P=B.name,w=B.suffices["*"]?R.split(s||","):[R],X=p&&R.indexOf("=")!=-1,T=1;T<w.length;T++){var R=w[T];X&&R.indexOf("=")==-1&&(w[T-1]+=(s||",")+R,w.splice(T,1),T--)}for(var T=0;T<w.length;T++){var R=w[T];p&&R.indexOf("=")!=-1&&(X=!0);var k=R.split(",");k.length==1?w[T]=k[0]:w[T]=k}if(f||X){for(var Y=C[P]||{},M=0;M<w.length;M++){var Ce=R;if(!(f&&!Ce)){if(typeof w[M]=="string"){var R=w[M],W=R.split("=",1)[0],R=R.substring(W.length+1);if(p){if(L&&!o(R))return;R=decodeURIComponent(R)}Ce=R}else{var R=w[M][0],W=R.split("=",1)[0],R=R.substring(W.length+1);if(p){if(L&&!o(R))return;R=decodeURIComponent(R)}w[M][0]=R,Ce=w[M]}if(p){if(L&&!o(W))return;W=decodeURIComponent(W)}Y[W]!==void 0?Array.isArray(Y[W])?Y[W].push(Ce):Y[W]=[Y[W],Ce]:Y[W]=Ce}}Object.keys(Y).length==1&&Y[P]!==void 0?C[P]=Y[P]:C[P]=Y}else{if(p)for(var M=0;M<w.length;M++){var k=w[M];if(Array.isArray(k))for(var $e=0;$e<k.length;$e++){if(L&&!o(k[$e]))return;k[$e]=decodeURIComponent(k[$e])}else{if(L&&!o(k))return;w[M]=decodeURIComponent(k)}}C[P]!==void 0?Array.isArray(C[P])?C[P]=C[P].concat(w):C[P]=[C[P]].concat(w):w.length==1&&!B.suffices["*"]?C[P]=w[0]:C[P]=w}}else{for(var w=S.length==1?[R]:R.split(s||","),ot={},T=0;T<w.length;T++){for(var Pe=0;Pe<S.length-1&&Pe<T&&!S[Pe].suffices["*"];Pe++);if(Pe==T){ot[T]=T;continue}else{for(var je=S.length-1;je>0&&S.length-je<w.length-T&&!S[je].suffices["*"];je--);if(S.length-je==w.length-T){ot[T]=je;continue}}ot[T]=Pe}for(var T=0;T<w.length;T++){var R=w[T];if(!(!R&&f)){var k=R.split(","),X=!1;if(f){var R=k[0],P=R.split("=",1)[0],R=R.substring(P.length+1);k[0]=R;var B=A[P]||S[0]}else var B=S[ot[T]],P=B.name;for(var M=0;M<k.length;M++)if(p){if(L&&!o(k[M]))return;k[M]=decodeURIComponent(k[M])}(f||B.suffices["*"])&&C[P]!==void 0?Array.isArray(C[P])?C[P]=C[P].concat(k):C[P]=[C[P]].concat(k):k.length==1&&!B.suffices["*"]?C[P]=k[0]:C[P]=k}}}return 1};return{varNames:m,prefix:l,substitution:ce,unSubstitution:le}}function u(i){if(!(this instanceof u))return new u(i);for(var a=i.split("{"),s=[a.shift()],l=[],p=[],f=[],d=[];a.length>0;){var m=a.shift(),y=m.split("}")[0],S=m.substring(y.length+1),A=c(y);p.push(A.substitution),f.push(A.unSubstitution),l.push(A.prefix),s.push(S),d=d.concat(A.varNames)}this.fill=function(g){if(g&&typeof g!="function"){var b=g;g=function(U){return b[U]}}for(var O=s[0],j=0;j<p.length;j++){var q=p[j];O+=q(g),O+=s[j+1]}return O},this.fromUri=function(g,b){b=b||{};for(var O={},j=0;j<s.length;j++){var q=s[j];if(g.substring(0,q.length)!==q)return;if(g=g.substring(q.length),j>=s.length-1){if(g=="")break;return}var U=l[j];if(!(U&&g.substring(0,U.length)!==U)){for(var ce=s[j+1],le=j;;){if(le==s.length-2){var R=g.substring(g.length-ce.length);if(R!==ce)return;var C=g.substring(0,g.length-ce.length);g=R}else if(ce){var L=g.indexOf(ce),C=g.substring(0,L);g=g.substring(L)}else if(l[le+1]){var L=g.indexOf(l[le+1]);L===-1&&(L=g.length);var C=g.substring(0,L);g=g.substring(L)}else if(s.length>le+2){le++,ce=s[le+1];continue}else{var C=g;g=""}break}if(!f[j](C,O,b.strict))return}}return O},this.varNames=d,this.template=i}return u.prototype={toString:function(){return this.template},fillFromObject:function(i){return this.fill(i)},test:function(i,a){return!!this.fromUri(i,a)}},u})});import ze from"mithril";function v(n){return typeof n=="object"&&!Array.isArray(n)&&n!==null}function ee(n,e,t){let r,o={},c;return typeof n=="string"?r=n:typeof n=="function"?c=n:n!=null&&(o=n),typeof e=="function"?c=e:e!=null&&(o=e),typeof t=="function"&&(c=t),typeof c=="undefined"&&(c=(u=>u.default(o))),[r,o,c]}import ge from"mithril";function ae(n,e,t){let r=Object.assign({},n),o={value:t.value};return ue("selection",r,e,t,o)}import Cn from"mithril";var de=typeof window!="undefined";function E(){de&&Cn.redraw()}var Pn=Symbol.for("@pre"),jn=Symbol.for("@post");function xn(n,e){return n.parentArgs.store!==e.parentArgs.store||n.selector!==e.selector||n.parentArgs.value!==e.parentArgs.value}var st=n=>{let e=Symbol("SelectionRenderer"),t=n.attrs,r,o={};function c(){let s=!1,l=r==null,p=[];if(r==null){let d=Reflect.ownKeys(o);for(let m of d)p.includes(m)||(s=!0,delete o[m]);s&&E();return}for(let d=0;d<r.result.length;d++){let m=r.result[d],y=Symbol.for(m.pointer);if(p.push(y),Object.hasOwn(o,y)){let g=m,b=o[y].selectionResult;if(b.type==="value"&&g.type==="value"&&g.value===b.value)continue;if(b.type==="entity"&&g.type==="entity"&&(g.ok!==b.ok||g.status!==b.status||g.value!==b.value))continue}s=!0;let S={index:d,value:m.value,propType:m.type==="entity"?void 0:m.propType},A=ae(t.args,t.parentArgs,S);o[y]={octiron:A,selectionResult:m}}let f=Reflect.ownKeys(o);for(let d of f)p.includes(d)||(s=!0,delete o[d]);!l&&s&&E()}function u(s,l){return J(this,null,function*(){if(s.length===0)return;let p=[];for(let f of s)p.push(t.parentArgs.store.fetch(f,l));yield Promise.allSettled(p)})}function i(s){let l=[];if(typeof r=="undefined")l=s.required;else for(let p of s.required)r.required.includes(p)||l.push(p);r=s,l.length>0&&u(l,r.accept),c()}function a(){let{entity:s,selector:l,parentArgs:{value:p,store:f},args:{accept:d,fragment:m}}=t;if(!s&&!v(p)){f.unsubscribe(e),c();return}r=f.subscribe({key:e,selector:l,fragment:m,accept:d,value:s?void 0:p,listener:i}),u(r.required,d),c()}return{oninit:({attrs:s})=>{t=s,a()},onbeforeupdate:({attrs:s})=>{let l=xn(s,t);t=s,l&&(s.parentArgs.store.unsubscribe(e),a())},onbeforeremove:({attrs:s})=>{t=s,s.parentArgs.store.unsubscribe(e)},view:({attrs:s})=>{if(r==null||!r.complete)return s.args.loading;if((r.hasErrors||r.hasMissing)&&typeof s.args.fallback!="function")return s.args.fallback;if(r.result[0].type==="alternative")return r.result[0].integration.render(null,s.args.fragment);let l=t.view,{pre:p,sep:f,post:d,start:m,end:y,predicate:S,fallback:A}=t.args,g=[],b=Reflect.ownKeys(o).map((O=>{let j=o[O];return j.octiron.position=-1,j}));(m!=null||y!=null)&&(b=b.slice(m!=null?m:0,y)),S!=null&&(b=b.filter(({octiron:O})=>S(O))),p!=null&&g.push(ge.fragment({key:Pn},[p]));for(let O=0;O<b.length;O++){let{selectionResult:j,octiron:q}=b[O],{key:U}=j;q.position=O+1,O!==0&&g.push(ge.fragment({key:`@${Symbol.keyFor(U)}`},[f])),j.type==="value"?g.push(ge.fragment({key:U},[l(q)])):!j.ok&&typeof A=="function"?g.push(ge.fragment({key:U},[A(q,j.reason)])):j.ok?g.push(ge.fragment({key:U},[l(q)])):g.push(ge.fragment({key:U},[A]))}return d!=null&&g.push(ge.fragment({key:jn},[d])),g}}};import Tn from"mithril";function Gt({style:n,propType:e,type:t,firstPickComponent:r,typeDefs:o,fallbackComponent:c}){var u,i,a;if(r!=null)return r;if(e!=null&&((u=o[e])==null?void 0:u[n])!=null)return o[e][n];if(!Array.isArray(t)&&t!=null&&((i=o[t])==null?void 0:i[n])!=null)return o[t][n];if(Array.isArray(t)){for(let s of t)if(((a=o[s])==null?void 0:a[n])!=null)return o[s][n]}if(c!=null)return c}function xe(n){if(v(n)){if(typeof n["@type"]=="string")return!0;if(!Array.isArray(n["@type"]))return!1}else return!1;for(let e of n["@type"])if(typeof e!="string")return!1;return!0}function ct(n){if(xe(n))return n["@type"]}var Te=(n,e,t,r,o)=>{var s,l,p,f;let c=Object.assign({},(s=r==null?void 0:r.attrs)!=null?s:o==null?void 0:o.attrs),u=(l=r==null?void 0:r.component)!=null?l:(r==null?void 0:r.component)!==null?o==null?void 0:o.component:null,i=(p=r==null?void 0:r.fallbackComponent)!=null?p:(r==null?void 0:r.component)!==null?o==null?void 0:o.fallbackComponent:null,a=Gt({style:n,propType:t==null?void 0:t.propType,type:ct(t.value),firstPickComponent:u,fallbackComponent:i,typeDefs:(f=r==null?void 0:r.typeDefs)!=null?f:e.typeDefs});return[c,a]};var _t=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,c]=Te("present",t,r,n,e);return{view({attrs:{o:u,rendererArgs:i},children:a}){return c==null?null:Tn(c,{o:u,renderType:"present",value:i.value,attrs:o},a)}}};function _(n){if(Array.isArray(n))return!0;if(v(n)){if(Array.isArray(n["@list"]))return!0;if(Array.isArray(n["@set"]))return!0}return!1}function te(n){return Array.isArray(n)?n:Array.isArray(n["@list"])?n["@list"]:Array.isArray(n["@set"])?n["@set"]:[]}import Mt from"mithril";function ne(n,e,t){let r="",o=n,c=0,u=-1;for(;(u=o.indexOf(e))>-1;)r+=n.substring(c,c+u)+t,o=o.substring(u+e.length,o.length),c+=u+e.length;return o.length>0&&(r+=n.substring(n.length-o.length,n.length)),r}function In(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=ne(ne(decodeURIComponent(n[e]),"~1","/"),"~0","~"):r[e]=n[e];return r}function kn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=encodeURIComponent(ne(ne(n[e],"~","~0"),"/","~1")):r[e]=n[e];return r}function Xt(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=ne(ne(n[e],"~1","/"),"~0","~"):r[e]=n[e];return r}function Jn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=ne(ne(n[e],"~","~0"),"/","~1"):r[e]=n[e];return r}function En(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0)return[];if(n[0]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax. Non-empty pointer must begin with a solidus `/`.");return Xt(n.substring(1).split("/"))}function Be(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"":"/".concat(Jn(n).join("/"))}function Dn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0||n[0]!=="#")throw new ReferenceError("Invalid JSON Pointer syntax; URI fragment identifiers must begin with a hash.");if(n.length===1)return[];if(n[1]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax.");return In(n.substring(2).split("/"))}function Ie(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"#":"#/".concat(kn(n).join("/"))}var Rt="Invalid Relative JSON Pointer syntax. Relative pointer must begin with a non-negative integer, followed by either the number sign (#), or a JSON Pointer.";function zt(n){if(typeof n!="string")throw new TypeError("Invalid type: Relative JSON Pointers are represented as strings.");if(n.length===0)throw new ReferenceError(Rt);let e=n.split("/"),t=e[0];if(t[t.length-1]=="#"){if(e.length>1)throw new ReferenceError(Rt);t=t.substr(0,t.length-1)}let r=-1,o=t.length;for(;++r<o;)if(t[r]<"0"||t[r]>"9")throw new ReferenceError(Rt);let c=Xt(e.slice(1));return c.unshift(e[0]),c}function jt(n,e){if(typeof e=="number")return e;let t=e.length;if(!t)return-1;let r=0;if(t===1&&e[0]==="-")return Array.isArray(n)?n.length:0;for(;++r<t;)if(e[r]<"0"||e[r]>"9")return-1;return parseInt(e,10)}function Nn(n){let e="if (typeof(it) !== 'undefined'";return n.length===0?t=>t:(e=n.reduce((t,r,o)=>t+`
	&& it !== null && typeof((it = it['`+ne(ne(n[o]+"","\\","\\\\"),"'","\\'")+"'])) !== 'undefined'","if (typeof(it) !== 'undefined'"),e=e+`) {
	return it;
 }`,new Function("it",e))}function Mn(n,e,t,r=!1){if(t.length===0)throw new Error("Cannot set the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot set values on undefined");let o=n,c=t.length,u=t.length-1,i,a=-1,s,l;for(;++a<c;){if(i=t[a],typeof i!="string"&&typeof i!="number")throw new TypeError("PathSegments must be a string or a number.");if(i==="__proto__"||i==="constructor"||i==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(o)){if(i==="-"&&a===u){o.push(e);return}if(l=jt(o,i),o.length>l){if(a===u){s=o[l],o[l]=e;break}o=o[l]}else if(a===u&&l===o.length){if(r){o.push(e);return}}else r&&(o=o[l]=a===u?e:{})}else{if(typeof o[i]=="undefined"){if(r){if(a===u){o[i]=e;return}let p=Number(t[a+1]);if(Number.isInteger(p)&&jt(o[i],p)!==-1){o=o[i]=[];continue}o=o[i]={};continue}return}if(a===u){s=o[i],o[i]=e;break}o=o[i]}}return s}function Vn(n,e){if(e.length===0)throw new Error("Cannot unset the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot unset values on undefined");let t=n,r=e.length,o=e.length-1,c,u=-1,i,a;for(;++u<r;){if(c=e[u],typeof c!="string"&&typeof c!="number")throw new TypeError("PathSegments must be a string or a number.");if(c==="__proto__"||c==="constructor"||c==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(t)){if(a=jt(t,c),a>=t.length)return;if(u===o){i=t[a],delete t[a];break}t=t[a]}else{if(typeof t[c]=="undefined")return;if(u===o){i=t[c],delete t[c];break}t=t[c]}}return i}function Ln(n){return typeof n=="string"&&n.length>0&&n[0]==="#"}function Yt(n){return Ln(n)?Dn:En}function Qt(n){return Array.isArray(n)?n.slice(0):Yt(n)(n)}function xt(n){return typeof n=="object"&&n!==null}function Hn(n){return xt(n)&&!We.isReference(n)}function Ke(n,e,t){let r=new Map,o=[{obj:n,path:[]}];for(;o.length;){let{obj:c,path:u}=o.shift();if(e(t(u),c),Hn(c))if(r.set(c,new oe(Ie(u))),Array.isArray(c)){let i=-1,a=c.length;for(;++i<a;){let s=c[i];xt(s)&&r.has(s)?o.push({obj:new We(r.get(s)),path:u.concat([i+""])}):o.push({obj:s,path:u.concat([i+""])})}}else{let i=Object.keys(c),a=i.length,s=-1;for(;++s<a;){let l=c[i[s]];xt(l)&&r.has(l)?o.push({obj:new We(r.get(l)),path:u.concat(i[s])}):o.push({obj:l,path:u.concat(i[s])})}}}}var vt=Symbol("pointer"),Ct=Symbol("fragmentId"),Pt=Symbol("getter"),oe=class n{constructor(e){this.path=Qt(e)}static create(e){return new n(e)}static has(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.has(e)}static get(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.get(e)}static set(e,t,r,o=!1){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.set(e,r,o)}static unset(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.unset(e)}static decode(e){return Yt(e)(e)}static visit(e,t,r=!1){Ke(e,t,r?Ie:Be)}static listPointers(e){let t=[];return Ke(e,(r,o)=>{t.push({pointer:r,value:o})},Be),t}static listFragmentIds(e){let t=[];return Ke(e,(r,o)=>{t.push({fragmentId:r,value:o})},Ie),t}static flatten(e,t=!1){let r={};return Ke(e,(o,c)=>{r[o]=c},t?Ie:Be),r}static map(e,t=!1){let r=new Map;return Ke(e,r.set.bind(r),t?Ie:Be),r}get(e){return this[Pt]||(this[Pt]=Nn(this.path)),this[Pt](e)}set(e,t,r=!1){return Mn(e,t,this.path,r)}unset(e){return Vn(e,this.path)}has(e){return typeof this.get(e)!="undefined"}parent(e){let t=this.path;return t.length==1?void 0:new n(t.slice(0,t.length-1)).get(e)}relative(e){let t=this.path,r=zt(e),o=parseInt(r[0]);if(o>t.length)throw new Error("Relative location does not exist.");let c=t.slice(0,t.length-o).concat(r.slice(1));if(r[0][r[0].length-1]=="#"){let u=c[c.length-1];throw new Error(`We won't compile a pointer that will always return '${u}'. Use JsonPointer.rel(target, ptr) instead.`)}return new n(c)}rel(e,t){let r=this.path,o=zt(t),c=parseInt(o[0]);if(c>r.length)return;let u=r.slice(0,r.length-c).concat(o.slice(1)),i=new n(u);if(o[0][o[0].length-1]=="#"){let a=u[u.length-1],s=i.parent(e);return Array.isArray(s)?parseInt(a,10):a}return i.get(e)}concat(e){return new n(this.path.concat(e instanceof n?e.path:Qt(e)))}get pointer(){return this[vt]===void 0&&(this[vt]=Be(this.path)),this[vt]}get uriFragmentIdentifier(){return this[Ct]||(this[Ct]=Ie(this.path)),this[Ct]}toString(){return this.pointer}},lt=Symbol("pointer"),We=class{constructor(e){this[lt]=e instanceof oe?e:new oe(e),this.$ref=this[lt].uriFragmentIdentifier}static isReference(e){if(!e)return!1;let t=e;return typeof t.$ref=="string"&&typeof t.resolve=="function"}resolve(e){return this[lt].get(e)}pointer(){return this[lt]}toString(){return this.$ref}};var Tt=()=>{let n,e;function t(r){if(r.submitResult==null)n=void 0,e=void 0;else if(n==null||r.submitResult.ok!==n.ok||r.submitResult.status!==n.status||r.submitResult.value!==n.value){n=r.submitResult;let o={index:0,value:r.submitResult.value};e=ae(r.args,r.parentArgs,o)}}return{oninit:({attrs:r})=>{t(r)},onbeforeupdate:({attrs:r})=>{t(r)},view:s=>{var l=s,{attrs:p}=l,f=p,{type:r,selector:o,args:c,view:u}=f,i=me(f,["type","selector","args","view"]),{children:a}=l;if(r==="initial"&&n==null)return a;if(n==null||e==null)return null;let d=r==="success"&&n.ok||r==="failure"&&!n.ok;return i.not&&(d=!d),e.position=1,d&&o!=null?e.select(o,c,u):d&&u!=null?u(e):d&&c!=null?e.present(c):(e.position=-1,null)}}};var tn=vn(en());function It({payload:n,action:e}){let t,r,o="get",c,u,i=e["https://schema.org/target"];if(Array.isArray(i)){for(let f of i)if(f==="string"){i=f;break}else if(v(i)&&(i["https://schema.org/contentType"]==null||i["https://schema.org/contentType"]==="mutipart/form-data"||i["https://schema.org/contentType"]==="application/ld+json")){i=f;break}}if(typeof i=="string"?t=i:v(i)&&(typeof i["https://schema.org/urlTemplate"]=="string"&&(t=i["https://schema.org/urlTemplate"]),typeof i["https://schema.org/httpMethod"]=="string"&&(o=i["https://schema.org/httpMethod"].toLowerCase()),typeof i["https://schema.org/contentType"]=="string"&&(c=i["https://schema.org/contentType"]),typeof i["https://schema.org/encodingType"]=="string"&&(u=i["https://schema.org/encodingType"])),typeof t!="string")throw new Error("Action has invalid https://schema.org/target");let a={},s=Object.assign({},n);for(let[f,d]of Object.entries(e)){if(!xe(d)||d["@type"]!=="https://schema.org/PropertyValueSpecification")continue;let m=d["https://schema.org/valueName"];if(m!=null){let y=f.replace(/-input$/,"");a[m]=n[y],delete s[m]}}let p=(0,tn.default)(t).fill(a);return o!=="get"&&o!=="delete"&&(r=JSON.stringify(s)),{url:p,method:o,contentType:c,encodingType:u,body:r}}import kt from"mithril";import Fn from"mithril";var nn=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,c]=Te("edit",t,r,n,e);return{view({attrs:{o:u,rendererArgs:i},children:a}){return c==null?null:Fn(c,{o:u,attrs:o,renderType:"edit",name:u.inputName,value:i.value,spec:i.spec,onchange:i.update,onChange:i.update},a)}}};function rn(n,e,t){var u,i,a;let r=Object.assign({},n),o={action:e.action,submitting:e.submitting,value:t.value},c=ue("action-selection",r,e,t,o);return c.readonly=t.spec==null?!0:(u=t.spec.readonly)!=null?u:!1,c.inputName=((i=t.spec)==null?void 0:i.name)!=null?(a=t.spec)==null?void 0:a.name:t.propType,c.submitting=e.submitting,c.action=e.action,o.updatePointer=(s,l,p,f=r.interceptor)=>{var S;let d=t.value;if(!v(d)){console.warn("Non object action change intercepted.");return}let m=Object.assign({},d),y=oe.create(s);l==null?y.unset(m):y.set(m,l,!0),typeof f=="function"&&(m=f(m,d,(S=t.actionValue)==null?void 0:S.value)),e.updatePointer(t.pointer,m,p)},c.update=(s,l)=>J(null,null,function*(){let p=t.value;if(!v(p))throw new Error("Cannot call update on a non object selection instance");typeof s=="function"?t.update(s(p)):s!=null&&t.update(s),l!=null&&l.submit||l!=null&&l.submitOnChange?yield e.submit():E()}),c.submit=()=>e.submit(),c.select=(s,l,p)=>{if(!v(t.value))return null;let[f,d,m]=ee(s,l,p);return kt(ut,{parentArgs:o,selector:f,value:t.value,actionValue:t.actionValue.value,args:d,view:m})},c.edit=s=>c.readonly?c.present(s):kt(nn,{o:c,args:s,factoryArgs:r,parentArgs:e,rendererArgs:t}),c.default=s=>c.edit(Object.assign({component:null},s)),c.initial=e.action.initial,c.success=e.action.success,c.failure=e.action.failure,c.remove=(s={})=>{if(t.propType==null)return;let l=e.parent.value,p=l[t.propType];if(_(p)){let f=te(p);f.splice(c.index,1),f.length===0&&delete l[t.propType]}else v(p)&&delete l[t.propType];E()},c.append=(s,l={},p={})=>{if(!v(t.value)){console.warn(`Attempt to append to non object octiron selection ${s}`);return}let f,d=e.store.expand(s),m=t.value[d];return m==null?f=l:Array.isArray(m)?f=[...m,l]:f=[m,l],e.updatePointer(t.pointer,Object.assign({},t.value,{[d]:f}),p)},c}function on(...n){return`${n.map(t=>t.replace(/~/g,"~0").replace(/\//g,"~1")).join("/")}`}function K(n){return v(n)&&typeof n["@id"]=="string"&&n["@id"]!==""}function pe(n){let e=Object.keys(n);if(e.length===0)return!1;for(let t of e)if(!t.startsWith("@")||t==="@value"||t==="@list"||t==="@set")return!1;return!0}function ke(n){return typeof n["@value"]!="undefined"}var Un=new RegExp("\\s*(?<subject>([^\\[\\s]+))(\\[(?<filter>([^\\]])+)\\])?\\s*","g");function Jt(n,e){var o,c;let t,r=[];for(;t=Un.exec(n);){let u=(o=t.groups)==null?void 0:o.subject,i=(c=t.groups)==null?void 0:c.filter;if(typeof i=="string"&&typeof u=="string")r.push({subject:e.expand(u),filter:i});else if(typeof u=="string")r.push({subject:e.expand(u)});else throw new Error(`Invalid selector: ${n}`)}return r}var $n=/^https?\:\/\//,sn=/^https?\:\/\/schema\.org/,qn=new RegExp("^https?\\:\\/\\/schema\\.org\\/(?<term>(readonlyValue|valueName|valueRequired|defaultValue|minValue|maxValue|stepValue|valuePattern|multipleValues|valueMinLength|valueMaxLength))");function cn({spec:n,store:e}){var c;let t={readonlyValue:!1,valueRequired:!1},r,o=e.vocab==null?!1:sn.test(e.vocab);for(let[u,i]of Object.entries(e.aliases))if(sn.test(i)){r=[u,i];break}for(let[u,i]of Object.entries(n)){let a;if($n.test(u)?a=u:o&&!u.includes(":")?a=`${e.vocab}${u}`:r&&u.startsWith(`${r[0]}:`)&&(a=u.replace(`${r[0]}:`,r[1])),!a)continue;let s=qn.exec(a);(c=s==null?void 0:s.groups)!=null&&c.term&&(t[s.groups.term]=i)}return{readonly:t.readonlyValue,required:t.valueRequired,name:t.valueName,min:t.minValue,max:t.maxValue,step:t.stepValue,pattern:t.valuePattern,multiple:t.multipleValues,minLength:t.valueMinLength,maxLength:t.valueMaxLength}}var Et=class extends Error{};function ln(n){for(let e=0;e<n.result.length;e++){let t=n.result[e];t.key=Symbol.for(t.keySource),delete t.keySource}return n}function Je({selector:n,value:e,fragment:t,accept:r,actionValue:o,defaultValue:c,store:u}){let i={selector:n,complete:!1,hasErrors:!1,hasMissing:!1,required:[],dependencies:[],result:[]};if(e==null){let[{subject:s,filter:l},...p]=Jt(n,u),[f,d]=s.split("#");return _e({keySource:"",pointer:"",iri:f,fragment:d!=null?d:t,accept:r,filter:l,selector:p.length>0?p:void 0,store:u,details:i}),i.complete=i.required.length===0,ln(i)}let a=Jt(n,u);Ge({keySource:"",pointer:"",value:e,actionValue:o,selector:a,store:u,details:i,defaultValue:c}),i.complete=i.required.length===0;for(let s=0;s<i.result.length;s++){let l=i.result[s];l.key=Symbol.for(l.keySource)}return ln(i)}function G(n,e){return`${n}/${on(e.toString())}`}function Dt({value:n,filter:e}){return typeof e!="string"?!0:Array.isArray(n["@type"])?n["@type"].includes(e):n["@type"]===e}function Nt(n){return n!==null&&typeof n!="undefined"&&typeof n!="boolean"&&typeof n!="number"&&typeof n!="string"}function pt({keySource:n,pointer:e,value:t,propType:r,filter:o,spec:c,actionValue:u,store:i,details:a}){if(t===void 0){a.hasMissing=!0;return}else if(t===null&&v(u)){for(let s of Object.values(u))if(xe(s)&&s["@type"]==="https://schema.org/PropertyValueSpecification")return}if(c!=null&&(!_(t)||!v(u))){let s=cn({spec:c,store:i});v(t)&&ke(t)&&(t=t["@value"]),a.result.push({keySource:e,pointer:e,type:"action-value",propType:r,value:t,actionValue:u,spec:s,readonly:s.readonly});return}if(Nt(t)){if(_(t)){let s=te(t);for(let l=0;l<s.length;l++){let p=s[l];if(K(p)||(n=G(n,l)),pt({keySource:n,pointer:G(e,l),value:p,spec:c,actionValue:u,propType:r,filter:o,store:i,details:a}),a.hasErrors||a.hasMissing)return}return}}else{a.result.push({keySource:e,pointer:e,type:"value",propType:r,value:t});return}if(!(typeof o=="string"&&!Dt({value:t,filter:o}))){if(ke(t)){pt({keySource:n,pointer:e,value:t["@value"],propType:r,store:i,details:a});return}else if(pe(t)){_e({keySource:n,pointer:e,iri:t["@id"],filter:o,store:i,details:a});return}if(K(t)){let s=t["@id"];a.result.push({keySource:n,pointer:e,type:"entity",iri:s,ok:!0,value:t});return}a.result.push({keySource:n,pointer:e,type:"value",propType:r,value:t})}}function an({keySource:n,pointer:e,propType:t,value:r,actionValue:o,filter:c,store:u,details:i}){if(e=G(e,t),!Nt(r))return;if(_(r)){let s=te(r);for(let l=0;l<s.length;l++){let p=s[l];if(K(p)||(n=G(n,l)),an({keySource:n,pointer:G(e,l),propType:t,value:p,actionValue:o,filter:c,store:u,details:i}),i.hasErrors||i.hasMissing)return}return}if(pe(r)&&K(r)){_e({keySource:n,pointer:e,iri:r["@id"],selector:[{subject:t,filter:c}],store:u,details:i});return}else if(pe(r))return;let a;v(o)&&o[`${t}-input`]==null||(v(o)&&(a=o[`${t}-input`]),pt({keySource:n,pointer:e,value:r[t],spec:a,actionValue:o==null?void 0:o[t],propType:t,filter:c,store:u,details:i}))}function Ge({keySource:n,pointer:e,selector:t,value:r,actionValue:o,store:c,details:u,defaultValue:i}){if(t.length===0)return;if(!Nt(r))return;if(_(r)){let d=te(r);for(let m=0;m<d.length;m++){let y=d[m];if(K(y)||(n=G(n,m)),Ge({keySource:n,pointer:G(e,m),selector:t,value:y,actionValue:o,store:c,details:u,defaultValue:i}),u.hasErrors||u.hasMissing)return}return}else ke(r)&&Ge({keySource:n,pointer:e,selector:t,value:r["@value"],actionValue:o,store:c,details:u,defaultValue:i});if(pe(r)&&K(r)){_e({keySource:n,pointer:e,selector:t,iri:r["@id"],store:c,details:u});return}v(r)&&o!==void 0&&r[t[0].subject]==null&&(r={[t[0].subject]:i!=null?i:null});let[a,...s]=t,{subject:l,filter:p}=a;if(r[l]===void 0){u.hasMissing=!0;return}if(s.length===0&&v(o==null?void 0:o[l])){e=G(e,l),pt({keySource:e,pointer:e,value:r[l],propType:l,details:u,store:c,actionValue:o==null?void 0:o[l],spec:o[`${l}-input`],filter:p});return}else if(s.length===0){an({keySource:n,pointer:e,propType:l,filter:p,value:r,actionValue:o,store:c,details:u});return}if(typeof p=="string"&&!Dt({value:r,filter:p}))return;let f;v(o==null?void 0:o[l])&&(f=o[l]),Ge({keySource:G(n,l),pointer:G(e,l),selector:s,value:r[l],actionValue:f,store:c,details:u})}function _e({keySource:n,pointer:e,iri:t,fragment:r,accept:o,filter:c,selector:u,store:i,details:a,handledIRIs:s}){n=G(n,t),e=G(e,t);let l=i.entity(t,o);if(a.dependencies.push(t),l==null||l.loading){a.required.includes(t)||(a.required.push(t),a.accept=o,a.fragment=r);return}if(!l.ok){if(a.hasErrors=!0,u==null||u.length===0)return;a.result.push({keySource:n,pointer:e,type:"entity",iri:l.iri,ok:!1,status:l.status,value:l.value,reason:l.reason});return}if(l.type==="alternative-success"){a.result.push({keySource:n,pointer:e,type:"alternative",contentType:l.integration.contentType,integration:l.integration});return}let p=l.value;if(pe(p)){if(s==null)s=new Set([p["@id"]]);else if(!s.has(p["@id"]))s.add(p["@id"]);else throw new Et("Circular selection loop detected");return _e({keySource:n,pointer:e,iri:p["@id"],filter:c,selector:u,details:a,store:i,handledIRIs:s})}if(!(typeof c=="string"&&!Dt({filter:c,value:p}))){if(typeof u=="undefined"){a.result.push({keySource:n,pointer:e,type:"entity",iri:l.iri,ok:!0,value:l.value});return}Ge({keySource:n,pointer:e,value:p,selector:u,store:i,details:a})}}var ut=n=>{let e=n.attrs,t,r={};function o(){let u=!1,{parentArgs:i,selectionArgs:a}=e,s=[];for(let p=0;p<t.result.length;p++){let f=t.result[p];if(s.push(f.pointer),r[f.pointer]!=null){let{rendererArgs:g,octiron:b}=r[f.pointer],O=j=>i.updatePointer(f.pointer,j,a);g.value=b.value=f.value,g.spec=f.spec,g.update=O;continue}u=!0;let d=g=>i.updatePointer(f.pointer,g,a),m={index:p,value:f.actionValue,propType:f.propType},y=ae(e.args,i,m),S={index:p,update:d,actionValue:y,pointer:f.pointer,propType:f.propType,value:f.value,spec:f.spec},A=rn(e.args,i,S);r[f.pointer]={rendererArgs:S,selection:y,octiron:A,selectionResult:f}}let l=Object.keys(r);for(let p of l)s.includes(p)||(u=!0,delete r[p]);u&&typeof window!="undefined"&&E()}function c(){let{selector:u,value:i,actionValue:a}=e,{store:s}=e.parentArgs;v(i)&&(t=Je({selector:u,store:s,actionValue:a,value:i,defaultValue:e.args.initialValue}),o())}return{oninit:({attrs:u})=>{e=u,c()},onbeforeupdate:({attrs:u})=>{e=u;for(let i of Object.values(r))i.octiron._updateArgs("args",u.args);c()},view:({attrs:{view:u,args:i}})=>{if(t==null)return null;let{pre:a,sep:s,post:l,fallback:p}=i;if(typeof u=="undefined")return;let f=Object.values(r),d=[a];for(let m=0;m<f.length;m++){let{octiron:y,selectionResult:S}=f[m];y.position=m+1,m!==0&&d.push(s),S.value==null&&typeof p=="function"?d.push(null):S.value==null&&p!=null?d.push(p):d.push(u(y))}return d.push(l),d}}};function un(n,e,t){let r=Object.assign(Object.create(null),n),o=Object.create(null),c;if(v(n.initialPayload))for(let[d,m]of Object.entries(n.initialPayload))o[e.store.expand(d)]=m;function u(){return J(this,null,function*(){let{url:d,method:m,body:y,contentType:S,encodingType:A}=It({payload:o,action:t.value,store:e.store});l.submitting=!0,l.url=new URL(d,l.store.rootIRI),E();try{c=yield e.store.submit(d,{method:m,body:y,contentType:S,encodingType:A})}catch(g){console.error(g)}l.submitting=!1,E()})}function i(d){let m=o,y=$($({},m),d);typeof n.interceptor=="function"?o=n.interceptor(y,m,e.parent.value):o=y,s.value=l.value=d,E()}let s={value:o,submitting:!1,submit:u,updatePointer:(d,m,y)=>{let S=Object.assign({},o),A=oe.create(d);m==null?A.unset(S):A.set(S,m,!0),i(S)}},l=ue("action",r,e,t,s);l.value=o,l.action=e.parent,l.actionValue=t.actionValue,s.action=l,s.submitting=l.submitting,l.select=(d,m,y)=>{let[S,A,g]=ee(d,m,y);return Mt(ut,{parentArgs:s,selector:S,value:l.value,actionValue:e.parent.value,args:A,view:g})},l.submit=function(d){return J(this,null,function*(){return typeof d=="function"?i(d(o)):d!=null&&i(d),yield u()})},l.update=function(d,m){return J(this,null,function*(){typeof d=="function"?i(d(o)):d!=null&&i(d),m!=null&&m.submit||m!=null&&m.submitOnChange?yield u():E()})},l.append=(d,m={},y={})=>{let S=e.store.expand(d);if(!v(l.value))return;let A=l.value[S],g=[];return A!=null&&!Array.isArray(A)?g.push(A):Array.isArray(A)&&(g=[...A.filter(b=>b!=null)]),g.push(m),l.update(Z($({},l.value),{[S]:g}),y)};let p=d=>m=>Mt(Tt,{not:d,type:"initial",args:{},submitResult:c,parentArgs:s},m),f=(d,m)=>(y,S,A)=>{let[g,b,O]=ee(y,S,A);return Mt(Tt,{not:m,type:d,selector:g,args:b,view:O,submitResult:c,parentArgs:s})};l.initial=p(),l.not.initial=p(!0),l.success=f("success"),l.not.success=f("success",!0),l.failure=f("failure"),l.not.failure=f("failure",!0);try{let d=It({payload:l.value,action:t.value,store:e.store});l.url=new URL(d.url),l.method=d.method}catch(d){console.error(d)}return l.url!=null&&(c=e.store.entity(l.url.toString())),(typeof window=="undefined"&&n.submitOnInit&&c==null||typeof window!="undefined"&&n.submitOnInit)&&l.submit(),l}var pn=({attrs:n})=>{let e=Symbol("PerformRenderer"),t=n,r,o={};function c(){let s=!1,{args:l,parentArgs:p}=t,f=[];for(let m=0;m<r.result.length;m++){let y=r.result[m];if(f.push(y.pointer),Object.hasOwn(o,y.pointer)){let O=y,j=o[y.pointer].selectionResult;if(j.type==="value"&&O.type==="value"&&O.value===j.value)continue;if(j.type==="entity"&&O.type==="entity"&&(O.ok!==j.ok||O.status!==j.status||O.value!==j.value))continue;continue}s=!0;let S={index:m,value:y.value},A=ae(l,p,S),g={index:m,value:y.value,actionValue:A},b=un(l,p,g);o[y.pointer]={action:b,octiron:A,selectionResult:y}}let d=Object.keys(o);for(let m of d)f.includes(m)||(s=!0,delete o[m]);s&&E()}function u(s){return J(this,null,function*(){if(s.length===0)return;let l=[];for(let p of s)l.push(t.parentArgs.store.fetch(p));yield Promise.allSettled(l)})}function i(s){let l=[];if(typeof r=="undefined")l=s.required;else for(let p of s.required)r.required.includes(p)||l.push(p);r=s,l.length>0&&u(l),c()}function a(){let{selector:s,parentArgs:l}=t;if(s==null){let p;K(l.parent.value)?p={pointer:"/local",key:Symbol.for("/local"),type:"entity",iri:l.parent.value["@id"],ok:!0,value:l.parent.value}:p={pointer:"/local",key:Symbol.for("/local"),type:"value",value:l.parent.value},r={selector:"",complete:!0,hasErrors:!1,hasMissing:!1,dependencies:[],required:[],result:[p]}}else r=l.store.subscribe({key:e,selector:s,value:l.parent.value,listener:i}),u(r.required);c()}return{oninit:({attrs:s})=>{t=s,a()},onbeforeupdate:({attrs:s})=>{s.selector!==t.selector&&(s.parentArgs.store.unsubscribe(e),a()),t=s;for(let l of Object.values(o))l.action._updateArgs("args",s.args)},onbeforeremove:({attrs:s})=>{t=s,s.parentArgs.store.unsubscribe(e)},view:({attrs:{view:s,args:l}})=>{if(r==null||!r.complete)return l.loading;let{pre:p,sep:f,post:d,fallback:m}=l;if(typeof s=="undefined")return;let y=Object.values(o),S=[p];for(let A=0;A<y.length;A++){let{selectionResult:g,action:b,octiron:O}=y[A];b.position=A+1,A!==0&&S.push(f),g.type==="value"?S.push(s(b)):!g.ok&&typeof m=="function"?S.push(m(O,g.reason)):g.ok?S.push(s(b)):S.push(m)}return S.push(d),S}}};var ye={root:0,selection:1,action:2,"action-selection":3};function ue(n,e,t,r={},o={}){var s,l,p,f,d,m;let c=ye[n],u=K(r.value)?r.value["@id"]:(s=r.propType)!=null?s:"octiron",i={[u]:(y,S)=>y(i)?S:null}[u];i.id=t.store.key(),i.isOctiron=!0,i.octironType=n,i.readonly=!0,i.value=(l=r.value)!=null?l:null,i.store=t.store,i.index=(p=r.index)!=null?p:0,i.position=-1,o.parent=i,o.store=(f=e.store)!=null?f:t.store,o.typeDefs=(d=e.typeDefs)!=null?d:t.typeDefs,c!==ye.root&&(i.propType=r.propType,i.dataType=ct(r.value)),i.not=(y,S)=>i==null||y(i)?null:S,i.get=y=>{var g,b;if(!v(i.value))return null;if(y.startsWith("@"))return i.value[y];let S=i.store.expand(y),A=(g=i.value[S])!=null?g:null;return _(A)?te(A):(b=i.value[S])!=null?b:null},i.enter=(y,S,A)=>{let[g,b,O]=ee(y,S,A);return ze(st,{entity:!0,selector:g,args:b,view:O,parentArgs:o})};let a=Z($({},o),{value:(m=t.store.entity(t.store.rootIRI))==null?void 0:m.value});switch(i.root=(y,S,A)=>{let g,[b,O,j]=ee(y,S,A);return b==null?g=t.store.rootIRI:g=`${t.store.rootIRI} ${b}`,ze(st,{entity:!0,selector:g,args:O,view:j,parentArgs:a})},c){case ye.root:i.select=i.root;break;case ye.selection:i.select=(y,S,A)=>{let[g,b,O]=ee(y,S,A);return v(r.value)?ze(st,{selector:g,args:b,view:O,parentArgs:o}):null}}switch(c){case ye.root:i.present=i.root;break;default:i.present=y=>ze(_t,{o:i,args:y,factoryArgs:e,parentArgs:t,rendererArgs:r})}switch(i.default=y=>i.present(Object.assign({component:null},y)),c){case ye.root:i.perform=(y,S,A)=>typeof y=="string"?i.root(y,g=>g.perform(S,A)):i.root(g=>g.perform(S,A));break;default:{i.perform=(y,S,A)=>{let[g,b,O]=ee(y,S,A);return ze(pn,{selector:g,args:b,view:O,parentArgs:o})};break}}if(c!==ye.root){let y=(S,A)=>{let g=S==="args"?e:S==="parent"?t:r;for(let b of Object.keys(g))delete g[b];for(let[b,O]of Object.entries(A))g[b]=O};i._updateArgs=y}return i}function Vt(n){return ue("root",{},n)}import Lt from"mithril";import{processTemplate as Ht}from"@longform/longform";function Bn(n){let e="";for(let t=0;t<n.children.length;t++)e+=n.children[t].outerHTML;return e}function Kn(n){let e=document.createDocumentFragment();for(let t=0;t<n.children.length;t++)e.appendChild(n.children[t].cloneNode(!0));return e}var Wn=()=>{let n,e;function t(o){var a;if(n===o.fragment)return;if(n=o.fragment,o.fragment==null){e=o.output.root;return}let[c,u]=o.fragment.split("?");if(u==null){e=(a=o.output.fragments[c])==null?void 0:a.html;return}let i=o.output.templates[c];if(i!=null)try{let s=Object.fromEntries(new URLSearchParams(u));e=Ht(i,s,l=>{var p;return(p=o.output.fragments[l])==null?void 0:p.html})}catch(s){console.error(s)}}function r(o){if(o.fragment==null){e=o.output.dom;return}let[c,u]=o.fragment.split("?");if(u==null){let a=o.output.fragments[c];if(a==null)return;if(a.type==="text"){e=a.html;return}else if(a.dom==null)return;e=Kn(a.dom);return}let i=o.output.templates[c];if(i!=null)try{let a=Object.fromEntries(new URLSearchParams(u));e=Ht(i,a,s=>{var l;return o.output.fragments[s]!=null&&o.output.fragments[s].html==null&&o.output.fragments[s].dom!=null&&(o.output.fragments[s].html=Bn(o.output.fragments[s].dom)),(l=o.output.fragments[s])==null?void 0:l.html})}catch(a){console.error(a)}}return{oninit({attrs:o}){de?r(o):t(o)},view(){return de&&e instanceof DocumentFragment?Lt.dom(e):e!=null?Lt.trust(e):null}}},Ee,De,he,Se,mt,N,Ne,ft,dt=class dt{constructor(e,{iri:t,contentType:r,output:o}){I(this,Ne);Ot(this,"integrationType","html-fragments");I(this,Ee,!1);I(this,De,new Set);I(this,he);I(this,Se);I(this,mt);I(this,N);D(this,mt,e),D(this,he,t),D(this,Se,r),D(this,N,o)}get iri(){return h(this,he)}get contentType(){return h(this,Se)}get output(){return h(this,N)}getFragment(e){var t,r,o;return e!=null?(r=(t=h(this,N).fragments[e])==null?void 0:t.html)!=null?r:null:(o=h(this,N).root)!=null?o:null}text(e){if(e==null)return this.output.root==null&&h(this,N).dom&&(this.output.root=F(this,Ne,ft).call(this,h(this,N).dom)),this.output.root;let[t,r]=e.split("?");if(r==null){let c=h(this,N).fragments[t];return c==null?void 0:(c.html==null&&c.dom&&(c.html=F(this,Ne,ft).call(this,c.dom)),c.html)}let o=h(this,N).templates[t];if(o!=null)try{let c=Object.fromEntries(new URLSearchParams(r));return Ht(o,c,u=>{let i=h(this,N).fragments[u];if(i!=null)return i.html==null&&i.dom!=null&&(i.html=F(this,Ne,ft).call(this,i.dom)),i.html})}catch(c){console.error(c)}}render(e,t){return t==null?D(this,Ee,!0):h(this,De).add(t),Lt(Wn,{o:e,integration:this,fragment:t,output:h(this,N)})}getStateInfo(){let e={},t=[],r=Object.values(h(this,N).fragments);for(let o=0;o<r.length;o++)r[o].type==="text"?e[r[o].id]=r[o].html:t.push({id:r[o].id,type:r[o].type,selector:r[o].selector,rendered:h(this,De).has(r[o].id)});return{iri:h(this,he),contentType:h(this,Se),rendered:h(this,Ee),selector:h(this,N).selector,templates:h(this,N).templates,texts:e,fragments:t}}toInitialState(){let e="",t=Object.values(h(this,N).fragments);h(this,N).root!=null&&!h(this,Ee)&&(e+=`<template id="htmlfrag:${h(this,he)}|${h(this,Se)}">${h(this,N).root}</template>
`);for(let r=0;r<t.length;r++)t[r].type!=="text"&&(h(this,De).has(t[r].id)||(e+=`<template data-htmlfrag="${t[r].id}">${t[r].html}</template>
`));return e}static fromInitialState(e,{iri:t,contentType:r,rendered:o,selector:c,texts:u,fragments:i,templates:a}){let s=Object.create(null);if(s.fragments=Object.create(null),s.templates=a,c!=null&&o){let p=document.querySelector(c);p!=null&&(s.root=p.outerHTML)}else if(c!=null){let p=document.getElementById(`htmlfrag:${t}|${r}`);s.root=p==null?void 0:p.textContent}let l=Object.entries(u);for(let p=0;p<l.length;p++)s.fragments[l[p][0]]={id:l[p][0],type:"text",html:l[p][1],selector:""};for(let p=0;p<i.length;p++){let f=i[p],d=document.createDocumentFragment();if(f.rendered){let m;switch(f.type){case"embed":{if(m=document.getElementById(f.id),m==null)break;performance.mark("octiron:clone-embed-start"),d.appendChild(m.cloneNode(!0)),performance.mark("octiron:clone-embed-end"),performance.measure("octiron:clone-embed-duration","octiron:clone-embed-start","octiron:clone-embed-end"),s.fragments[f.id]={id:f.id,type:f.type,dom:d,selector:f.selector};break}case"bare":{if(m=document.querySelector(f.selector),m==null)break;d.appendChild(m.cloneNode(!0)),s.fragments[f.id]={id:f.id,type:f.type,dom:d,selector:f.selector};break}case"range":{let y=document.querySelectorAll(f.selector);d.append(...y),s.fragments[f.id]={id:f.id,type:f.type,selector:f.selector,dom:d}}}}else{let m=document.querySelector(`[data-htmlfrag="${f.id}"]`);if(m==null)continue;d.append(...m.content.children),s.fragments[f.id]={id:f.id,type:f.type,dom:d,selector:f.selector}}}return new dt(e,{contentType:r,iri:t,output:s})}};Ee=new WeakMap,De=new WeakMap,he=new WeakMap,Se=new WeakMap,mt=new WeakMap,N=new WeakMap,Ne=new WeakSet,ft=function(e){let t="";for(let r=0;r<e.children.length;r++)t+=e.children[r].outerHTML;return t},Ot(dt,"type","html-fragments");var Me=dt;var Ve,Qe,gt=class{constructor(e,t){I(this,Ve);I(this,Qe);D(this,Ve,e),D(this,Qe,t)}get status(){return h(this,Ve)}get res(){return h(this,Qe)}undefined(){return null}http(e){return typeof e=="function"?e(h(this,Ve)):e}unparserable(){return null}};Ve=new WeakMap,Qe=new WeakMap;function Le(n,e=[]){if(Array.isArray(n))for(let t of n)Le(t,e);else if(v(n)){if(pe(n))return e;if(K(n)&&e.push(n),ke(n))Le(n["@value"],e);else if(_(n))Le(te(n),e);else for(let[t,r]of Object.entries(n))t.startsWith("@")||Le(r,e)}return e}var be="application/problem+json, application/ld+json",Gn={[Me.type]:Me};function _n(n,e){let t=new Map,r={};if(n!=null&&(r["@vocab"]=n),e==null)return[t,r];for(let[o,c]of Object.entries(e))r[o]=c,t.set(o,c);return[t,r]}function zn(n,e){let t=new Headers([["accept",be]]),r=new Map;if(n!=null)for(let[o,c]of Object.entries(n))t.set(o,c);if(e!=null)for(let[o,c]of Object.entries(e)){let u=new Headers([["accept",be]]);for(let[i,a]of Object.entries(c))u.set(i,a);r.set(o,u)}return[t,r]}var Ye,Ze,ie,Ae,Oe,He,z,we,fe,et,tt,nt,rt,Fe,Ue,re,Re,se,H,Ft,yt,Ut,fn,$t,Xe=class Xe{constructor(e){I(this,H);I(this,Ye);I(this,Ze);I(this,ie);I(this,Ae);I(this,Oe);I(this,He);I(this,z,new Map);I(this,we,new Set);I(this,fe,new Map);I(this,et);I(this,tt,new Set);I(this,nt);I(this,rt,new Map);I(this,Fe);I(this,Ue);I(this,re,new Map);I(this,Re,new Map);I(this,se,new Map);var t,r;D(this,Ye,e.rootIRI),D(this,Ze,new URL(e.rootIRI).origin),D(this,Oe,e.vocab),D(this,Fe,e.fetcher),D(this,Ue,e.responseHook),[qe(this,ie)._,qe(this,Ae)._]=zn(e.headers,e.origins),[qe(this,He)._,qe(this,nt)._]=_n(e.vocab,e.aliases),D(this,et,new Map((r=(t=e.handlers)==null?void 0:t.map)==null?void 0:r.call(t,o=>[o.contentType,o]))),e.primary!=null&&D(this,z,new Map(Object.entries(e.primary))),h(this,ie).has("accept")||h(this,ie).set("accept",be);for(let o of Object.values(h(this,Ae)))o.has("accept")||o.set("accept",be);if(e.acceptMap!=null)for(let[o,c]of Object.entries(e.acceptMap))h(this,se).set(o,new Map(c));e.alternatives!=null&&D(this,fe,e.alternatives)}get rootIRI(){return h(this,Ye)}entity(e,t){var i,a,s,l;if(t==null)return(i=h(this,z).get(e))!=null?i:null;let r=F(this,H,yt).call(this,e,"get",t);if(h(this,we).has(r))return{type:"entity-loading",iri:e,loading:!0};let c=(s=(a=h(this,se).get(e))==null?void 0:a.get)==null?void 0:s.call(a,t);if(c==null)return null;let u=(l=h(this,fe).get(c))==null?void 0:l.get(e);return u==null?null:{type:"alternative-success",iri:e,loading:!1,ok:!0,integration:u}}text(e,t){let[r,o]=e.split("#"),c=this.entity(r,t);if(c!=null&&(c==null?void 0:c.type)==="alternative-success")return c.integration.text(o)}get vocab(){return h(this,Oe)}get aliases(){return Object.fromEntries(h(this,He).entries().map(([e,t])=>[e.replace(/^/,""),t]))}get context(){return h(this,nt)}expand(e){let t=Symbol.for(e),r=h(this,rt).get(t);if(r!=null)return r;let o;if(h(this,Oe)!=null&&!/^[\w\d]+\:/.test(e))o=h(this,Oe)+e;else if(/https?:\/\//.test(e))o=e;else for(let[c,u]of h(this,He)){let i=new RegExp(`^${c}:`);if(i.test(e)){o=e.replace(i,u);break}}return h(this,rt).set(t,o!=null?o:e),o!=null?o:e}select(e,t,{accept:r}={}){return Je({selector:e,value:t,accept:r,store:this})}key(){for(;;){let e=`oct-${Math.random().toString(36).slice(2,7)}`;if(!h(this,tt).has(e))return h(this,tt).add(e),e}}isLoading(e){let t=F(this,H,yt).call(this,e,"get");return h(this,we).has(t)}handleResponse(r){return J(this,arguments,function*(e,t=e.url.toString()){var u,i,a;let o=(a=(i=(u=e.headers.get("content-type"))==null?void 0:u.split)==null?void 0:i.call(u,";"))==null?void 0:a[0];if(o==null)throw new Error("Content type not specified in response");let c=h(this,et).get(o);if(c==null)throw new Error(`No handler configured for content type "${o}"`);if(c.integrationType==="jsonld"){let s=yield c.handler({res:e,store:this});F(this,H,fn).call(this,{iri:t,res:e,output:s})}else{if(c.integrationType==="problem-details")throw new Error("Problem details response types not supported yet");if(c.integrationType==="html-fragments"){let s=yield c.handler({res:e,store:this}),l=h(this,fe).get(o);l==null&&(l=new Map,h(this,fe).set(o,l)),l.set(t,new Me(c,{iri:t,contentType:o,output:s}))}}c.integrationType!=="jsonld"&&F(this,H,Ut).call(this,t,o)})}subscribe({key:e,selector:t,fragment:r,accept:o,value:c,listener:u}){let i=Je({selector:t,fragment:r,accept:o,value:c,store:this}),a=F(this,H,Ft).call(this,e,i);for(let s of i.dependencies){let l=h(this,re).get(s);l==null?h(this,re).set(s,new Set([e])):l.add(e)}return h(this,Re).set(e,{key:e,selector:t,value:c,fragment:r,accept:o,required:i.required,dependencies:i.dependencies,listener:u,cleanup:a}),i}unsubscribe(e){var t;(t=h(this,Re).get(e))==null||t.cleanup()}fetch(e,t){return J(this,null,function*(){return yield F(this,H,$t).call(this,e,{accept:t}),h(this,z).get(e)})}submit(e,t){return J(this,null,function*(){return yield F(this,H,$t).call(this,e,Z($({},t),{contentType:"application/ld+json"})),this.entity(e)})}static fromInitialState({disableLogs:e,rootIRI:t,vocab:r,aliases:o,headers:c,origins:u,handlers:i=[]}){performance.mark("octiron:from-initial-state:start");let a={rootIRI:t,vocab:r,aliases:o,handlers:i,headers:c,origins:u};try{let s=document.getElementById("oct-state");if(s==null)return e||console.warn("Failed to construct Octiron state from initial state"),new Xe(a);let l=JSON.parse(s.innerText),p=new Map,f=i.reduce((m,y)=>Z($({},m),{[y.contentType]:y}),{});for(let[m,y]of Object.entries(l.alternatives))for(let S of y){let A=f[S.contentType],g=Gn[m];if(g.type!==A.integrationType)continue;let b=g.fromInitialState(A,S);if(b==null)continue;let O=p.get(b.contentType);O==null&&(O=new Map,p.set(b.contentType,O)),O.set(b.iri,b)}let d=new Xe(Z($({},a),{alternatives:p,primary:l.primary,acceptMap:l.acceptMap}));return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),d}catch(s){e||(console.warn("Failed to construct Octiron state from initial state"),console.error(s));let l=new Xe(a);return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),l}}toInitialState(){let e="",t={primary:Object.fromEntries(h(this,z)),alternatives:{},acceptMap:{}};for(let[r,o]of h(this,se).entries())t.acceptMap[r]=Array.from(o.entries());for(let r of h(this,fe).values())for(let o of r.values())t.alternatives[o.integrationType]==null?t.alternatives[o.integrationType]=[o.getStateInfo()]:t.alternatives[o.integrationType].push(o.getStateInfo()),e+=o.toInitialState();return e+=`<script id="oct-state" type="application/json">${JSON.stringify(t)}<\/script>`,e}};Ye=new WeakMap,Ze=new WeakMap,ie=new WeakMap,Ae=new WeakMap,Oe=new WeakMap,He=new WeakMap,z=new WeakMap,we=new WeakMap,fe=new WeakMap,et=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,re=new WeakMap,Re=new WeakMap,se=new WeakMap,H=new WeakSet,Ft=function(e,t){return()=>{h(this,Re).delete(e);for(let r of t.dependencies)h(this,re).delete(r),de&&setTimeout(()=>{var o;((o=h(this,re).get(r))==null?void 0:o.size)===0&&h(this,z).delete(r)},5e3)}},yt=function(e,t,r){var o;return r=(o=r!=null?r:h(this,ie).get("accept"))!=null?o:be,`${t==null?void 0:t.toLowerCase()}|${e}|${r.toLowerCase()}`},Ut=function(e,t){let r=h(this,re).get(e);if(r!=null)for(let o of r){let c=h(this,Re).get(o);if(c==null)continue;let u=Je({selector:c.selector,value:c.value,fragment:c.fragment,accept:c.accept,store:this}),i=F(this,H,Ft).call(this,o,u);for(let a of u.dependencies){let s=h(this,re).get(a);s==null?(s=new Set([o]),h(this,re).set(a,s)):s.add(o)}c.cleanup=i,c.listener(u)}},fn=function({iri:e,res:t,output:r}){let o=[e];if(t.ok)h(this,z).set(e,{type:"entity-success",iri:e,loading:!1,ok:!0,value:r.jsonld});else{let c=new gt(t.status,t);h(this,z).set(e,{type:"entity-failure",iri:e,loading:!1,ok:!1,value:r.jsonld,status:t.status,reason:c})}for(let c of Le(r.jsonld))o.includes(c["@id"])||h(this,z).set(c["@id"],{type:"entity-success",iri:c["@id"],loading:!1,ok:!0,value:c});for(let c of o)F(this,H,Ut).call(this,c)},$t=function(r){return J(this,arguments,function*(e,t={}){var p,f;let o,c=new URL(e),u=t.method||"get",i=(f=(p=t.accept)!=null?p:h(this,ie).get("accept"))!=null?f:be;c.hash="";let a=c.toString(),s=F(this,H,yt).call(this,a,u,t.accept);if(c.origin===h(this,Ze))o=new Headers(h(this,ie));else if(h(this,Ae).has(c.origin))o=new Headers(h(this,Ae).get(c.origin));else throw new Error("Unconfigured origin");t.contentType!=null&&o.set("content-type",t.contentType),i!=null?o.set("accept",i):o.get("accept")==null&&o.set("accept",be),h(this,we).add(s),E();let l=new Promise(d=>{J(this,null,function*(){var y;let m;h(this,Fe)!=null?m=yield h(this,Fe).call(this,a,{method:u,headers:o,body:t.body}):m=yield fetch(a,{method:u,headers:o,body:t.body}),t.accept!=null&&h(this,se).has(a)?(y=h(this,se).get(a))==null||y.set(t.accept,m.headers.get("content-type")):t.accept!=null&&h(this,se).set(a,new Map([[t.accept,m.headers.get("content-type")]])),yield this.handleResponse(m,e),h(this,we).delete(s),E(),d(m)})});h(this,Ue)!=null&&h(this,Ue).call(this,l),yield l})};var ve=Xe;function qt(n,...e){let t={};if(n instanceof ve)for(let r of e)t[n.expand(r.type)]=r;else{t[n.type]=n;for(let r of e)t[r.type]=r}return t}function mn(...n){let e=[];for(let t of n)if(!(typeof t=="undefined"||t===null))if(typeof t=="string")e.push(t);else if(Array.isArray(t))for(let r of t)e.push(r);else for(let[r,o]of Object.entries(t))o&&e.push(r);return e.join(" ")}function Pi(n){return n}import dn from"jsonld";var Ii={integrationType:"jsonld",contentType:"application/ld+json",handler:e=>J(null,[e],function*({res:n}){let t=yield n.json();if(!v(t)&&!Array.isArray(t))throw new Error("JSON-LD Document should be an object");let r=yield dn.expand(t,{documentLoader:c=>J(null,null,function*(){let i=yield(yield fetch(c,{headers:{accept:"application/ld+json"}})).json();return{documentUrl:c,document:i}})});return{jsonld:yield dn.compact(r,{})}})};import{longform as Qn}from"@longform/longform";var Di={integrationType:"html-fragments",contentType:"text/longform",handler:e=>J(null,[e],function*({res:n}){return Qn(yield n.text())})};import x from"mithril";var Bt=()=>{function n(i){return x("code",[x("span.oct-json-quote",'"'),x("a.oct-json-iri",{href:i},i),x("span.oct-json-quote",'"')])}function e(i){let a=typeof i=="boolean"?"oct-json-boolean":typeof i=="number"?"oct-json-number":"oct-json-string",s;return typeof i=="boolean"&&i?s="true":typeof i=="boolean"||(typeof i=="string"?s=[x("span.oct-json-quote",'"'),i,x("span.oct-json-quote",'"')]:s=i),x("code",{className:a},s)}function t(i,a,s=""){let l=[];for(let p=0;p<i.length;p++){let f=i[p];l.push(x("li.oct-json-arr-item",c(null,f,a,s)))}return x("ul.oct-json-arr",l)}let r=["@id","@type","@context"];function o(i,a,s=""){let l=[],p=Object.entries(i).toSorted();for(let f=0;f<p.length;f++){let[d,m]=p[f],y,S=[x("span.oct-json-quote",'"'),x("span.oct-json-obj-key",d),x("span.oct-json-quote",'"'),x("span.oct-json-obj-colon",": ")];if(d==="@id")y=[x("code",S),n(m)];else if(a==null||r.includes(d))y=c(S,m);else if(d.startsWith("@"))y=c(S,m,a,s);else{let A=`${s} ${d}`,g=new URL(a);g.searchParams.set("selector",A);let b=[x("span.oct-json-quote",'"'),x("span.oct-json-obj-key",x("a",{href:g},d)),x("span.oct-json-quote",'"'),x("span.oct-json-obj-colon",": ")];y=c(b,m,a,A)}l.push(x("li.oct-json-obj-item",y))}return x("ul.oct-json-obj",l)}function c(i,a,s,l=""){return v(a)?[x("details.oct-json-details",{open:!0},x("summary.oct-json-details-sum",x("code",i,x("span.oct-json-obj-open","{"))),u(a,s,l)),x("code.oct-json-obj-close","}")]:Array.isArray(a)?[x("details.oct-json-details",{open:!0},x("summary.oct-json-details-sum",x("code",i,x("span.oct-json-obj-open","["))),u(a,s,l)),x("code.oct-json-obj-close","]")]:[x("code",i),u(a,s,l)]}function u(i,a,s=""){return v(i)?o(i,a,s):Array.isArray(i)?t(i,a,s):e(i)}return{view:({attrs:{value:i,selector:a,location:s}})=>{let l=s!=null?new URL(s):void 0;return x(".oct-json",[c(null,i,l,typeof a=="string"?a.trim():void 0)])}}};import Q from"mithril";var ht=({attrs:n})=>{var s;let e=n,t=n.o.value,r,o=(s=n.initialPresentationStyle)!=null?s:"value";function c(l=!0){let{o:p}=e;o==="value"?r=Q(Bt,{value:t,selector:e.selector,location:e.location}):o==="action-value"&&(p.octironType==="action"||p.octironType==="action-selection")&&(r=Q(Bt,{value:p.actionValue.value,selector:e.selector,location:e.location})),l&&E()}function u(l){l.redraw=!1,o="value",c()}function i(l){l.redraw=!1,o="action-value",c()}function a(l){l.redraw=!1,o="component",c()}return{oninit:({attrs:l})=>{e=l,c(!1)},onbeforeupdate:({attrs:l})=>{l.o.value!==t&&(t=l.o.value,c(!0))},view:({attrs:{o:l,availableControls:p}})=>{let f,d,m=[];return o==="component"?f=Q(".oct-debug-body",l.default()):f=Q(".oct-debug-body",r),(l.octironType==="action"||l.octironType==="action-selection")&&(d=Q("button.oct-button",{type:"button",onclick:i},"Action value")),p==null||p.includes("value")?m.push(Q("button.oct-button",{type:"button",onclick:u},"Value")):d!=null&&(p==null||p.includes("action-value"))?m.push(d):p==null||p.includes("component")?m.push(Q("button.oct-button",{type:"button",onclick:a},"Component")):(p==null||p.includes("log"))&&m.push(Q("button.oct-button",{type:"button",onclick:()=>console.debug(l)},"Log")),Q("aside.oct-debug",Q(".oct-debug-controls",Q(".oct-button-group",...m)),f)}}};import V from"mithril";var Wi=({attrs:n})=>{let e=n.selector||"",t=e,r=e,o=n.presentationStyle||"debug",c=n.onChange,u={view:({attrs:{o:f}})=>V(ht,{o:f,location:n.location})};function i(f){e=f.target.value}function a(f){f.key==="Enter"&&s()}function s(){r=e,typeof c=="function"&&c(r,o)}function l(f){f.preventDefault(),o="debug",typeof c=="function"&&c(r,o)}function p(f){f.preventDefault(),o="components",typeof c=="function"&&c(r,o)}return{oninit:({attrs:f})=>{c=f.onChange},onbeforeupdate:({attrs:f})=>{var d;r=(d=f.selector)!=null?d:"",r!==t&&(e=t=r),c=f.onChange},view:({attrs:{autofocus:f,o:d}})=>{var g,b;let m,y,S,A;if(r.length!==0&&o==="debug"?m=d.root(r,O=>V(ht,{o:O,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?[]:void 0})):r.length!==0?m=d.root(r,O=>V("div",O.default({fallbackComponent:u,attrs:{selector:r}}))):o==="debug"?m=d.root(O=>V(ht,{o:O,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?void 0:[]})):m=d.root(O=>V("div",O.default({fallbackComponent:u,attrs:{selector:r}}))),n.location!=null&&r.length!==0){let O=n.selector.trim().includes(" ")?n.selector.replace(/\s+([^\s]+)$/,""):"";y=new URL(n.location),O!=null?y.searchParams.set("selector",O):y.searchParams.delete("selector")}return n.location!=null&&(S=new URL(n.location),A=new URL(n.location),S.searchParams.set("presentationStyle","debug"),A.searchParams.set("presentationStyle","components")),V(".oct-explorer",V(".oct-explorer-controls",V("form.oct-form-group",{action:(b=(g=n.location)==null?void 0:g.toString)==null?void 0:b.call(g),onsubmit:O=>{O.preventDefault(),s()}},[y!=null?V("a.oct-button",{href:y.toString()},"Up"):V("button.oct-button",{type:"button",disabled:!0},"Up"),V("input",{name:"selector",value:e,autofocus:f,oninput:i,onkeypress:a}),V("button.oct-button",{type:"submit",disabled:r===e&&typeof window!="undefined"},"Apply")]),V(".oct-button-group",o==="debug"||S==null?V("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:l},"Debug"):V("a.oct-button",{href:S.toString(),onclick:l},"Debug"),o==="components"||A==null?V("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:p},"Components"):V("a.oct-button",{href:A.toString(),onclick:p},"Components"))),V("pre.oct-explorer-body",m))}}};import Xn from"mithril";var zi=n=>{var o;let t=((o=n.attrs.o.method)==null?void 0:o.toUpperCase())||"POST",r={GET:"application/x-www-form-urlencoded",POST:"multipart/form-data"};return{view:a=>{var s=a,{attrs:l}=s,p=l,{o:c}=p,u=me(p,["o"]),{children:i}=s;return Xn("form.oct-form",Z($({},u),{method:t,enctype:r[t||"GET"],action:c.url,onsubmit:f=>{f.preventDefault(),c.submit()}}),i)}}};import Yn from"mithril";var es=()=>({view:({attrs:n,children:e})=>Yn("button.oct-button.oct-submit-button",{id:n.id,type:"submit",class:mn(n.class)},e)});function gn(t){var r=t,{typeDefs:n}=r,e=me(r,["typeDefs"]);let o=new ve(e),c=n!=null?qt(o,...n):{};return Vt({store:o,typeDefs:c})}gn.fromInitialState=t=>{var r=t,{typeDefs:n}=r,e=me(r,["typeDefs"]);let o=ve.fromInitialState($({},e)),c=n!=null?qt(o,...n):{};return Vt({store:o,typeDefs:c})};export{ht as OctironDebug,Wi as OctironExplorer,zi as OctironForm,Bt as OctironJSON,es as OctironSubmitButton,ve as Store,mn as classes,gn as default,Ii as jsonLDHandler,Di as longformHandler,Pi as makeTypeDef,qt as makeTypeDefs};
//# sourceMappingURL=octiron.min.js.map
