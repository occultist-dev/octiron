var Sn=Object.create;var bt=Object.defineProperty,An=Object.defineProperties,bn=Object.getOwnPropertyDescriptor,On=Object.getOwnPropertyDescriptors,wn=Object.getOwnPropertyNames,st=Object.getOwnPropertySymbols,Rn=Object.getPrototypeOf,Ot=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable;var _t=n=>{throw TypeError(n)};var At=(n,e,t)=>e in n?bt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$=(n,e)=>{for(var t in e||(e={}))Ot.call(e,t)&&At(n,t,e[t]);if(st)for(var t of st(e))Gt.call(e,t)&&At(n,t,e[t]);return n},ne=(n,e)=>An(n,On(e));var ge=(n,e)=>{var t={};for(var r in n)Ot.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&st)for(var r of st(n))e.indexOf(r)<0&&Gt.call(n,r)&&(t[r]=n[r]);return t};var vn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Cn=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of wn(e))!Ot.call(n,o)&&o!==t&&bt(n,o,{get:()=>e[o],enumerable:!(r=bn(e,o))||r.enumerable});return n};var Pn=(n,e,t)=>(t=n!=null?Sn(Rn(n)):{},Cn(e||!n||!n.__esModule?bt(t,"default",{value:n,enumerable:!0}):t,n));var wt=(n,e,t)=>At(n,typeof e!="symbol"?e+"":e,t),Rt=(n,e,t)=>e.has(n)||_t("Cannot "+t);var y=(n,e,t)=>(Rt(n,e,"read from private field"),t?t.call(n):e.get(n)),x=(n,e,t)=>e.has(n)?_t("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),J=(n,e,t,r)=>(Rt(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),q=(n,e,t)=>(Rt(n,e,"access private method"),t);var Be=(n,e,t,r)=>({set _(o){J(n,e,o,t)},get _(){return y(n,e,r)}});var k=(n,e,t)=>new Promise((r,o)=>{var l=u=>{try{i(t.next(u))}catch(c){o(c)}},a=u=>{try{i(t.throw(u))}catch(c){o(c)}},i=u=>u.done?r(u.value):Promise.resolve(u.value).then(l,a);i((t=t.apply(n,e)).next())});var nn=vn((tn,ut)=>{(function(n,e){typeof define=="function"&&define.amd?define("uri-templates",[],e):typeof ut!="undefined"&&ut.exports?ut.exports=e():n.UriTemplate=e()})(tn,function(){var n={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},e={"*":!0},t=/[:/&?#]/;function r(i){return encodeURI(i).replace(/%25[0-9][0-9]/g,function(u){return"%"+u.substring(3)})}function o(i){return i=i.replace(/%../g,""),encodeURIComponent(i)===i}function l(i){var u="";n[i.charAt(0)]&&(u=i.charAt(0),i=i.substring(1));var c="",s="",p=!0,f=!1,d=!1;u=="+"?p=!1:u=="."?(s=".",c="."):u=="/"?(s="/",c="/"):u=="#"?(s="#",p=!1):u==";"?(s=";",c=";",f=!0,d=!0):u=="?"?(s="?",c="&",f=!0):u=="&"&&(s="&",c="&",f=!0);for(var m=[],g=i.split(","),S=[],O={},h=0;h<g.length;h++){var A=g[h],b=null;if(A.indexOf(":")!=-1){var P=A.split(":");A=P[0],b=parseInt(P[1])}for(var D={};e[A.charAt(A.length-1)];)D[A.charAt(A.length-1)]=!0,A=A.substring(0,A.length-1);var F={truncate:b,name:A,suffices:D};S.push(F),O[A]=F,m.push(A)}var B=function(R){for(var C="",H=0,K=0;K<S.length;K++){var j=S[K],w=R(j.name);if(w==null||Array.isArray(w)&&w.length==0||typeof w=="object"&&Object.keys(w).length==0){H++;continue}if(K==H?C+=s:C+=c||",",Array.isArray(w)){f&&(C+=j.name+"=");for(var ee=0;ee<w.length;ee++)ee>0&&(C+=j.suffices["*"]&&c||",",j.suffices["*"]&&f&&(C+=j.name+"=")),C+=p?encodeURIComponent(w[ee]).replace(/!/g,"%21"):r(w[ee])}else if(typeof w=="object"){f&&!j.suffices["*"]&&(C+=j.name+"=");var I=!0;for(var E in w)I||(C+=j.suffices["*"]&&c||","),I=!1,C+=p?encodeURIComponent(E).replace(/!/g,"%21"):r(E),C+=j.suffices["*"]?"=":",",C+=p?encodeURIComponent(w[E]).replace(/!/g,"%21"):r(w[E])}else f&&(C+=j.name,(!d||w!="")&&(C+="=")),j.truncate!=null&&(w=w.substring(0,j.truncate)),C+=p?encodeURIComponent(w).replace(/!/g,"%21"):r(w)}return C},ue=function(R,C,H){if(s&&(R=R.substring(s.length)),S.length==1&&S[0].suffices["*"]){for(var K=S[0],j=K.name,w=K.suffices["*"]?R.split(c||","):[R],ee=p&&R.indexOf("=")!=-1,I=1;I<w.length;I++){var R=w[I];ee&&R.indexOf("=")==-1&&(w[I-1]+=(c||",")+R,w.splice(I,1),I--)}for(var I=0;I<w.length;I++){var R=w[I];p&&R.indexOf("=")!=-1&&(ee=!0);var E=R.split(",");E.length==1?w[I]=E[0]:w[I]=E}if(f||ee){for(var te=C[j]||{},V=0;V<w.length;V++){var Ce=R;if(!(f&&!Ce)){if(typeof w[V]=="string"){var R=w[V],G=R.split("=",1)[0],R=R.substring(G.length+1);if(p){if(H&&!o(R))return;R=decodeURIComponent(R)}Ce=R}else{var R=w[V][0],G=R.split("=",1)[0],R=R.substring(G.length+1);if(p){if(H&&!o(R))return;R=decodeURIComponent(R)}w[V][0]=R,Ce=w[V]}if(p){if(H&&!o(G))return;G=decodeURIComponent(G)}te[G]!==void 0?Array.isArray(te[G])?te[G].push(Ce):te[G]=[te[G],Ce]:te[G]=Ce}}Object.keys(te).length==1&&te[j]!==void 0?C[j]=te[j]:C[j]=te}else{if(p)for(var V=0;V<w.length;V++){var E=w[V];if(Array.isArray(E))for(var qe=0;qe<E.length;qe++){if(H&&!o(E[qe]))return;E[qe]=decodeURIComponent(E[qe])}else{if(H&&!o(E))return;w[V]=decodeURIComponent(E)}}C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(w):C[j]=[C[j]].concat(w):w.length==1&&!K.suffices["*"]?C[j]=w[0]:C[j]=w}}else{for(var w=S.length==1?[R]:R.split(c||","),it={},I=0;I<w.length;I++){for(var Pe=0;Pe<S.length-1&&Pe<I&&!S[Pe].suffices["*"];Pe++);if(Pe==I){it[I]=I;continue}else{for(var je=S.length-1;je>0&&S.length-je<w.length-I&&!S[je].suffices["*"];je--);if(S.length-je==w.length-I){it[I]=je;continue}}it[I]=Pe}for(var I=0;I<w.length;I++){var R=w[I];if(!(!R&&f)){var E=R.split(","),ee=!1;if(f){var R=E[0],j=R.split("=",1)[0],R=R.substring(j.length+1);E[0]=R;var K=O[j]||S[0]}else var K=S[it[I]],j=K.name;for(var V=0;V<E.length;V++)if(p){if(H&&!o(E[V]))return;E[V]=decodeURIComponent(E[V])}(f||K.suffices["*"])&&C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(E):C[j]=[C[j]].concat(E):E.length==1&&!K.suffices["*"]?C[j]=E[0]:C[j]=E}}}return 1};return{varNames:m,prefix:s,substitution:B,unSubstitution:ue}}function a(i){if(!(this instanceof a))return new a(i);for(var u=i.split("{"),c=[u.shift()],s=[],p=[],f=[],d=[];u.length>0;){var m=u.shift(),g=m.split("}")[0],S=m.substring(g.length+1),O=l(g);p.push(O.substitution),f.push(O.unSubstitution),s.push(O.prefix),c.push(S),d=d.concat(O.varNames)}this.fill=function(h){if(h&&typeof h!="function"){var A=h;h=function(F){return A[F]}}for(var b=c[0],P=0;P<p.length;P++){var D=p[P];b+=D(h),b+=c[P+1]}return b},this.fromUri=function(h,A){A=A||{};for(var b={},P=0;P<c.length;P++){var D=c[P];if(h.substring(0,D.length)!==D)return;if(h=h.substring(D.length),P>=c.length-1){if(h=="")break;return}var F=s[P];if(!(F&&h.substring(0,F.length)!==F)){for(var B=c[P+1],ue=P;;){if(ue==c.length-2){var R=h.substring(h.length-B.length);if(R!==B)return;var C=h.substring(0,h.length-B.length);h=R}else if(B){var H=h.indexOf(B),C=h.substring(0,H);h=h.substring(H)}else if(s[ue+1]){var H=h.indexOf(s[ue+1]);H===-1&&(H=h.length);var C=h.substring(0,H);h=h.substring(H)}else if(c.length>ue+2){ue++,B=c[ue+1];continue}else{var C=h;h=""}break}if(!f[P](C,b,A.strict))return}}return b},this.varNames=d,this.template=i}return a.prototype={toString:function(){return this.template},fillFromObject:function(i){return this.fill(i)},test:function(i,u){return!!this.fromUri(i,u)}},a})});import Qe from"mithril";function v(n){return typeof n=="object"&&!Array.isArray(n)&&n!==null}function Q(n,e,t){let r,o={},l;return typeof n=="string"?r=n:typeof n=="function"?l=n:n!=null&&(o=n),typeof e=="function"?l=e:e!=null&&(o=e),typeof t=="function"&&(l=t),typeof l=="undefined"&&(l=(a=>a.default(o))),[r,o,l]}import ye from"mithril";function pe(n,e,t){let r=Object.assign({},n),o={value:t.value};return fe("selection",r,e,t,o)}import jn from"mithril";var _=typeof window!="undefined";function N(){_&&jn.redraw()}var fr=Symbol.for("@pre"),mr=Symbol.for("@post");function Tn(n,e){return n.parentArgs.store!==e.parentArgs.store||n.selector!==e.selector||n.parentArgs.value!==e.parentArgs.value}var lt=n=>{let e=Symbol("SelectionRenderer"),t=!1,r=n.attrs,o,l={};function a(){let s=!1,p=o==null,f=[];if(o==null){let m=Reflect.ownKeys(l);for(let g of m)f.includes(g)||(s=!0,delete l[g]);s&&N();return}for(let m=0;m<o.result.length;m++){let g=o.result[m],S=Symbol.for(g.pointer);if(f.push(S),Object.hasOwn(l,S)){let A=g,b=l[S].selectionResult;if(b.type==="value"&&A.type==="value"&&A.value===b.value)continue;if(b.type==="entity"&&A.type==="entity"&&A.ok===b.ok&&A.status===b.status&&A.value===b.value)continue}s=!0;let O={index:m,value:g.value,propType:g.type==="entity"?void 0:g.propType},h=pe(r.args,r.parentArgs,O);l[S]={octiron:h,selectionResult:g}}let d=Reflect.ownKeys(l);for(let m of d)f.includes(m)||(s=!0,delete l[m]);!p&&s&&N()}function i(s){return k(this,null,function*(){if(s.length===0)return;if(!_&&!r.args.mainEntity&&r.args.defer){t=!0;return}let p=[];for(let f of s)p.push(r.parentArgs.store.fetch(f,r.args.accept,{mainEntity:r.args.mainEntity}));yield Promise.allSettled(p)})}function u(s){let p=[];if(typeof o=="undefined")p=s.required;else for(let f of s.required)o.required.includes(f)||p.push(f);o=s,p.length>0&&i(p),a()}function c(){let{entity:s,selector:p,parentArgs:{value:f,store:d}}=r;if(!s&&!v(f)){d.unsubscribe(e),a();return}o=d.subscribe({key:e,selector:p,fragment:r.args.fragment,accept:r.args.accept,value:s?void 0:f,listener:u,mainEntity:r.args.mainEntity}),i(o.required),a()}return{oninit:({attrs:s})=>{r=s,c()},onbeforeupdate:({attrs:s})=>{let p=Tn(s,r);r=s,p&&(s.parentArgs.store.unsubscribe(e),c())},onbeforeremove:({attrs:s})=>{r=s,s.parentArgs.store.unsubscribe(e)},view:({attrs:s})=>{if(t)return r.args.loading;if(o==null||!o.complete)return s.args.loading;if((o.hasErrors||o.hasMissing)&&typeof s.args.fallback!="function")return s.args.fallback;if(o.result[0]!=null&&o.result[0].type==="alternative")return o.result[0].integration.render(null,s.args.fragment);let p=s.view,{pre:f,sep:d,post:m,start:g,end:S,predicate:O,loading:h,fallback:A}=r.args,b=[],P=Reflect.ownKeys(l).map((D=>{let F=l[D];return F.octiron.position=-1,F}));(g!=null||S!=null)&&(P=P.slice(g!=null?g:0,S)),O!=null&&(P=P.filter(({octiron:D})=>O(D))),f!=null&&b.push(ye.fragment({},[f]));for(let D=0;D<P.length;D++){let{selectionResult:F,octiron:B}=P[D];B.position=D+1,D!==0&&b.push(ye.fragment({},[d])),F.type==="value"?b.push(ye.fragment({},[p(B)])):!F.ok&&typeof A=="function"?b.push(ye.fragment({},[A(B,F.reason)])):F.ok?b.push(ye.fragment({},[p(B)])):b.push(ye.fragment({},[A]))}return m!=null&&b.push(ye.fragment({},[m])),b}}};import xn from"mithril";function zt({style:n,propType:e,type:t,firstPickComponent:r,typeDefs:o,fallbackComponent:l}){var a,i,u;if(r!=null)return r;if(e!=null&&((a=o[e])==null?void 0:a[n])!=null)return o[e][n];if(!Array.isArray(t)&&t!=null&&((i=o[t])==null?void 0:i[n])!=null)return o[t][n];if(Array.isArray(t)){for(let c of t)if(((u=o[c])==null?void 0:u[n])!=null)return o[c][n]}if(l!=null)return l}function Te(n){if(v(n)){if(typeof n["@type"]=="string")return!0;if(!Array.isArray(n["@type"]))return!1}else return!1;for(let e of n["@type"])if(typeof e!="string")return!1;return!0}function ct(n){if(Te(n))return n["@type"]}var xe=(n,e,t,r,o)=>{var c,s,p,f;let l=Object.assign({},(c=r==null?void 0:r.attrs)!=null?c:o==null?void 0:o.attrs),a=(s=r==null?void 0:r.component)!=null?s:(r==null?void 0:r.component)!==null?o==null?void 0:o.component:null,i=(p=r==null?void 0:r.fallbackComponent)!=null?p:(r==null?void 0:r.component)!==null?o==null?void 0:o.fallbackComponent:null,u=zt({style:n,propType:t==null?void 0:t.propType,type:ct(t.value),firstPickComponent:a,fallbackComponent:i,typeDefs:(f=r==null?void 0:r.typeDefs)!=null?f:e.typeDefs});return[l,u]};var Qt=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=xe("present",t,r,n,e);return{view({attrs:{o:a,rendererArgs:i},children:u}){return l==null?null:xn(l,{o:a,renderType:"present",value:i.value,attrs:o},u)}}};function X(n){if(Array.isArray(n))return!0;if(v(n)){if(Array.isArray(n["@list"]))return!0;if(Array.isArray(n["@set"]))return!0}return!1}function re(n){return Array.isArray(n)?n:Array.isArray(n["@list"])?n["@list"]:Array.isArray(n["@set"])?n["@set"]:[]}import Vt from"mithril";function oe(n,e,t){let r="",o=n,l=0,a=-1;for(;(a=o.indexOf(e))>-1;)r+=n.substring(l,l+a)+t,o=o.substring(a+e.length,o.length),l+=a+e.length;return o.length>0&&(r+=n.substring(n.length-o.length,n.length)),r}function In(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(decodeURIComponent(n[e]),"~1","/"),"~0","~"):r[e]=n[e];return r}function En(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=encodeURIComponent(oe(oe(n[e],"~","~0"),"/","~1")):r[e]=n[e];return r}function Zt(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(n[e],"~1","/"),"~0","~"):r[e]=n[e];return r}function Jn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(n[e],"~","~0"),"/","~1"):r[e]=n[e];return r}function kn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0)return[];if(n[0]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax. Non-empty pointer must begin with a solidus `/`.");return Zt(n.substring(1).split("/"))}function Ke(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"":"/".concat(Jn(n).join("/"))}function Nn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0||n[0]!=="#")throw new ReferenceError("Invalid JSON Pointer syntax; URI fragment identifiers must begin with a hash.");if(n.length===1)return[];if(n[1]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax.");return In(n.substring(2).split("/"))}function Ie(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"#":"#/".concat(En(n).join("/"))}var vt="Invalid Relative JSON Pointer syntax. Relative pointer must begin with a non-negative integer, followed by either the number sign (#), or a JSON Pointer.";function Xt(n){if(typeof n!="string")throw new TypeError("Invalid type: Relative JSON Pointers are represented as strings.");if(n.length===0)throw new ReferenceError(vt);let e=n.split("/"),t=e[0];if(t[t.length-1]=="#"){if(e.length>1)throw new ReferenceError(vt);t=t.substr(0,t.length-1)}let r=-1,o=t.length;for(;++r<o;)if(t[r]<"0"||t[r]>"9")throw new ReferenceError(vt);let l=Zt(e.slice(1));return l.unshift(e[0]),l}function Tt(n,e){if(typeof e=="number")return e;let t=e.length;if(!t)return-1;let r=0;if(t===1&&e[0]==="-")return Array.isArray(n)?n.length:0;for(;++r<t;)if(e[r]<"0"||e[r]>"9")return-1;return parseInt(e,10)}function Mn(n){let e="if (typeof(it) !== 'undefined'";return n.length===0?t=>t:(e=n.reduce((t,r,o)=>t+`
	&& it !== null && typeof((it = it['`+oe(oe(n[o]+"","\\","\\\\"),"'","\\'")+"'])) !== 'undefined'","if (typeof(it) !== 'undefined'"),e=e+`) {
	return it;
 }`,new Function("it",e))}function Dn(n,e,t,r=!1){if(t.length===0)throw new Error("Cannot set the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot set values on undefined");let o=n,l=t.length,a=t.length-1,i,u=-1,c,s;for(;++u<l;){if(i=t[u],typeof i!="string"&&typeof i!="number")throw new TypeError("PathSegments must be a string or a number.");if(i==="__proto__"||i==="constructor"||i==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(o)){if(i==="-"&&u===a){o.push(e);return}if(s=Tt(o,i),o.length>s){if(u===a){c=o[s],o[s]=e;break}o=o[s]}else if(u===a&&s===o.length){if(r){o.push(e);return}}else r&&(o=o[s]=u===a?e:{})}else{if(typeof o[i]=="undefined"){if(r){if(u===a){o[i]=e;return}let p=Number(t[u+1]);if(Number.isInteger(p)&&Tt(o[i],p)!==-1){o=o[i]=[];continue}o=o[i]={};continue}return}if(u===a){c=o[i],o[i]=e;break}o=o[i]}}return c}function Vn(n,e){if(e.length===0)throw new Error("Cannot unset the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot unset values on undefined");let t=n,r=e.length,o=e.length-1,l,a=-1,i,u;for(;++a<r;){if(l=e[a],typeof l!="string"&&typeof l!="number")throw new TypeError("PathSegments must be a string or a number.");if(l==="__proto__"||l==="constructor"||l==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(t)){if(u=Tt(t,l),u>=t.length)return;if(a===o){i=t[u],delete t[u];break}t=t[u]}else{if(typeof t[l]=="undefined")return;if(a===o){i=t[l],delete t[l];break}t=t[l]}}return i}function Ln(n){return typeof n=="string"&&n.length>0&&n[0]==="#"}function en(n){return Ln(n)?Nn:kn}function Yt(n){return Array.isArray(n)?n.slice(0):en(n)(n)}function xt(n){return typeof n=="object"&&n!==null}function Hn(n){return xt(n)&&!Ge.isReference(n)}function We(n,e,t){let r=new Map,o=[{obj:n,path:[]}];for(;o.length;){let{obj:l,path:a}=o.shift();if(e(t(a),l),Hn(l))if(r.set(l,new se(Ie(a))),Array.isArray(l)){let i=-1,u=l.length;for(;++i<u;){let c=l[i];xt(c)&&r.has(c)?o.push({obj:new Ge(r.get(c)),path:a.concat([i+""])}):o.push({obj:c,path:a.concat([i+""])})}}else{let i=Object.keys(l),u=i.length,c=-1;for(;++c<u;){let s=l[i[c]];xt(s)&&r.has(s)?o.push({obj:new Ge(r.get(s)),path:a.concat(i[c])}):o.push({obj:s,path:a.concat(i[c])})}}}}var Ct=Symbol("pointer"),Pt=Symbol("fragmentId"),jt=Symbol("getter"),se=class n{constructor(e){this.path=Yt(e)}static create(e){return new n(e)}static has(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.has(e)}static get(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.get(e)}static set(e,t,r,o=!1){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.set(e,r,o)}static unset(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.unset(e)}static decode(e){return en(e)(e)}static visit(e,t,r=!1){We(e,t,r?Ie:Ke)}static listPointers(e){let t=[];return We(e,(r,o)=>{t.push({pointer:r,value:o})},Ke),t}static listFragmentIds(e){let t=[];return We(e,(r,o)=>{t.push({fragmentId:r,value:o})},Ie),t}static flatten(e,t=!1){let r={};return We(e,(o,l)=>{r[o]=l},t?Ie:Ke),r}static map(e,t=!1){let r=new Map;return We(e,r.set.bind(r),t?Ie:Ke),r}get(e){return this[jt]||(this[jt]=Mn(this.path)),this[jt](e)}set(e,t,r=!1){return Dn(e,t,this.path,r)}unset(e){return Vn(e,this.path)}has(e){return typeof this.get(e)!="undefined"}parent(e){let t=this.path;return t.length==1?void 0:new n(t.slice(0,t.length-1)).get(e)}relative(e){let t=this.path,r=Xt(e),o=parseInt(r[0]);if(o>t.length)throw new Error("Relative location does not exist.");let l=t.slice(0,t.length-o).concat(r.slice(1));if(r[0][r[0].length-1]=="#"){let a=l[l.length-1];throw new Error(`We won't compile a pointer that will always return '${a}'. Use JsonPointer.rel(target, ptr) instead.`)}return new n(l)}rel(e,t){let r=this.path,o=Xt(t),l=parseInt(o[0]);if(l>r.length)return;let a=r.slice(0,r.length-l).concat(o.slice(1)),i=new n(a);if(o[0][o[0].length-1]=="#"){let u=a[a.length-1],c=i.parent(e);return Array.isArray(c)?parseInt(u,10):u}return i.get(e)}concat(e){return new n(this.path.concat(e instanceof n?e.path:Yt(e)))}get pointer(){return this[Ct]===void 0&&(this[Ct]=Ke(this.path)),this[Ct]}get uriFragmentIdentifier(){return this[Pt]||(this[Pt]=Ie(this.path)),this[Pt]}toString(){return this.pointer}},at=Symbol("pointer"),Ge=class{constructor(e){this[at]=e instanceof se?e:new se(e),this.$ref=this[at].uriFragmentIdentifier}static isReference(e){if(!e)return!1;let t=e;return typeof t.$ref=="string"&&typeof t.resolve=="function"}resolve(e){return this[at].get(e)}pointer(){return this[at]}toString(){return this.$ref}};var It=()=>{let n,e;function t(r){if(r.submitResult==null)n=void 0,e=void 0;else if(n==null||r.submitResult.ok!==n.ok||r.submitResult.status!==n.status||r.submitResult.value!==n.value){n=r.submitResult;let o={index:0,value:r.submitResult.value};e=pe(r.args,r.parentArgs,o)}}return{oninit:({attrs:r})=>{t(r)},onbeforeupdate:({attrs:r})=>{t(r)},view:c=>{var s=c,{attrs:p}=s,f=p,{type:r,selector:o,args:l,view:a}=f,i=ge(f,["type","selector","args","view"]),{children:u}=s;if(r==="initial"&&n==null)return u;if(n==null||e==null)return null;let d=r==="success"&&n.ok||r==="failure"&&!n.ok;return i.not&&(d=!d),e.position=1,d&&o!=null?e.select(o,l,a):d&&a!=null?a(e):d&&l!=null?e.present(l):(e.position=-1,null)}}};var rn=Pn(nn());function Et({payload:n,action:e}){let t,r,o="get",l,a,i=e["https://schema.org/target"];if(Array.isArray(i)){for(let f of i)if(f==="string"){i=f;break}else if(v(i)&&(i["https://schema.org/contentType"]==null||i["https://schema.org/contentType"]==="mutipart/form-data"||i["https://schema.org/contentType"]==="application/ld+json")){i=f;break}}if(typeof i=="string"?t=i:v(i)&&(typeof i["https://schema.org/urlTemplate"]=="string"&&(t=i["https://schema.org/urlTemplate"]),typeof i["https://schema.org/httpMethod"]=="string"&&(o=i["https://schema.org/httpMethod"].toLowerCase()),typeof i["https://schema.org/contentType"]=="string"&&(l=i["https://schema.org/contentType"]),typeof i["https://schema.org/encodingType"]=="string"&&(a=i["https://schema.org/encodingType"])),typeof t!="string")throw new Error("Action has invalid https://schema.org/target");let u={},c=Object.assign({},n);for(let[f,d]of Object.entries(e)){if(!Te(d)||d["@type"]!=="https://schema.org/PropertyValueSpecification")continue;let m=d["https://schema.org/valueName"];if(m!=null){let g=f.replace(/-input$/,"");u[m]=n[g],delete c[m]}}let p=(0,rn.default)(t).fill(u);return o!=="get"&&o!=="delete"?r=JSON.stringify(c):(l=void 0,a=void 0),{url:p,method:o,contentType:l,encodingType:a,body:r}}import Jt from"mithril";import Fn from"mithril";var on=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=xe("edit",t,r,n,e);return{view({attrs:{o:a,rendererArgs:i},children:u}){return l==null?null:Fn(l,{o:a,attrs:o,renderType:"edit",name:a.inputName,value:i.value,spec:i.spec,onchange:i.update,onChange:i.update},u)}}};function pt(n,e){let t={};for(let[r,o]of Object.entries(e))t[n.expand(r)]=o;return t}function sn(n,e,t){var a,i,u;let r=Object.assign({},n),o={action:e.action,submitting:e.submitting,value:t.value},l=fe("action-selection",r,e,t,o);return l.readonly=t.spec==null?!0:(a=t.spec.readonly)!=null?a:!1,l.inputName=((i=t.spec)==null?void 0:i.name)!=null?(u=t.spec)==null?void 0:u.name:t.propType,l.submitting=e.submitting,l.action=e.action,o.updatePointer=(c,s,p,f=r.interceptor)=>{var S;let d=t.value;if(!v(d)){console.warn("Non object action change intercepted.");return}let m=Object.assign({},d),g=se.create(c);s==null?g.unset(m):g.set(m,s,!0),typeof f=="function"&&(m=f(m,d,(S=t.actionValue)==null?void 0:S.value)),e.updatePointer(t.pointer,m,p)},l.update=(c,s)=>k(null,null,function*(){let p=t.value;if(!v(p))throw new Error("Cannot call update on a non object selection instance");typeof c=="function"?t.update(c(p)):c!=null&&t.update(c),s!=null&&s.submit||s!=null&&s.submitOnChange?yield e.submit():N()}),l.submit=()=>e.submit(),l.select=(c,s,p)=>{if(!v(t.value))return null;let[f,d,m]=Q(c,s,p);return Jt(ft,{parentArgs:o,selector:f,value:t.value,actionValue:t.actionValue.value,args:d,view:m})},l.edit=c=>l.readonly?l.present(c):Jt(on,{o:l,args:c,factoryArgs:r,parentArgs:e,rendererArgs:t}),l.default=c=>l.edit(Object.assign({component:null},c)),l.initial=e.action.initial,l.success=e.action.success,l.failure=e.action.failure,l.remove=(c={})=>{if(t.propType==null)return;let s=e.parent.value,p=s[t.propType];if(X(p)){let f=re(p);f.splice(l.index,1),f.length===0&&delete s[t.propType]}else v(p)&&delete s[t.propType];N()},l.append=(c,s={},p={})=>{if(!v(t.value)){console.warn(`Attempt to append to non object octiron selection ${c}`);return}let f,d=e.store.expand(c),m=t.value[d];return v(s)&&(s=pt(l.store,s)),m==null?f=s:Array.isArray(m)?f=[...m,s]:f=[m,s],e.updatePointer(t.pointer,Object.assign({},t.value,{[d]:f}),p)},l}function ln(...n){return`${n.map(t=>t.replace(/~/g,"~0").replace(/\//g,"~1")).join("/")}`}function W(n){return v(n)&&typeof n["@id"]=="string"&&n["@id"]!==""}function me(n){let e=Object.keys(n);if(e.length===0)return!1;for(let t of e)if(!t.startsWith("@")||t==="@value"||t==="@list"||t==="@set")return!1;return!0}function Ee(n){return typeof n["@value"]!="undefined"}var Un=new RegExp("\\s*(?<subject>([^\\[\\s]+))(\\[(?<filter>([^\\]])+)\\])?\\s*","g");function kt(n,e){var o,l;let t,r=[];for(;t=Un.exec(n);){let a=(o=t.groups)==null?void 0:o.subject,i=(l=t.groups)==null?void 0:l.filter;if(typeof i=="string"&&typeof a=="string")r.push({subject:e.expand(a),filter:i});else if(typeof a=="string")r.push({subject:e.expand(a)});else throw new Error(`Invalid selector: ${n}`)}return r}var $n=/^https?\:\/\//,cn=/^https?\:\/\/schema\.org/,qn=new RegExp("^https?\\:\\/\\/schema\\.org\\/(?<term>(readonlyValue|valueName|valueRequired|defaultValue|minValue|maxValue|stepValue|valuePattern|multipleValues|valueMinLength|valueMaxLength))");function an({spec:n,store:e}){var l;let t={readonlyValue:!1,valueRequired:!1},r,o=e.vocab==null?!1:cn.test(e.vocab);for(let[a,i]of Object.entries(e.aliases))if(cn.test(i)){r=[a,i];break}for(let[a,i]of Object.entries(n)){let u;if($n.test(a)?u=a:o&&!a.includes(":")?u=`${e.vocab}${a}`:r&&a.startsWith(`${r[0]}:`)&&(u=a.replace(`${r[0]}:`,r[1])),!u)continue;let c=qn.exec(u);(l=c==null?void 0:c.groups)!=null&&l.term&&(t[c.groups.term]=i)}return{readonly:t.readonlyValue,required:t.valueRequired,name:t.valueName,min:t.minValue,max:t.maxValue,step:t.stepValue,pattern:t.valuePattern,multiple:t.multipleValues,minLength:t.valueMinLength,maxLength:t.valueMaxLength}}var Nt=class extends Error{};function un(n){for(let e=0;e<n.result.length;e++){let t=n.result[e];t.key=Symbol.for(t.keySource),delete t.keySource}return n}function Je({selector:n,value:e,fragment:t,accept:r,actionValue:o,defaultValue:l,store:a}){let i={selector:n,complete:!1,hasErrors:!1,hasMissing:!1,required:[],dependencies:[],result:[]};if(e==null){let[{subject:c,filter:s},...p]=kt(n,a),[f,d]=c.split("#");return ze({keySource:"",pointer:"",iri:f,fragment:d!=null?d:t,accept:r,filter:s,selector:p.length>0?p:void 0,store:a,details:i}),i.complete=i.required.length===0,un(i)}let u=kt(n,a);_e({keySource:"",pointer:"",value:e,actionValue:o,selector:u,store:a,details:i,defaultValue:l}),i.complete=i.required.length===0;for(let c=0;c<i.result.length;c++){let s=i.result[c];s.key=Symbol.for(s.keySource)}return un(i)}function z(n,e){return`${n}/${ln(e.toString())}`}function Mt({value:n,filter:e}){return typeof e!="string"?!0:Array.isArray(n["@type"])?n["@type"].includes(e):n["@type"]===e}function Dt(n){return n!==null&&typeof n!="undefined"&&typeof n!="boolean"&&typeof n!="number"&&typeof n!="string"}function mt({keySource:n,pointer:e,value:t,propType:r,filter:o,spec:l,actionValue:a,store:i,details:u}){if(t===void 0){u.hasMissing=!0;return}else if(t===null&&v(a)){for(let c of Object.values(a))if(Te(c)&&c["@type"]==="https://schema.org/PropertyValueSpecification")return}if(l!=null&&(!X(t)||!v(a))){let c=an({spec:l,store:i});v(t)&&Ee(t)&&(t=t["@value"]),u.result.push({keySource:e,pointer:e,type:"action-value",propType:r,value:t,actionValue:a,spec:c,readonly:c.readonly});return}if(Dt(t)){if(X(t)){let c=re(t);for(let s=0;s<c.length;s++){let p=c[s];if(W(p)||(n=z(n,s)),mt({keySource:n,pointer:z(e,s),value:p,spec:l,actionValue:a,propType:r,filter:o,store:i,details:u}),u.hasErrors||u.hasMissing)return}return}}else{u.result.push({keySource:e,pointer:e,type:"value",propType:r,value:t});return}if(!(typeof o=="string"&&!Mt({value:t,filter:o}))){if(Ee(t)){mt({keySource:n,pointer:e,value:t["@value"],propType:r,store:i,details:u});return}else if(me(t)){ze({keySource:n,pointer:e,iri:t["@id"],filter:o,store:i,details:u});return}if(W(t)){let c=t["@id"];u.result.push({keySource:n,pointer:e,type:"entity",iri:c,ok:!0,value:t});return}u.result.push({keySource:n,pointer:e,type:"value",propType:r,value:t})}}function pn({keySource:n,pointer:e,propType:t,value:r,actionValue:o,filter:l,store:a,details:i}){if(e=z(e,t),!Dt(r))return;if(X(r)){let c=re(r);for(let s=0;s<c.length;s++){let p=c[s];if(W(p)||(n=z(n,s)),pn({keySource:n,pointer:z(e,s),propType:t,value:p,actionValue:o,filter:l,store:a,details:i}),i.hasErrors||i.hasMissing)return}return}if(me(r)&&W(r)){ze({keySource:n,pointer:e,iri:r["@id"],selector:[{subject:t,filter:l}],store:a,details:i});return}else if(me(r))return;let u;v(o)&&o[`${t}-input`]==null||(v(o)&&(u=o[`${t}-input`]),mt({keySource:n,pointer:e,value:r[t],spec:u,actionValue:o==null?void 0:o[t],propType:t,filter:l,store:a,details:i}))}function _e({keySource:n,pointer:e,selector:t,value:r,actionValue:o,store:l,details:a,defaultValue:i}){if(t.length===0)return;if(!Dt(r))return;if(X(r)){let d=re(r);for(let m=0;m<d.length;m++){let g=d[m];if(W(g)||(n=z(n,m)),_e({keySource:n,pointer:z(e,m),selector:t,value:g,actionValue:o,store:l,details:a,defaultValue:i}),a.hasErrors||a.hasMissing)return}return}else Ee(r)&&_e({keySource:n,pointer:e,selector:t,value:r["@value"],actionValue:o,store:l,details:a,defaultValue:i});if(me(r)&&W(r)){ze({keySource:n,pointer:e,selector:t,iri:r["@id"],store:l,details:a});return}v(r)&&o!==void 0&&r[t[0].subject]==null&&(r={[t[0].subject]:i!=null?i:null});let[u,...c]=t,{subject:s,filter:p}=u;if(r[s]===void 0){a.hasMissing=!0;return}if(c.length===0&&v(o==null?void 0:o[s])){e=z(e,s),mt({keySource:e,pointer:e,value:r[s],propType:s,details:a,store:l,actionValue:o==null?void 0:o[s],spec:o[`${s}-input`],filter:p});return}else if(c.length===0){pn({keySource:n,pointer:e,propType:s,filter:p,value:r,actionValue:o,store:l,details:a});return}if(typeof p=="string"&&!Mt({value:r,filter:p}))return;let f;v(o==null?void 0:o[s])&&(f=o[s]),_e({keySource:z(n,s),pointer:z(e,s),selector:c,value:r[s],actionValue:f,store:l,details:a})}function ze({keySource:n,pointer:e,iri:t,fragment:r,accept:o,filter:l,selector:a,store:i,details:u,handledIRIs:c}){n=z(n,t),e=z(e,t);let s=i.entity(t,o);if(u.dependencies.push(t),s==null||s.loading){u.required.includes(t)||(u.required.push(t),u.accept=o,u.fragment=r);return}if(!s.ok){if(u.hasErrors=!0,a==null||a.length===0)return;u.result.push({keySource:n,pointer:e,type:"entity",iri:s.iri,ok:!1,status:s.status,value:s.value,reason:s.reason});return}if(s.type==="alternative-success"){u.result.push({keySource:n,pointer:e,type:"alternative",contentType:s.integration.contentType,integration:s.integration});return}let p=s.value;if(me(p)){if(c==null)c=new Set([p["@id"]]);else if(!c.has(p["@id"]))c.add(p["@id"]);else throw new Nt("Circular selection loop detected");return ze({keySource:n,pointer:e,iri:p["@id"],filter:l,selector:a,details:u,store:i,handledIRIs:c})}if(!(typeof l=="string"&&!Mt({filter:l,value:p}))){if(typeof a=="undefined"){u.result.push({keySource:n,pointer:e,type:"entity",iri:s.iri,ok:!0,value:s.value});return}_e({keySource:n,pointer:e,value:p,selector:a,store:i,details:u})}}var ft=n=>{let e=n.attrs,t,r={};function o(){let a=!1,{parentArgs:i,selectionArgs:u}=e,c=[];for(let p=0;p<t.result.length;p++){let f=t.result[p];if(c.push(f.pointer),r[f.pointer]!=null){let{rendererArgs:h,octiron:A}=r[f.pointer],b=P=>i.updatePointer(f.pointer,P,u);h.value=A.value=f.value,h.spec=f.spec,h.update=b;continue}a=!0;let d=h=>i.updatePointer(f.pointer,h,u),m={index:p,value:f.actionValue,propType:f.propType},g=pe(e.args,i,m),S={index:p,update:d,actionValue:g,pointer:f.pointer,propType:f.propType,value:f.value,spec:f.spec},O=sn(e.args,i,S);r[f.pointer]={rendererArgs:S,selection:g,octiron:O,selectionResult:f}}let s=Object.keys(r);for(let p of s)c.includes(p)||(a=!0,delete r[p]);a&&typeof window!="undefined"&&N()}function l(){let{selector:a,value:i,actionValue:u}=e,{store:c}=e.parentArgs;v(i)&&(t=Je({selector:a,store:c,actionValue:u,value:i,defaultValue:e.args.initialValue}),o())}return{oninit:({attrs:a})=>{e=a,l()},onbeforeupdate:({attrs:a})=>{e=a;for(let i of Object.values(r))i.octiron._updateArgs("args",a.args);l()},view:({attrs:{view:a,args:i}})=>{if(t==null)return null;let{pre:u,sep:c,post:s,fallback:p}=i;if(typeof a=="undefined")return;let f=Object.values(r),d=[u];for(let m=0;m<f.length;m++){let{octiron:g,selectionResult:S}=f[m];g.position=m+1,m!==0&&d.push(c),S.value==null&&typeof p=="function"?d.push(null):S.value==null&&p!=null?d.push(p):d.push(a(g))}return d.push(s),d}}};function fn(n,e,t){let r=Object.assign(Object.create(null),n),o=Object.create(null),l;v(n.initialValue)?o=pt(e.store,n.initialValue):n.initialValue!=null&&console.warn("o.perform() only supports receiving JSON objects as initial values.");function a(){return k(this,null,function*(){let{url:d,method:m,body:g,contentType:S,encodingType:O}=Et({payload:o,action:t.value,store:e.store});s.submitting=!0,s.url=new URL(d,s.store.rootIRI),N();try{l=yield e.store.submit(d,{method:m,body:g,contentType:S,encodingType:O})}catch(h){console.error(h)}s.submitting=!1,N()})}function i(d){let m=o,g=$($({},m),d);typeof n.interceptor=="function"?o=n.interceptor(g,m,e.parent.value):o=g,c.value=s.value=d,N()}let c={value:o,submitting:!1,submit:a,updatePointer:(d,m,g)=>{let S=Object.assign({},o),O=se.create(d);m==null?O.unset(S):O.set(S,m,!0),i(S)}},s=fe("action",r,e,t,c);s.value=o,s.action=e.parent,s.actionValue=t.actionValue,c.action=s,c.submitting=s.submitting,s.select=(d,m,g)=>{let[S,O,h]=Q(d,m,g);return Vt(ft,{parentArgs:c,selector:S,value:s.value,actionValue:e.parent.value,args:O,view:h})},s.submit=function(d){return k(this,null,function*(){return typeof d=="function"?i(d(o)):d!=null&&i(d),yield a()})},s.update=function(d,m){return k(this,null,function*(){typeof d=="function"?i(d(o)):d!=null&&i(d),m!=null&&m.submit||m!=null&&m.submitOnChange?yield a():N()})},s.append=(d,m={},g={})=>{let S=e.store.expand(d);if(!v(s.value))return;let O=s.value[S],h=[];return O!=null&&!Array.isArray(O)?h.push(O):Array.isArray(O)&&(h=[...O.filter(A=>A!=null)]),h.push(m),s.update(ne($({},s.value),{[S]:h}),g)};let p=d=>m=>Vt(It,{not:d,type:"initial",args:{},submitResult:l,parentArgs:c},m),f=(d,m)=>(g,S,O)=>{let[h,A,b]=Q(g,S,O);return Vt(It,{not:m,type:d,selector:h,args:A,view:b,submitResult:l,parentArgs:c})};s.initial=p(),s.not.initial=p(!0),s.success=f("success"),s.not.success=f("success",!0),s.failure=f("failure"),s.not.failure=f("failure",!0);try{let d=Et({payload:s.value,action:t.value,store:e.store});s.url=new URL(d.url),s.method=d.method}catch(d){console.error(d)}return s.url!=null&&(l=e.store.entity(s.url.toString())),(typeof window=="undefined"&&n.submitOnInit&&l==null||typeof window!="undefined"&&n.submitOnInit)&&s.submit(),s}var mn=({attrs:n})=>{let e=Symbol("PerformRenderer"),t=n,r,o={};function l(){let c=!1,{args:s,parentArgs:p}=t,f=[];for(let m=0;m<r.result.length;m++){let g=r.result[m];if(f.push(g.pointer),Object.hasOwn(o,g.pointer)){let b=g,P=o[g.pointer].selectionResult;if(P.type==="value"&&b.type==="value"&&b.value===P.value)continue;if(P.type==="entity"&&b.type==="entity"&&(b.ok!==P.ok||b.status!==P.status||b.value!==P.value))continue;continue}c=!0;let S={index:m,value:g.value},O=pe(s,p,S),h={index:m,value:g.value,actionValue:O},A=fn(s,p,h);o[g.pointer]={action:A,octiron:O,selectionResult:g}}let d=Object.keys(o);for(let m of d)f.includes(m)||(c=!0,delete o[m]);c&&N()}function a(c){return k(this,null,function*(){if(c.length===0)return;let s=[];for(let p of c)s.push(t.parentArgs.store.fetch(p));yield Promise.allSettled(s)})}function i(c){let s=[];if(typeof r=="undefined")s=c.required;else for(let p of c.required)r.required.includes(p)||s.push(p);r=c,s.length>0&&a(s),l()}function u(){let{selector:c,parentArgs:s}=t;if(c==null){let p;W(s.parent.value)?p={pointer:"/local",key:Symbol.for("/local"),type:"entity",iri:s.parent.value["@id"],ok:!0,value:s.parent.value}:p={pointer:"/local",key:Symbol.for("/local"),type:"value",value:s.parent.value},r={selector:"",complete:!0,hasErrors:!1,hasMissing:!1,dependencies:[],required:[],result:[p]}}else r=s.store.subscribe({key:e,selector:c,value:s.parent.value,listener:i}),a(r.required);l()}return{oninit:({attrs:c})=>{t=c,u()},onbeforeupdate:({attrs:c})=>{c.selector!==t.selector&&(c.parentArgs.store.unsubscribe(e),u()),t=c;for(let s of Object.values(o))s.action._updateArgs("args",c.args)},onbeforeremove:({attrs:c})=>{t=c,c.parentArgs.store.unsubscribe(e)},view:({attrs:{view:c,args:s}})=>{if(r==null||!r.complete)return s.loading;let{pre:p,sep:f,post:d,fallback:m}=s;if(typeof c=="undefined")return;let g=Object.values(o),S=[p];for(let O=0;O<g.length;O++){let{selectionResult:h,action:A,octiron:b}=g[O];A.position=O+1,O!==0&&S.push(f),h.type==="value"?S.push(c(A)):!h.ok&&typeof m=="function"?S.push(m(b,h.reason)):h.ok?S.push(c(A)):S.push(m)}return S.push(d),S}}};var he={root:0,selection:1,action:2,"action-selection":3};function fe(n,e,t,r={},o={}){var c,s,p,f,d,m;let l=he[n],a=W(r.value)?r.value["@id"]:(c=r.propType)!=null?c:"octiron",i={[a]:(g,S)=>g(i)?S:null}[a];i.id=t.store.key(),i.isOctiron=!0,i.octironType=n,i.readonly=!0,i.value=(s=r.value)!=null?s:null,i.store=t.store,i.index=(p=r.index)!=null?p:0,i.position=-1,i.expand=g=>t.store.expand(g),o.parent=i,o.store=(f=e.store)!=null?f:t.store,o.typeDefs=(d=e.typeDefs)!=null?d:t.typeDefs,l!==he.root&&(i.propType=r.propType,i.dataType=ct(r.value)),i.not=(g,S)=>i==null||g(i)?null:S,i.get=g=>{var h,A;if(!v(i.value))return null;if(g.startsWith("@"))return i.value[g];let S=i.store.expand(g),O=(h=i.value[S])!=null?h:null;return X(O)?re(O):(A=i.value[S])!=null?A:null},i.enter=(g,S,O)=>{let[h,A,b]=Q(g,S,O);return Qe(lt,{entity:!0,selector:h,args:A,view:b,parentArgs:o})};let u=ne($({},o),{value:(m=t.store.entity(t.store.rootIRI))==null?void 0:m.value});switch(i.root=(g,S,O)=>{let h,[A,b,P]=Q(g,S,O);return A==null?h=t.store.rootIRI:h=`${t.store.rootIRI} ${A}`,Qe(lt,{entity:!0,selector:h,args:b,view:P,parentArgs:u})},l){case he.root:i.select=i.root;break;case he.selection:i.select=(g,S,O)=>{let[h,A,b]=Q(g,S,O);return v(r.value)?Qe(lt,{selector:h,args:A,view:b,parentArgs:o}):null}}switch(l){case he.root:i.present=i.root;break;default:i.present=g=>Qe(Qt,{o:i,args:g,factoryArgs:e,parentArgs:t,rendererArgs:r})}switch(i.default=g=>i.present(Object.assign({component:null},g)),l){case he.root:i.perform=(g,S,O)=>{let[h,A,b]=Q(g,S,O);return i.root(h,A,P=>P.perform(A,b))};break;default:{i.perform=(g,S,O)=>{let[h,A,b]=Q(g,S,O);return typeof h=="string"?i.select(h,A,P=>P.perform(A,b)):Qe(mn,{selector:h,args:A,view:b,parentArgs:o})};break}}if(l!==he.root){let g=(S,O)=>{let h=S==="args"?e:S==="parent"?t:r;for(let A of Object.keys(h))delete h[A];for(let[A,b]of Object.entries(O))h[A]=b};i._updateArgs=g}return i}function Lt(n){return fe("root",{},n)}import Ht from"mithril";import{processTemplate as Ft}from"@longform/longform";function Bn(n){let e="";for(let t=0;t<n.length;t++)e+=n[t].outerHTML;return e}var Kn=()=>{let n,e;function t(o){var u;if(n===o.fragment)return;if(n=o.fragment,o.fragment==null){e=o.output.root;return}let[l,a]=o.fragment.split("?");if(a==null){e=(u=o.output.fragments[l])==null?void 0:u.html;return}let i=o.output.templates[l];if(i!=null)try{let c=Object.fromEntries(new URLSearchParams(a));e=Ft(i,c,s=>{var p;return(p=o.output.fragments[s])==null?void 0:p.html})}catch(c){console.error(c)}}function r(o){if(o.fragment==null){if(o.output.root!=null&&o.output.dom==null){let c=document.createElement("template");c.innerHTML=o.output.root,o.output.dom=Array.from(c.content.children)}e=o.output.dom;return}let[l,a]=o.fragment.split("?");if(!(a!=null||o.output.templates[l]!=null)){let c=o.output.fragments[l];if(c==null)return;if(c.type==="text"){e=c.html;return}else if(c.dom==null&&c.html!=null){let s=document.createElement("template");s.innerHTML=c.html,c.dom=Array.from(s.content.children)}else if(c.dom==null)return;e=c.dom;return}let u=o.output.templates[l];if(u!=null)try{let c=Object.fromEntries(new URLSearchParams(a));e=Ft(u,c,s=>{var p;return o.output.fragments[s]!=null&&o.output.fragments[s].html==null&&o.output.fragments[s].dom!=null&&(o.output.fragments[s].html=Bn(o.output.fragments[s].dom)),(p=o.output.fragments[s])==null?void 0:p.html})}catch(c){console.error(c)}}return{oninit({attrs:o}){_?r(o):t(o)},view(){return _&&Array.isArray(e)?Ht.dom(e):typeof e=="string"?Ht.trust(e):null}}},ke,Ne,Se,Ae,gt,M,Me,dt,yt=class yt{constructor(e,{iri:t,contentType:r,output:o}){x(this,Me);wt(this,"integrationType","html-fragments");x(this,ke,!1);x(this,Ne,new Set);x(this,Se);x(this,Ae);x(this,gt);x(this,M);J(this,gt,e),J(this,Se,t),J(this,Ae,r),J(this,M,o)}get iri(){return y(this,Se)}get contentType(){return y(this,Ae)}get output(){return y(this,M)}getFragment(e){var t,r,o;return e!=null?(r=(t=y(this,M).fragments[e])==null?void 0:t.html)!=null?r:null:(o=y(this,M).root)!=null?o:null}text(e){if(e==null)return this.output.root==null&&y(this,M).dom&&(this.output.root=q(this,Me,dt).call(this,y(this,M).dom)),this.output.root;let[t,r]=e.split("?");if(r==null){let l=y(this,M).fragments[t];return l==null?void 0:(l.html==null&&l.dom&&(l.html=q(this,Me,dt).call(this,l.dom)),l.html)}let o=y(this,M).templates[t];if(o!=null)try{let l=Object.fromEntries(new URLSearchParams(r));return Ft(o,l,a=>{let i=y(this,M).fragments[a];if(i!=null)return i.html==null&&i.dom!=null&&(i.html=q(this,Me,dt).call(this,i.dom)),i.html})}catch(l){console.error(l)}}render(e,t){return _||(t==null?J(this,ke,!0):y(this,Ne).add(t)),Ht(Kn,{o:e,integration:this,fragment:t,output:y(this,M)})}getStateInfo(){let e={},t=[],r=Object.values(y(this,M).fragments);for(let o=0;o<r.length;o++)r[o].type==="text"?e[r[o].id]=r[o].html:t.push({id:r[o].id,type:r[o].type,selector:r[o].selector,rendered:y(this,Ne).has(r[o].id)});return{iri:y(this,Se),contentType:y(this,Ae),rendered:y(this,ke),selector:y(this,M).selector,templates:y(this,M).templates,texts:e,fragments:t}}toInitialState(){let e="",t=Object.values(y(this,M).fragments);y(this,M).root!=null&&!y(this,ke)&&(e+=`<template id="htmlfrag:${y(this,Se)}|${y(this,Ae)}">${y(this,M).root}</template>
`);for(let r=0;r<t.length;r++)t[r].type!=="text"&&(y(this,Ne).has(t[r].id)||(e+=`<template data-htmlfrag="${t[r].id}">${t[r].html}</template>
`));return e}static fromInitialState(e,{iri:t,contentType:r,rendered:o,selector:l,texts:a,fragments:i,templates:u}){let c=Object.create(null);if(c.fragments=Object.create(null),c.templates=u,l!=null&&o){let p=document.querySelector(l);p!=null&&(c.root=p.outerHTML)}else if(l!=null){let p=document.getElementById(`htmlfrag:${t}|${r}`);c.root=p==null?void 0:p.textContent}let s=Object.entries(a);for(let p=0;p<s.length;p++)c.fragments[s[p][0]]={id:s[p][0],type:"text",html:s[p][1],selector:""};for(let p=0;p<i.length;p++){let f=i[p],d=document.createDocumentFragment();if(f.rendered){let m;switch(f.type){case"embed":{if(m=document.getElementById(f.id),m==null)break;c.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"bare":{if(m=document.querySelector(f.selector),m==null)break;c.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"range":{let g=document.querySelectorAll(f.selector);c.fragments[f.id]={id:f.id,type:f.type,selector:f.selector,dom:Array.from(g)}}}}else{let m=document.querySelector(`[data-htmlfrag="${f.id}"]`);if(m==null)continue;c.fragments[f.id]={id:f.id,type:f.type,dom:Array.from(m.content.children),selector:f.selector}}}return new yt(e,{contentType:r,iri:t,output:c})}};ke=new WeakMap,Ne=new WeakMap,Se=new WeakMap,Ae=new WeakMap,gt=new WeakMap,M=new WeakMap,Me=new WeakSet,dt=function(e){let t="";for(let r=0;r<e.children.length;r++)t+=e.children[r].outerHTML;return t},wt(yt,"type","html-fragments");var De=yt;var Ve,Xe,ht=class{constructor(e,t){x(this,Ve);x(this,Xe);J(this,Ve,e),J(this,Xe,t)}get status(){return y(this,Ve)}get res(){return y(this,Xe)}undefined(){return null}http(e){return typeof e=="function"?e(y(this,Ve)):e}unparserable(){return null}};Ve=new WeakMap,Xe=new WeakMap;function Le(n,e=[]){if(Array.isArray(n))for(let t of n)Le(t,e);else if(v(n)){if(me(n))return e;if(W(n)&&e.push(n),Ee(n))Le(n["@value"],e);else if(X(n))Le(re(n),e);else for(let[t,r]of Object.entries(n))t.startsWith("@")||Le(r,e)}return e}var be="application/problem+json, application/ld+json",Wn={[De.type]:De};function Gn(n,e){let t=new Map,r={};if(n!=null&&(r["@vocab"]=n),e==null)return[t,r];for(let[o,l]of Object.entries(e))r[o]=l,t.set(o,l);return[t,r]}function _n(n,e){let t=new Headers([["accept",be]]),r=new Map;if(n!=null)for(let[o,l]of Object.entries(n))t.set(o,l);if(e!=null)for(let[o,l]of Object.entries(e)){let a=new Headers([["accept",be]]);for(let[i,u]of Object.entries(l))a.set(i,u);r.set(o,a)}return[t,r]}var le,Ze,et,ce,Oe,we,He,Y,Fe,de,tt,nt,rt,ot,Ue,$e,ie,Re,ae,U,Ut,$t,qt,dn,Bt,Ye=class Ye{constructor(e){x(this,U);x(this,le);x(this,Ze);x(this,et);x(this,ce);x(this,Oe);x(this,we);x(this,He);x(this,Y,new Map);x(this,Fe,new Set);x(this,de,new Map);x(this,tt);x(this,nt,new Set);x(this,rt);x(this,ot,new Map);x(this,Ue);x(this,$e);x(this,ie,new Map);x(this,Re,new Map);x(this,ae,new Map);var t,r;J(this,Ze,e.rootIRI),J(this,et,new URL(e.rootIRI).origin),J(this,we,e.vocab),J(this,Ue,e.fetcher),J(this,$e,e.responseHook),[Be(this,ce)._,Be(this,Oe)._]=_n(e.headers,e.origins),[Be(this,He)._,Be(this,rt)._]=Gn(e.vocab,e.aliases),J(this,tt,new Map((r=(t=e.handlers)==null?void 0:t.map)==null?void 0:r.call(t,o=>[o.contentType,o]))),e.primary!=null&&J(this,Y,new Map(Object.entries(e.primary))),y(this,ce).has("accept")||y(this,ce).set("accept",be);for(let o of Object.values(y(this,Oe)))o.has("accept")||o.set("accept",be);if(e.acceptMap!=null)for(let[o,l]of Object.entries(e.acceptMap))y(this,ae).set(o,new Map(l));e.alternatives!=null&&J(this,de,e.alternatives)}get httpStatus(){return y(this,le)}get rootIRI(){return y(this,Ze)}entity(e,t){var l,a,i,u;if(t==null)return(l=y(this,Y).get(e))!=null?l:null;let r=(i=(a=y(this,ae).get(e))==null?void 0:a.get)==null?void 0:i.call(a,t);if(r==null)return null;let o=(u=y(this,de).get(r))==null?void 0:u.get(e);return o==null?null:{type:"alternative-success",iri:e,loading:!1,ok:!0,integration:o}}text(e,t){let[r,o]=e.split("#"),l=this.entity(r,t);if(l!=null&&(l==null?void 0:l.type)==="alternative-success")return l.integration.text(o)}get vocab(){return y(this,we)}get aliases(){return Object.fromEntries(y(this,He).entries().map(([e,t])=>[e.replace(/^/,""),t]))}get context(){return y(this,rt)}expand(e){let t=Symbol.for(e),r=y(this,ot).get(t);if(r!=null)return r;let o;if(y(this,we)!=null&&!/^[\w\d]+\:/.test(e))o=y(this,we)+e;else if(/https?:\/\//.test(e))o=e;else for(let[l,a]of y(this,He)){let i=new RegExp(`^${l}:`);if(i.test(e)){o=e.replace(i,a);break}}return y(this,ot).set(t,o!=null?o:e),o!=null?o:e}select(e,t,{accept:r}={}){return Je({selector:e,value:t,accept:r,store:this})}key(){for(;;){let e=`oct-${Math.random().toString(36).slice(2,7)}`;if(!y(this,nt).has(e))return y(this,nt).add(e),e}}isLoading(e){let t=q(this,U,$t).call(this,e,"get");return y(this,Fe).has(t)}handleResponse(r){return k(this,arguments,function*(e,t=e.url.toString()){var a,i,u;let o=(u=(i=(a=e.headers.get("content-type"))==null?void 0:a.split)==null?void 0:i.call(a,";"))==null?void 0:u[0];if(o==null)throw new Error("Content type not specified in response");let l=y(this,tt).get(o);if(l==null)throw new Error(`No handler configured for content type "${o}"`);if(l.integrationType==="jsonld"){let c=yield l.handler({res:e,store:this});q(this,U,dn).call(this,{iri:t,res:e,output:c})}else{if(l.integrationType==="problem-details")throw new Error("Problem details response types not supported yet");if(l.integrationType==="html-fragments"){let c=yield l.handler({res:e,store:this}),s=y(this,de).get(o);s==null&&(s=new Map,y(this,de).set(o,s)),s.set(t,new De(l,{iri:t,contentType:o,output:c}))}}l.integrationType!=="jsonld"&&q(this,U,qt).call(this,t,o)})}subscribe({key:e,selector:t,fragment:r,accept:o,value:l,listener:a,mainEntity:i}){let u=Je({selector:t,fragment:r,accept:o,value:l,store:this}),c=q(this,U,Ut).call(this,e,u);for(let s of u.dependencies){let p=y(this,ie).get(s);p==null?y(this,ie).set(s,new Set([e])):p.add(e)}return y(this,Re).set(e,{key:e,selector:t,value:l,fragment:r,accept:o,required:u.required,dependencies:u.dependencies,listener:a,cleanup:c}),!_&&i&&u.hasMissing&&y(this,le)<400&&J(this,le,404),u}unsubscribe(e){var t;(t=y(this,Re).get(e))==null||t.cleanup()}fetch(o,l){return k(this,arguments,function*(e,t,{mainEntity:r}={}){return yield q(this,U,Bt).call(this,e,{accept:t,mainEntity:r}),y(this,Y).get(e)})}submit(e,t){return k(this,null,function*(){return yield q(this,U,Bt).call(this,e,ne($({},t),{contentType:"application/ld+json"})),this.entity(e)})}static fromInitialState({disableLogs:e,rootIRI:t,vocab:r,aliases:o,headers:l,origins:a,handlers:i=[]}){performance.mark("octiron:from-initial-state:start");let u={rootIRI:t,vocab:r,aliases:o,handlers:i,headers:l,origins:a};try{let c=document.getElementById("oct-state");if(c==null)return e||console.warn("Failed to construct Octiron state from initial state"),new Ye(u);let s=JSON.parse(c.innerText),p=new Map,f=i.reduce((m,g)=>ne($({},m),{[g.contentType]:g}),{});for(let[m,g]of Object.entries(s.alternatives))for(let S of g){let O=f[S.contentType],h=Wn[m];if(h.type!==O.integrationType)continue;let A=h.fromInitialState(O,S);if(A==null)continue;let b=p.get(A.contentType);b==null&&(b=new Map,p.set(A.contentType,b)),b.set(A.iri,A)}let d=new Ye(ne($({},u),{alternatives:p,primary:s.primary,acceptMap:s.acceptMap}));return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),d}catch(c){e||(console.warn("Failed to construct Octiron state from initial state"),console.error(c));let s=new Ye(u);return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),s}}toInitialState(){let e="",t={primary:Object.fromEntries(y(this,Y)),alternatives:{},acceptMap:{}};for(let[r,o]of y(this,ae).entries())t.acceptMap[r]=Array.from(o.entries());for(let r of y(this,de).values())for(let o of r.values())t.alternatives[o.integrationType]==null?t.alternatives[o.integrationType]=[o.getStateInfo()]:t.alternatives[o.integrationType].push(o.getStateInfo()),e+=o.toInitialState();return e+=`<script id="oct-state" type="application/json">${JSON.stringify(t)}<\/script>`,e}};le=new WeakMap,Ze=new WeakMap,et=new WeakMap,ce=new WeakMap,Oe=new WeakMap,we=new WeakMap,He=new WeakMap,Y=new WeakMap,Fe=new WeakMap,de=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=new WeakMap,ot=new WeakMap,Ue=new WeakMap,$e=new WeakMap,ie=new WeakMap,Re=new WeakMap,ae=new WeakMap,U=new WeakSet,Ut=function(e,t){return()=>{y(this,Re).delete(e);for(let r of t.dependencies)y(this,ie).delete(r),_&&setTimeout(()=>{var o;((o=y(this,ie).get(r))==null?void 0:o.size)===0&&y(this,Y).delete(r)},5e3)}},$t=function(e,t,r){var o;return r=(o=r!=null?r:y(this,ce).get("accept"))!=null?o:be,`${t==null?void 0:t.toLowerCase()}|${e}|${r.toLowerCase()}`},qt=function(e,t){let r=y(this,ie).get(e);if(r!=null)for(let o of r){let l=y(this,Re).get(o);if(l==null)continue;let a=Je({selector:l.selector,value:l.value,fragment:l.fragment,accept:l.accept,store:this}),i=q(this,U,Ut).call(this,o,a);for(let u of a.dependencies){let c=y(this,ie).get(u);c==null?(c=new Set([o]),y(this,ie).set(u,c)):c.add(o)}l.cleanup=i,l.listener(a)}},dn=function({iri:e,res:t,output:r}){let o=[e];if(t.ok)y(this,Y).set(e,{type:"entity-success",iri:e,loading:!1,ok:!0,value:r.jsonld});else{let l=new ht(t.status,t);y(this,Y).set(e,{type:"entity-failure",iri:e,loading:!1,ok:!1,value:r.jsonld,status:t.status,reason:l})}for(let l of Le(r.jsonld))o.includes(l["@id"])||y(this,Y).set(l["@id"],{type:"entity-success",iri:l["@id"],loading:!1,ok:!0,value:l});for(let l of o)q(this,U,qt).call(this,l)},Bt=function(r){return k(this,arguments,function*(e,t={}){var p,f;let o,l=new URL(e),a=t.method||"get",i=(f=(p=t.accept)!=null?p:y(this,ce).get("accept"))!=null?f:be;l.hash="";let u=l.toString(),c=q(this,U,$t).call(this,u,a,t.accept);if(l.origin===y(this,et))o=new Headers(y(this,ce));else if(y(this,Oe).has(l.origin))o=new Headers(y(this,Oe).get(l.origin));else throw new Error("Unconfigured origin");t.body!=null&&t.contentType!=null&&o.set("content-type",t.contentType),i!=null?o.set("accept",i):o.get("accept")==null&&o.set("accept",be),y(this,Fe).add(c),N();let s=new Promise(d=>{k(this,null,function*(){var g;let m=null;y(this,Ue)!=null?m=yield y(this,Ue).call(this,u,{method:a,headers:o,body:t.body}):m=yield fetch(u,{method:a,headers:o,body:t.body}),!_&&(y(this,le)==null||y(this,le)<400)&&!m.status.toString().startsWith("3")&&J(this,le,m.status),t.accept!=null&&y(this,ae).has(u)?(g=y(this,ae).get(u))==null||g.set(t.accept,m.headers.get("content-type")):t.accept!=null&&y(this,ae).set(u,new Map([[t.accept,m.headers.get("content-type")]])),yield this.handleResponse(m,e),y(this,Fe).delete(c),N(),d(m)})});y(this,$e)!=null&&y(this,$e).call(this,s),yield s})};var ve=Ye;function Kt(n,...e){let t={};if(n instanceof ve)for(let r of e)t[n.expand(r.type)]=r;else{t[n.type]=n;for(let r of e)t[r.type]=r}return t}function gn(...n){let e=[];for(let t of n)if(!(typeof t=="undefined"||t===null))if(typeof t=="string")e.push(t);else if(Array.isArray(t))for(let r of t)e.push(r);else for(let[r,o]of Object.entries(t))o&&e.push(r);return e.join(" ")}function xi(n){return n}import yn from"jsonld";var ki={integrationType:"jsonld",contentType:"application/ld+json",handler:e=>k(null,[e],function*({res:n}){let t=yield n.json();if(!v(t)&&!Array.isArray(t))throw new Error("JSON-LD Document should be an object");let r=yield yn.expand(t,{documentLoader:l=>k(null,null,function*(){let i=yield(yield fetch(l,{headers:{accept:"application/ld+json"}})).json();return{documentUrl:l,document:i}})});return{jsonld:yield yn.compact(r,{})}})};import{longform as zn}from"@longform/longform";var Vi={integrationType:"html-fragments",contentType:"text/longform",handler:e=>k(null,[e],function*({res:n}){return zn(yield n.text())})};import T from"mithril";var Wt=()=>{function n(i){return T("code",[T("span.oct-json-quote",'"'),T("a.oct-json-iri",{href:i},i),T("span.oct-json-quote",'"')])}function e(i){let u=typeof i=="boolean"?"oct-json-boolean":typeof i=="number"?"oct-json-number":"oct-json-string",c;return typeof i=="boolean"&&i?c="true":typeof i=="boolean"||(typeof i=="string"?c=[T("span.oct-json-quote",'"'),i,T("span.oct-json-quote",'"')]:c=i),T("code",{className:u},c)}function t(i,u,c=""){let s=[];for(let p=0;p<i.length;p++){let f=i[p];s.push(T("li.oct-json-arr-item",l(null,f,u,c)))}return T("ul.oct-json-arr",s)}let r=["@id","@type","@context"];function o(i,u,c=""){let s=[],p=Object.entries(i).toSorted();for(let f=0;f<p.length;f++){let[d,m]=p[f],g,S=[T("span.oct-json-quote",'"'),T("span.oct-json-obj-key",d),T("span.oct-json-quote",'"'),T("span.oct-json-obj-colon",": ")];if(d==="@id")g=[T("code",S),n(m)];else if(u==null||r.includes(d))g=l(S,m);else if(d.startsWith("@"))g=l(S,m,u,c);else{let O=`${c} ${d}`,h=new URL(u);h.searchParams.set("selector",O);let A=[T("span.oct-json-quote",'"'),T("span.oct-json-obj-key",T("a",{href:h},d)),T("span.oct-json-quote",'"'),T("span.oct-json-obj-colon",": ")];g=l(A,m,u,O)}s.push(T("li.oct-json-obj-item",g))}return T("ul.oct-json-obj",s)}function l(i,u,c,s=""){return v(u)?[T("details.oct-json-details",{open:!0},T("summary.oct-json-details-sum",T("code",i,T("span.oct-json-obj-open","{"))),a(u,c,s)),T("code.oct-json-obj-close","}")]:Array.isArray(u)?[T("details.oct-json-details",{open:!0},T("summary.oct-json-details-sum",T("code",i,T("span.oct-json-obj-open","["))),a(u,c,s)),T("code.oct-json-obj-close","]")]:[T("code",i),a(u,c,s)]}function a(i,u,c=""){return v(i)?o(i,u,c):Array.isArray(i)?t(i,u,c):e(i)}return{view:({attrs:{value:i,selector:u,location:c}})=>{let s=c!=null?new URL(c):void 0;return T(".oct-json",[l(null,i,s,typeof u=="string"?u.trim():void 0)])}}};import Z from"mithril";var St=({attrs:n})=>{var c;let e=n,t=n.o.value,r,o=(c=n.initialPresentationStyle)!=null?c:"value";function l(s=!0){let{o:p}=e;o==="value"?r=Z(Wt,{value:t,selector:e.selector,location:e.location}):o==="action-value"&&(p.octironType==="action"||p.octironType==="action-selection")&&(r=Z(Wt,{value:p.actionValue.value,selector:e.selector,location:e.location})),s&&N()}function a(s){s.redraw=!1,o="value",l()}function i(s){s.redraw=!1,o="action-value",l()}function u(s){s.redraw=!1,o="component",l()}return{oninit:({attrs:s})=>{e=s,l(!1)},onbeforeupdate:({attrs:s})=>{s.o.value!==t&&(t=s.o.value,l(!0))},view:({attrs:{o:s,availableControls:p}})=>{let f,d,m=[];return o==="component"?f=Z(".oct-debug-body",s.default()):f=Z(".oct-debug-body",r),(s.octironType==="action"||s.octironType==="action-selection")&&(d=Z("button.oct-button",{type:"button",onclick:i},"Action value")),p==null||p.includes("value")?m.push(Z("button.oct-button",{type:"button",onclick:a},"Value")):d!=null&&(p==null||p.includes("action-value"))?m.push(d):p==null||p.includes("component")?m.push(Z("button.oct-button",{type:"button",onclick:u},"Component")):(p==null||p.includes("log"))&&m.push(Z("button.oct-button",{type:"button",onclick:()=>console.debug(s)},"Log")),Z("aside.oct-debug",Z(".oct-debug-controls",Z(".oct-button-group",...m)),f)}}};import L from"mithril";var zi=({attrs:n})=>{let e=n.selector||"",t=e,r=e,o=n.presentationStyle||"debug",l=n.onChange,a={view:({attrs:{o:f}})=>L(St,{o:f,location:n.location})};function i(f){e=f.target.value}function u(f){f.key==="Enter"&&c()}function c(){r=e,typeof l=="function"&&l(r,o)}function s(f){f.preventDefault(),o="debug",typeof l=="function"&&l(r,o)}function p(f){f.preventDefault(),o="components",typeof l=="function"&&l(r,o)}return{oninit:({attrs:f})=>{l=f.onChange},onbeforeupdate:({attrs:f})=>{var d;r=(d=f.selector)!=null?d:"",r!==t&&(e=t=r),l=f.onChange},view:({attrs:{autofocus:f,o:d}})=>{var h,A;let m,g,S,O;if(r.length!==0&&o==="debug"?m=d.root(r,b=>L(St,{o:b,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?[]:void 0})):r.length!==0?m=d.root(r,b=>L("div",b.default({fallbackComponent:a,attrs:{selector:r}}))):o==="debug"?m=d.root(b=>L(St,{o:b,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?void 0:[]})):m=d.root(b=>L("div",b.default({fallbackComponent:a,attrs:{selector:r}}))),n.location!=null&&r.length!==0){let b=n.selector.trim().includes(" ")?n.selector.replace(/\s+([^\s]+)$/,""):"";g=new URL(n.location),b!=null?g.searchParams.set("selector",b):g.searchParams.delete("selector")}return n.location!=null&&(S=new URL(n.location),O=new URL(n.location),S.searchParams.set("presentationStyle","debug"),O.searchParams.set("presentationStyle","components")),L(".oct-explorer",L(".oct-explorer-controls",L("form.oct-form-group",{action:(A=(h=n.location)==null?void 0:h.toString)==null?void 0:A.call(h),onsubmit:b=>{b.preventDefault(),c()}},[g!=null?L("a.oct-button",{href:g.toString()},"Up"):L("button.oct-button",{type:"button",disabled:!0},"Up"),L("input",{name:"selector",value:e,autofocus:f,oninput:i,onkeypress:u}),L("button.oct-button",{type:"submit",disabled:r===e&&typeof window!="undefined"},"Apply")]),L(".oct-button-group",o==="debug"||S==null?L("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:s},"Debug"):L("a.oct-button",{href:S.toString(),onclick:s},"Debug"),o==="components"||O==null?L("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:p},"Components"):L("a.oct-button",{href:O.toString(),onclick:p},"Components"))),L("pre.oct-explorer-body",m))}}};import Qn from"mithril";var Yi=n=>{var o;let t=((o=n.attrs.o.method)==null?void 0:o.toUpperCase())||"POST",r={GET:"application/x-www-form-urlencoded",POST:"multipart/form-data"};return{view:u=>{var c=u,{attrs:s}=c,p=s,{o:l}=p,a=ge(p,["o"]),{children:i}=c;return Qn("form.oct-form",ne($({},a),{method:t,enctype:r[t||"GET"],action:l.url,onsubmit:f=>{f.preventDefault(),l.submit()}}),i)}}};import Xn from"mithril";var rs=()=>({view:({attrs:n,children:e})=>Xn("button.oct-button.oct-submit-button",{id:n.id,type:"submit",class:gn(n.class)},e)});function hn(t){var r=t,{typeDefs:n}=r,e=ge(r,["typeDefs"]);let o=new ve(e),l=n!=null?Kt(o,...n):{};return Lt({store:o,typeDefs:l})}hn.fromInitialState=t=>{var r=t,{typeDefs:n}=r,e=ge(r,["typeDefs"]);let o=ve.fromInitialState($({},e)),l=n!=null?Kt(o,...n):{};return Lt({store:o,typeDefs:l})};export{St as OctironDebug,zi as OctironExplorer,Yi as OctironForm,Wt as OctironJSON,rs as OctironSubmitButton,ve as Store,gn as classes,hn as default,ki as jsonLDHandler,Vi as longformHandler,xi as makeTypeDef,Kt as makeTypeDefs};
//# sourceMappingURL=octiron.min.js.map
