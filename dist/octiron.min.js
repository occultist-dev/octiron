var yn=Object.create;var St=Object.defineProperty,hn=Object.defineProperties,Sn=Object.getOwnPropertyDescriptor,An=Object.getOwnPropertyDescriptors,bn=Object.getOwnPropertyNames,it=Object.getOwnPropertySymbols,On=Object.getPrototypeOf,At=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable;var Wt=n=>{throw TypeError(n)};var ht=(n,e,t)=>e in n?St(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,U=(n,e)=>{for(var t in e||(e={}))At.call(e,t)&&ht(n,t,e[t]);if(it)for(var t of it(e))Kt.call(e,t)&&ht(n,t,e[t]);return n},Z=(n,e)=>hn(n,An(e));var de=(n,e)=>{var t={};for(var r in n)At.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&it)for(var r of it(n))e.indexOf(r)<0&&Kt.call(n,r)&&(t[r]=n[r]);return t};var wn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Rn=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of bn(e))!At.call(n,o)&&o!==t&&St(n,o,{get:()=>e[o],enumerable:!(r=Sn(e,o))||r.enumerable});return n};var vn=(n,e,t)=>(t=n!=null?yn(On(n)):{},Rn(e||!n||!n.__esModule?St(t,"default",{value:n,enumerable:!0}):t,n));var bt=(n,e,t)=>ht(n,typeof e!="symbol"?e+"":e,t),Ot=(n,e,t)=>e.has(n)||Wt("Cannot "+t);var h=(n,e,t)=>(Ot(n,e,"read from private field"),t?t.call(n):e.get(n)),I=(n,e,t)=>e.has(n)?Wt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),M=(n,e,t,r)=>(Ot(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),$=(n,e,t)=>(Ot(n,e,"access private method"),t);var qe=(n,e,t,r)=>({set _(o){M(n,e,o,t)},get _(){return h(n,e,r)}});var E=(n,e,t)=>new Promise((r,o)=>{var l=u=>{try{i(t.next(u))}catch(s){o(s)}},a=u=>{try{i(t.throw(u))}catch(s){o(s)}},i=u=>u.done?r(u.value):Promise.resolve(u.value).then(l,a);i((t=t.apply(n,e)).next())});var en=wn((Zt,at)=>{(function(n,e){typeof define=="function"&&define.amd?define("uri-templates",[],e):typeof at!="undefined"&&at.exports?at.exports=e():n.UriTemplate=e()})(Zt,function(){var n={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},e={"*":!0},t=/[:/&?#]/;function r(i){return encodeURI(i).replace(/%25[0-9][0-9]/g,function(u){return"%"+u.substring(3)})}function o(i){return i=i.replace(/%../g,""),encodeURIComponent(i)===i}function l(i){var u="";n[i.charAt(0)]&&(u=i.charAt(0),i=i.substring(1));var s="",c="",p=!0,f=!1,d=!1;u=="+"?p=!1:u=="."?(c=".",s="."):u=="/"?(c="/",s="/"):u=="#"?(c="#",p=!1):u==";"?(c=";",s=";",f=!0,d=!0):u=="?"?(c="?",s="&",f=!0):u=="&"&&(c="&",s="&",f=!0);for(var m=[],y=i.split(","),S=[],b={},g=0;g<y.length;g++){var A=y[g],O=null;if(A.indexOf(":")!=-1){var P=A.split(":");A=P[0],O=parseInt(P[1])}for(var q={};e[A.charAt(A.length-1)];)q[A.charAt(A.length-1)]=!0,A=A.substring(0,A.length-1);var F={truncate:O,name:A,suffices:q};S.push(F),b[A]=F,m.push(A)}var le=function(R){for(var C="",L=0,B=0;B<S.length;B++){var j=S[B],w=R(j.name);if(w==null||Array.isArray(w)&&w.length==0||typeof w=="object"&&Object.keys(w).length==0){L++;continue}if(B==L?C+=c:C+=s||",",Array.isArray(w)){f&&(C+=j.name+"=");for(var X=0;X<w.length;X++)X>0&&(C+=j.suffices["*"]&&s||",",j.suffices["*"]&&f&&(C+=j.name+"=")),C+=p?encodeURIComponent(w[X]).replace(/!/g,"%21"):r(w[X])}else if(typeof w=="object"){f&&!j.suffices["*"]&&(C+=j.name+"=");var x=!0;for(var J in w)x||(C+=j.suffices["*"]&&s||","),x=!1,C+=p?encodeURIComponent(J).replace(/!/g,"%21"):r(J),C+=j.suffices["*"]?"=":",",C+=p?encodeURIComponent(w[J]).replace(/!/g,"%21"):r(w[J])}else f&&(C+=j.name,(!d||w!="")&&(C+="=")),j.truncate!=null&&(w=w.substring(0,j.truncate)),C+=p?encodeURIComponent(w).replace(/!/g,"%21"):r(w)}return C},ce=function(R,C,L){if(c&&(R=R.substring(c.length)),S.length==1&&S[0].suffices["*"]){for(var B=S[0],j=B.name,w=B.suffices["*"]?R.split(s||","):[R],X=p&&R.indexOf("=")!=-1,x=1;x<w.length;x++){var R=w[x];X&&R.indexOf("=")==-1&&(w[x-1]+=(s||",")+R,w.splice(x,1),x--)}for(var x=0;x<w.length;x++){var R=w[x];p&&R.indexOf("=")!=-1&&(X=!0);var J=R.split(",");J.length==1?w[x]=J[0]:w[x]=J}if(f||X){for(var Y=C[j]||{},N=0;N<w.length;N++){var ve=R;if(!(f&&!ve)){if(typeof w[N]=="string"){var R=w[N],W=R.split("=",1)[0],R=R.substring(W.length+1);if(p){if(L&&!o(R))return;R=decodeURIComponent(R)}ve=R}else{var R=w[N][0],W=R.split("=",1)[0],R=R.substring(W.length+1);if(p){if(L&&!o(R))return;R=decodeURIComponent(R)}w[N][0]=R,ve=w[N]}if(p){if(L&&!o(W))return;W=decodeURIComponent(W)}Y[W]!==void 0?Array.isArray(Y[W])?Y[W].push(ve):Y[W]=[Y[W],ve]:Y[W]=ve}}Object.keys(Y).length==1&&Y[j]!==void 0?C[j]=Y[j]:C[j]=Y}else{if(p)for(var N=0;N<w.length;N++){var J=w[N];if(Array.isArray(J))for(var $e=0;$e<J.length;$e++){if(L&&!o(J[$e]))return;J[$e]=decodeURIComponent(J[$e])}else{if(L&&!o(J))return;w[N]=decodeURIComponent(J)}}C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(w):C[j]=[C[j]].concat(w):w.length==1&&!B.suffices["*"]?C[j]=w[0]:C[j]=w}}else{for(var w=S.length==1?[R]:R.split(s||","),ot={},x=0;x<w.length;x++){for(var Ce=0;Ce<S.length-1&&Ce<x&&!S[Ce].suffices["*"];Ce++);if(Ce==x){ot[x]=x;continue}else{for(var Pe=S.length-1;Pe>0&&S.length-Pe<w.length-x&&!S[Pe].suffices["*"];Pe--);if(S.length-Pe==w.length-x){ot[x]=Pe;continue}}ot[x]=Ce}for(var x=0;x<w.length;x++){var R=w[x];if(!(!R&&f)){var J=R.split(","),X=!1;if(f){var R=J[0],j=R.split("=",1)[0],R=R.substring(j.length+1);J[0]=R;var B=b[j]||S[0]}else var B=S[ot[x]],j=B.name;for(var N=0;N<J.length;N++)if(p){if(L&&!o(J[N]))return;J[N]=decodeURIComponent(J[N])}(f||B.suffices["*"])&&C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(J):C[j]=[C[j]].concat(J):J.length==1&&!B.suffices["*"]?C[j]=J[0]:C[j]=J}}}return 1};return{varNames:m,prefix:c,substitution:le,unSubstitution:ce}}function a(i){if(!(this instanceof a))return new a(i);for(var u=i.split("{"),s=[u.shift()],c=[],p=[],f=[],d=[];u.length>0;){var m=u.shift(),y=m.split("}")[0],S=m.substring(y.length+1),b=l(y);p.push(b.substitution),f.push(b.unSubstitution),c.push(b.prefix),s.push(S),d=d.concat(b.varNames)}this.fill=function(g){if(g&&typeof g!="function"){var A=g;g=function(F){return A[F]}}for(var O=s[0],P=0;P<p.length;P++){var q=p[P];O+=q(g),O+=s[P+1]}return O},this.fromUri=function(g,A){A=A||{};for(var O={},P=0;P<s.length;P++){var q=s[P];if(g.substring(0,q.length)!==q)return;if(g=g.substring(q.length),P>=s.length-1){if(g=="")break;return}var F=c[P];if(!(F&&g.substring(0,F.length)!==F)){for(var le=s[P+1],ce=P;;){if(ce==s.length-2){var R=g.substring(g.length-le.length);if(R!==le)return;var C=g.substring(0,g.length-le.length);g=R}else if(le){var L=g.indexOf(le),C=g.substring(0,L);g=g.substring(L)}else if(c[ce+1]){var L=g.indexOf(c[ce+1]);L===-1&&(L=g.length);var C=g.substring(0,L);g=g.substring(L)}else if(s.length>ce+2){ce++,le=s[ce+1];continue}else{var C=g;g=""}break}if(!f[P](C,O,A.strict))return}}return O},this.varNames=d,this.template=i}return a.prototype={toString:function(){return this.template},fillFromObject:function(i){return this.fill(i)},test:function(i,u){return!!this.fromUri(i,u)}},a})});import ze from"mithril";function v(n){return typeof n=="object"&&!Array.isArray(n)&&n!==null}function ee(n,e,t){let r,o={},l;return typeof n=="string"?r=n:typeof n=="function"?l=n:n!=null&&(o=n),typeof e=="function"?l=e:e!=null&&(o=e),typeof t=="function"&&(l=t),typeof l=="undefined"&&(l=(a=>a.default(o))),[r,o,l]}import ge from"mithril";function ae(n,e,t){let r=Object.assign({},n),o={value:t.value};return ue("selection",r,e,t,o)}import Cn from"mithril";var pe=typeof window!="undefined";function k(){pe&&Cn.redraw()}var Pn=Symbol.for("@pre"),jn=Symbol.for("@post");function Tn(n,e){return n.parentArgs.store!==e.parentArgs.store||n.selector!==e.selector||n.parentArgs.value!==e.parentArgs.value}var st=n=>{let e=Symbol("SelectionRenderer"),t=n.attrs,r,o={};function l(){let s=!1,c=r==null,p=[];if(r==null){let d=Reflect.ownKeys(o);for(let m of d)p.includes(m)||(s=!0,delete o[m]);s&&k();return}for(let d=0;d<r.result.length;d++){let m=r.result[d],y=Symbol.for(m.pointer);if(p.push(y),Object.hasOwn(o,y)){let g=m,A=o[y].selectionResult;if(A.type==="value"&&g.type==="value"&&g.value===A.value)continue;if(A.type==="entity"&&g.type==="entity"&&(g.ok!==A.ok||g.status!==A.status||g.value!==A.value))continue}s=!0;let S={index:d,value:m.value,propType:m.type==="entity"?void 0:m.propType},b=ae(t.args,t.parentArgs,S);o[y]={octiron:b,selectionResult:m}}let f=Reflect.ownKeys(o);for(let d of f)p.includes(d)||(s=!0,delete o[d]);!c&&s&&k()}function a(s,c){return E(this,null,function*(){if(s.length===0)return;let p=[];for(let f of s)p.push(t.parentArgs.store.fetch(f,c));yield Promise.allSettled(p)})}function i(s){let c=[];if(typeof r=="undefined")c=s.required;else for(let p of s.required)r.required.includes(p)||c.push(p);r=s,c.length>0&&a(c,t.args.accept),l()}function u(){let{entity:s,selector:c,parentArgs:{value:p,store:f},args:{accept:d,fragment:m}}=t;if(!s&&!v(p)){f.unsubscribe(e),l();return}r=f.subscribe({key:e,selector:c,fragment:m,accept:d,value:s?void 0:p,listener:i}),a(r.required,d),l()}return{oninit:({attrs:s})=>{t=s,u()},onbeforeupdate:({attrs:s})=>{let c=Tn(s,t);t=s,c&&(s.parentArgs.store.unsubscribe(e),u())},onbeforeremove:({attrs:s})=>{t=s,s.parentArgs.store.unsubscribe(e)},view:({attrs:s})=>{if(r==null||!r.complete)return s.args.loading;if((r.hasErrors||r.hasMissing)&&typeof s.args.fallback!="function")return s.args.fallback;if(r.result[0].type==="alternative")return r.result[0].integration.render(null,s.args.fragment);let c=t.view,{pre:p,sep:f,post:d,start:m,end:y,predicate:S,fallback:b}=t.args,g=[],A=Reflect.ownKeys(o).map((O=>{let P=o[O];return P.octiron.position=-1,P}));(m!=null||y!=null)&&(A=A.slice(m!=null?m:0,y)),S!=null&&(A=A.filter(({octiron:O})=>S(O))),p!=null&&g.push(ge.fragment({key:Pn},[p]));for(let O=0;O<A.length;O++){let{selectionResult:P,octiron:q}=A[O],{key:F}=P;q.position=O+1,O!==0&&g.push(ge.fragment({key:`@${Symbol.keyFor(F)}`},[f])),P.type==="value"?g.push(ge.fragment({key:F},[c(q)])):!P.ok&&typeof b=="function"?g.push(ge.fragment({key:F},[b(q,P.reason)])):P.ok?g.push(ge.fragment({key:F},[c(q)])):g.push(ge.fragment({key:F},[b]))}return d!=null&&g.push(ge.fragment({key:jn},[d])),g}}};import xn from"mithril";function Gt({style:n,propType:e,type:t,firstPickComponent:r,typeDefs:o,fallbackComponent:l}){var a,i,u;if(r!=null)return r;if(e!=null&&((a=o[e])==null?void 0:a[n])!=null)return o[e][n];if(!Array.isArray(t)&&t!=null&&((i=o[t])==null?void 0:i[n])!=null)return o[t][n];if(Array.isArray(t)){for(let s of t)if(((u=o[s])==null?void 0:u[n])!=null)return o[s][n]}if(l!=null)return l}function je(n){if(v(n)){if(typeof n["@type"]=="string")return!0;if(!Array.isArray(n["@type"]))return!1}else return!1;for(let e of n["@type"])if(typeof e!="string")return!1;return!0}function lt(n){if(je(n))return n["@type"]}var Te=(n,e,t,r,o)=>{var s,c,p,f;let l=Object.assign({},(s=r==null?void 0:r.attrs)!=null?s:o==null?void 0:o.attrs),a=(c=r==null?void 0:r.component)!=null?c:(r==null?void 0:r.component)!==null?o==null?void 0:o.component:null,i=(p=r==null?void 0:r.fallbackComponent)!=null?p:(r==null?void 0:r.component)!==null?o==null?void 0:o.fallbackComponent:null,u=Gt({style:n,propType:t==null?void 0:t.propType,type:lt(t.value),firstPickComponent:a,fallbackComponent:i,typeDefs:(f=r==null?void 0:r.typeDefs)!=null?f:e.typeDefs});return[l,u]};var _t=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=Te("present",t,r,n,e);return{view({attrs:{o:a,rendererArgs:i},children:u}){return l==null?null:xn(l,{o:a,renderType:"present",value:i.value,attrs:o},u)}}};function _(n){if(Array.isArray(n))return!0;if(v(n)){if(Array.isArray(n["@list"]))return!0;if(Array.isArray(n["@set"]))return!0}return!1}function te(n){return Array.isArray(n)?n:Array.isArray(n["@list"])?n["@list"]:Array.isArray(n["@set"])?n["@set"]:[]}import Dt from"mithril";function ne(n,e,t){let r="",o=n,l=0,a=-1;for(;(a=o.indexOf(e))>-1;)r+=n.substring(l,l+a)+t,o=o.substring(a+e.length,o.length),l+=a+e.length;return o.length>0&&(r+=n.substring(n.length-o.length,n.length)),r}function In(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=ne(ne(decodeURIComponent(n[e]),"~1","/"),"~0","~"):r[e]=n[e];return r}function Jn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=encodeURIComponent(ne(ne(n[e],"~","~0"),"/","~1")):r[e]=n[e];return r}function Xt(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=ne(ne(n[e],"~1","/"),"~0","~"):r[e]=n[e];return r}function En(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=ne(ne(n[e],"~","~0"),"/","~1"):r[e]=n[e];return r}function kn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0)return[];if(n[0]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax. Non-empty pointer must begin with a solidus `/`.");return Xt(n.substring(1).split("/"))}function Be(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"":"/".concat(En(n).join("/"))}function Mn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0||n[0]!=="#")throw new ReferenceError("Invalid JSON Pointer syntax; URI fragment identifiers must begin with a hash.");if(n.length===1)return[];if(n[1]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax.");return In(n.substring(2).split("/"))}function xe(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"#":"#/".concat(Jn(n).join("/"))}var wt="Invalid Relative JSON Pointer syntax. Relative pointer must begin with a non-negative integer, followed by either the number sign (#), or a JSON Pointer.";function zt(n){if(typeof n!="string")throw new TypeError("Invalid type: Relative JSON Pointers are represented as strings.");if(n.length===0)throw new ReferenceError(wt);let e=n.split("/"),t=e[0];if(t[t.length-1]=="#"){if(e.length>1)throw new ReferenceError(wt);t=t.substr(0,t.length-1)}let r=-1,o=t.length;for(;++r<o;)if(t[r]<"0"||t[r]>"9")throw new ReferenceError(wt);let l=Xt(e.slice(1));return l.unshift(e[0]),l}function Pt(n,e){if(typeof e=="number")return e;let t=e.length;if(!t)return-1;let r=0;if(t===1&&e[0]==="-")return Array.isArray(n)?n.length:0;for(;++r<t;)if(e[r]<"0"||e[r]>"9")return-1;return parseInt(e,10)}function Dn(n){let e="if (typeof(it) !== 'undefined'";return n.length===0?t=>t:(e=n.reduce((t,r,o)=>t+`
	&& it !== null && typeof((it = it['`+ne(ne(n[o]+"","\\","\\\\"),"'","\\'")+"'])) !== 'undefined'","if (typeof(it) !== 'undefined'"),e=e+`) {
	return it;
 }`,new Function("it",e))}function Nn(n,e,t,r=!1){if(t.length===0)throw new Error("Cannot set the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot set values on undefined");let o=n,l=t.length,a=t.length-1,i,u=-1,s,c;for(;++u<l;){if(i=t[u],typeof i!="string"&&typeof i!="number")throw new TypeError("PathSegments must be a string or a number.");if(i==="__proto__"||i==="constructor"||i==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(o)){if(i==="-"&&u===a){o.push(e);return}if(c=Pt(o,i),o.length>c){if(u===a){s=o[c],o[c]=e;break}o=o[c]}else if(u===a&&c===o.length){if(r){o.push(e);return}}else r&&(o=o[c]=u===a?e:{})}else{if(typeof o[i]=="undefined"){if(r){if(u===a){o[i]=e;return}let p=Number(t[u+1]);if(Number.isInteger(p)&&Pt(o[i],p)!==-1){o=o[i]=[];continue}o=o[i]={};continue}return}if(u===a){s=o[i],o[i]=e;break}o=o[i]}}return s}function Vn(n,e){if(e.length===0)throw new Error("Cannot unset the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot unset values on undefined");let t=n,r=e.length,o=e.length-1,l,a=-1,i,u;for(;++a<r;){if(l=e[a],typeof l!="string"&&typeof l!="number")throw new TypeError("PathSegments must be a string or a number.");if(l==="__proto__"||l==="constructor"||l==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(t)){if(u=Pt(t,l),u>=t.length)return;if(a===o){i=t[u],delete t[u];break}t=t[u]}else{if(typeof t[l]=="undefined")return;if(a===o){i=t[l],delete t[l];break}t=t[l]}}return i}function Ln(n){return typeof n=="string"&&n.length>0&&n[0]==="#"}function Yt(n){return Ln(n)?Mn:kn}function Qt(n){return Array.isArray(n)?n.slice(0):Yt(n)(n)}function jt(n){return typeof n=="object"&&n!==null}function Hn(n){return jt(n)&&!We.isReference(n)}function Ke(n,e,t){let r=new Map,o=[{obj:n,path:[]}];for(;o.length;){let{obj:l,path:a}=o.shift();if(e(t(a),l),Hn(l))if(r.set(l,new oe(xe(a))),Array.isArray(l)){let i=-1,u=l.length;for(;++i<u;){let s=l[i];jt(s)&&r.has(s)?o.push({obj:new We(r.get(s)),path:a.concat([i+""])}):o.push({obj:s,path:a.concat([i+""])})}}else{let i=Object.keys(l),u=i.length,s=-1;for(;++s<u;){let c=l[i[s]];jt(c)&&r.has(c)?o.push({obj:new We(r.get(c)),path:a.concat(i[s])}):o.push({obj:c,path:a.concat(i[s])})}}}}var Rt=Symbol("pointer"),vt=Symbol("fragmentId"),Ct=Symbol("getter"),oe=class n{constructor(e){this.path=Qt(e)}static create(e){return new n(e)}static has(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.has(e)}static get(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.get(e)}static set(e,t,r,o=!1){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.set(e,r,o)}static unset(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.unset(e)}static decode(e){return Yt(e)(e)}static visit(e,t,r=!1){Ke(e,t,r?xe:Be)}static listPointers(e){let t=[];return Ke(e,(r,o)=>{t.push({pointer:r,value:o})},Be),t}static listFragmentIds(e){let t=[];return Ke(e,(r,o)=>{t.push({fragmentId:r,value:o})},xe),t}static flatten(e,t=!1){let r={};return Ke(e,(o,l)=>{r[o]=l},t?xe:Be),r}static map(e,t=!1){let r=new Map;return Ke(e,r.set.bind(r),t?xe:Be),r}get(e){return this[Ct]||(this[Ct]=Dn(this.path)),this[Ct](e)}set(e,t,r=!1){return Nn(e,t,this.path,r)}unset(e){return Vn(e,this.path)}has(e){return typeof this.get(e)!="undefined"}parent(e){let t=this.path;return t.length==1?void 0:new n(t.slice(0,t.length-1)).get(e)}relative(e){let t=this.path,r=zt(e),o=parseInt(r[0]);if(o>t.length)throw new Error("Relative location does not exist.");let l=t.slice(0,t.length-o).concat(r.slice(1));if(r[0][r[0].length-1]=="#"){let a=l[l.length-1];throw new Error(`We won't compile a pointer that will always return '${a}'. Use JsonPointer.rel(target, ptr) instead.`)}return new n(l)}rel(e,t){let r=this.path,o=zt(t),l=parseInt(o[0]);if(l>r.length)return;let a=r.slice(0,r.length-l).concat(o.slice(1)),i=new n(a);if(o[0][o[0].length-1]=="#"){let u=a[a.length-1],s=i.parent(e);return Array.isArray(s)?parseInt(u,10):u}return i.get(e)}concat(e){return new n(this.path.concat(e instanceof n?e.path:Qt(e)))}get pointer(){return this[Rt]===void 0&&(this[Rt]=Be(this.path)),this[Rt]}get uriFragmentIdentifier(){return this[vt]||(this[vt]=xe(this.path)),this[vt]}toString(){return this.pointer}},ct=Symbol("pointer"),We=class{constructor(e){this[ct]=e instanceof oe?e:new oe(e),this.$ref=this[ct].uriFragmentIdentifier}static isReference(e){if(!e)return!1;let t=e;return typeof t.$ref=="string"&&typeof t.resolve=="function"}resolve(e){return this[ct].get(e)}pointer(){return this[ct]}toString(){return this.$ref}};var Tt=()=>{let n,e;function t(r){if(r.submitResult==null)n=void 0,e=void 0;else if(n==null||r.submitResult.ok!==n.ok||r.submitResult.status!==n.status||r.submitResult.value!==n.value){n=r.submitResult;let o={index:0,value:r.submitResult.value};e=ae(r.args,r.parentArgs,o)}}return{oninit:({attrs:r})=>{t(r)},onbeforeupdate:({attrs:r})=>{t(r)},view:s=>{var c=s,{attrs:p}=c,f=p,{type:r,selector:o,args:l,view:a}=f,i=de(f,["type","selector","args","view"]),{children:u}=c;if(r==="initial"&&n==null)return u;if(n==null||e==null)return null;let d=r==="success"&&n.ok||r==="failure"&&!n.ok;return i.not&&(d=!d),e.position=1,d&&o!=null?e.select(o,l,a):d&&a!=null?a(e):d&&l!=null?e.present(l):(e.position=-1,null)}}};var tn=vn(en());function xt({payload:n,action:e}){let t,r,o="get",l,a,i=e["https://schema.org/target"];if(Array.isArray(i)){for(let f of i)if(f==="string"){i=f;break}else if(v(i)&&(i["https://schema.org/contentType"]==null||i["https://schema.org/contentType"]==="mutipart/form-data"||i["https://schema.org/contentType"]==="application/ld+json")){i=f;break}}if(typeof i=="string"?t=i:v(i)&&(typeof i["https://schema.org/urlTemplate"]=="string"&&(t=i["https://schema.org/urlTemplate"]),typeof i["https://schema.org/httpMethod"]=="string"&&(o=i["https://schema.org/httpMethod"].toLowerCase()),typeof i["https://schema.org/contentType"]=="string"&&(l=i["https://schema.org/contentType"]),typeof i["https://schema.org/encodingType"]=="string"&&(a=i["https://schema.org/encodingType"])),typeof t!="string")throw new Error("Action has invalid https://schema.org/target");let u={},s=Object.assign({},n);for(let[f,d]of Object.entries(e)){if(!je(d)||d["@type"]!=="https://schema.org/PropertyValueSpecification")continue;let m=d["https://schema.org/valueName"];if(m!=null){let y=f.replace(/-input$/,"");u[m]=n[y],delete s[m]}}let p=(0,tn.default)(t).fill(u);return o!=="get"&&o!=="delete"?r=JSON.stringify(s):(l=void 0,a=void 0),{url:p,method:o,contentType:l,encodingType:a,body:r}}import It from"mithril";import Fn from"mithril";var nn=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=Te("edit",t,r,n,e);return{view({attrs:{o:a,rendererArgs:i},children:u}){return l==null?null:Fn(l,{o:a,attrs:o,renderType:"edit",name:a.inputName,value:i.value,spec:i.spec,onchange:i.update,onChange:i.update},u)}}};function rn(n,e,t){var a,i,u;let r=Object.assign({},n),o={action:e.action,submitting:e.submitting,value:t.value},l=ue("action-selection",r,e,t,o);return l.readonly=t.spec==null?!0:(a=t.spec.readonly)!=null?a:!1,l.inputName=((i=t.spec)==null?void 0:i.name)!=null?(u=t.spec)==null?void 0:u.name:t.propType,l.submitting=e.submitting,l.action=e.action,o.updatePointer=(s,c,p,f=r.interceptor)=>{var S;let d=t.value;if(!v(d)){console.warn("Non object action change intercepted.");return}let m=Object.assign({},d),y=oe.create(s);c==null?y.unset(m):y.set(m,c,!0),typeof f=="function"&&(m=f(m,d,(S=t.actionValue)==null?void 0:S.value)),e.updatePointer(t.pointer,m,p)},l.update=(s,c)=>E(null,null,function*(){let p=t.value;if(!v(p))throw new Error("Cannot call update on a non object selection instance");typeof s=="function"?t.update(s(p)):s!=null&&t.update(s),c!=null&&c.submit||c!=null&&c.submitOnChange?yield e.submit():k()}),l.submit=()=>e.submit(),l.select=(s,c,p)=>{if(!v(t.value))return null;let[f,d,m]=ee(s,c,p);return It(ut,{parentArgs:o,selector:f,value:t.value,actionValue:t.actionValue.value,args:d,view:m})},l.edit=s=>l.readonly?l.present(s):It(nn,{o:l,args:s,factoryArgs:r,parentArgs:e,rendererArgs:t}),l.default=s=>l.edit(Object.assign({component:null},s)),l.initial=e.action.initial,l.success=e.action.success,l.failure=e.action.failure,l.remove=(s={})=>{if(t.propType==null)return;let c=e.parent.value,p=c[t.propType];if(_(p)){let f=te(p);f.splice(l.index,1),f.length===0&&delete c[t.propType]}else v(p)&&delete c[t.propType];k()},l.append=(s,c={},p={})=>{if(!v(t.value)){console.warn(`Attempt to append to non object octiron selection ${s}`);return}let f,d=e.store.expand(s),m=t.value[d];return m==null?f=c:Array.isArray(m)?f=[...m,c]:f=[m,c],e.updatePointer(t.pointer,Object.assign({},t.value,{[d]:f}),p)},l}function on(...n){return`${n.map(t=>t.replace(/~/g,"~0").replace(/\//g,"~1")).join("/")}`}function K(n){return v(n)&&typeof n["@id"]=="string"&&n["@id"]!==""}function fe(n){let e=Object.keys(n);if(e.length===0)return!1;for(let t of e)if(!t.startsWith("@")||t==="@value"||t==="@list"||t==="@set")return!1;return!0}function Ie(n){return typeof n["@value"]!="undefined"}var Un=new RegExp("\\s*(?<subject>([^\\[\\s]+))(\\[(?<filter>([^\\]])+)\\])?\\s*","g");function Jt(n,e){var o,l;let t,r=[];for(;t=Un.exec(n);){let a=(o=t.groups)==null?void 0:o.subject,i=(l=t.groups)==null?void 0:l.filter;if(typeof i=="string"&&typeof a=="string")r.push({subject:e.expand(a),filter:i});else if(typeof a=="string")r.push({subject:e.expand(a)});else throw new Error(`Invalid selector: ${n}`)}return r}var $n=/^https?\:\/\//,sn=/^https?\:\/\/schema\.org/,qn=new RegExp("^https?\\:\\/\\/schema\\.org\\/(?<term>(readonlyValue|valueName|valueRequired|defaultValue|minValue|maxValue|stepValue|valuePattern|multipleValues|valueMinLength|valueMaxLength))");function ln({spec:n,store:e}){var l;let t={readonlyValue:!1,valueRequired:!1},r,o=e.vocab==null?!1:sn.test(e.vocab);for(let[a,i]of Object.entries(e.aliases))if(sn.test(i)){r=[a,i];break}for(let[a,i]of Object.entries(n)){let u;if($n.test(a)?u=a:o&&!a.includes(":")?u=`${e.vocab}${a}`:r&&a.startsWith(`${r[0]}:`)&&(u=a.replace(`${r[0]}:`,r[1])),!u)continue;let s=qn.exec(u);(l=s==null?void 0:s.groups)!=null&&l.term&&(t[s.groups.term]=i)}return{readonly:t.readonlyValue,required:t.valueRequired,name:t.valueName,min:t.minValue,max:t.maxValue,step:t.stepValue,pattern:t.valuePattern,multiple:t.multipleValues,minLength:t.valueMinLength,maxLength:t.valueMaxLength}}var Et=class extends Error{};function cn(n){for(let e=0;e<n.result.length;e++){let t=n.result[e];t.key=Symbol.for(t.keySource),delete t.keySource}return n}function Je({selector:n,value:e,fragment:t,accept:r,actionValue:o,defaultValue:l,store:a}){let i={selector:n,complete:!1,hasErrors:!1,hasMissing:!1,required:[],dependencies:[],result:[]};if(e==null){let[{subject:s,filter:c},...p]=Jt(n,a),[f,d]=s.split("#");return _e({keySource:"",pointer:"",iri:f,fragment:d!=null?d:t,accept:r,filter:c,selector:p.length>0?p:void 0,store:a,details:i}),i.complete=i.required.length===0,cn(i)}let u=Jt(n,a);Ge({keySource:"",pointer:"",value:e,actionValue:o,selector:u,store:a,details:i,defaultValue:l}),i.complete=i.required.length===0;for(let s=0;s<i.result.length;s++){let c=i.result[s];c.key=Symbol.for(c.keySource)}return cn(i)}function G(n,e){return`${n}/${on(e.toString())}`}function kt({value:n,filter:e}){return typeof e!="string"?!0:Array.isArray(n["@type"])?n["@type"].includes(e):n["@type"]===e}function Mt(n){return n!==null&&typeof n!="undefined"&&typeof n!="boolean"&&typeof n!="number"&&typeof n!="string"}function pt({keySource:n,pointer:e,value:t,propType:r,filter:o,spec:l,actionValue:a,store:i,details:u}){if(t===void 0){u.hasMissing=!0;return}else if(t===null&&v(a)){for(let s of Object.values(a))if(je(s)&&s["@type"]==="https://schema.org/PropertyValueSpecification")return}if(l!=null&&(!_(t)||!v(a))){let s=ln({spec:l,store:i});v(t)&&Ie(t)&&(t=t["@value"]),u.result.push({keySource:e,pointer:e,type:"action-value",propType:r,value:t,actionValue:a,spec:s,readonly:s.readonly});return}if(Mt(t)){if(_(t)){let s=te(t);for(let c=0;c<s.length;c++){let p=s[c];if(K(p)||(n=G(n,c)),pt({keySource:n,pointer:G(e,c),value:p,spec:l,actionValue:a,propType:r,filter:o,store:i,details:u}),u.hasErrors||u.hasMissing)return}return}}else{u.result.push({keySource:e,pointer:e,type:"value",propType:r,value:t});return}if(!(typeof o=="string"&&!kt({value:t,filter:o}))){if(Ie(t)){pt({keySource:n,pointer:e,value:t["@value"],propType:r,store:i,details:u});return}else if(fe(t)){_e({keySource:n,pointer:e,iri:t["@id"],filter:o,store:i,details:u});return}if(K(t)){let s=t["@id"];u.result.push({keySource:n,pointer:e,type:"entity",iri:s,ok:!0,value:t});return}u.result.push({keySource:n,pointer:e,type:"value",propType:r,value:t})}}function an({keySource:n,pointer:e,propType:t,value:r,actionValue:o,filter:l,store:a,details:i}){if(e=G(e,t),!Mt(r))return;if(_(r)){let s=te(r);for(let c=0;c<s.length;c++){let p=s[c];if(K(p)||(n=G(n,c)),an({keySource:n,pointer:G(e,c),propType:t,value:p,actionValue:o,filter:l,store:a,details:i}),i.hasErrors||i.hasMissing)return}return}if(fe(r)&&K(r)){_e({keySource:n,pointer:e,iri:r["@id"],selector:[{subject:t,filter:l}],store:a,details:i});return}else if(fe(r))return;let u;v(o)&&o[`${t}-input`]==null||(v(o)&&(u=o[`${t}-input`]),pt({keySource:n,pointer:e,value:r[t],spec:u,actionValue:o==null?void 0:o[t],propType:t,filter:l,store:a,details:i}))}function Ge({keySource:n,pointer:e,selector:t,value:r,actionValue:o,store:l,details:a,defaultValue:i}){if(t.length===0)return;if(!Mt(r))return;if(_(r)){let d=te(r);for(let m=0;m<d.length;m++){let y=d[m];if(K(y)||(n=G(n,m)),Ge({keySource:n,pointer:G(e,m),selector:t,value:y,actionValue:o,store:l,details:a,defaultValue:i}),a.hasErrors||a.hasMissing)return}return}else Ie(r)&&Ge({keySource:n,pointer:e,selector:t,value:r["@value"],actionValue:o,store:l,details:a,defaultValue:i});if(fe(r)&&K(r)){_e({keySource:n,pointer:e,selector:t,iri:r["@id"],store:l,details:a});return}v(r)&&o!==void 0&&r[t[0].subject]==null&&(r={[t[0].subject]:i!=null?i:null});let[u,...s]=t,{subject:c,filter:p}=u;if(r[c]===void 0){a.hasMissing=!0;return}if(s.length===0&&v(o==null?void 0:o[c])){e=G(e,c),pt({keySource:e,pointer:e,value:r[c],propType:c,details:a,store:l,actionValue:o==null?void 0:o[c],spec:o[`${c}-input`],filter:p});return}else if(s.length===0){an({keySource:n,pointer:e,propType:c,filter:p,value:r,actionValue:o,store:l,details:a});return}if(typeof p=="string"&&!kt({value:r,filter:p}))return;let f;v(o==null?void 0:o[c])&&(f=o[c]),Ge({keySource:G(n,c),pointer:G(e,c),selector:s,value:r[c],actionValue:f,store:l,details:a})}function _e({keySource:n,pointer:e,iri:t,fragment:r,accept:o,filter:l,selector:a,store:i,details:u,handledIRIs:s}){n=G(n,t),e=G(e,t);let c=i.entity(t,o);if(u.dependencies.push(t),c==null||c.loading){u.required.includes(t)||(u.required.push(t),u.accept=o,u.fragment=r);return}if(!c.ok){if(u.hasErrors=!0,a==null||a.length===0)return;u.result.push({keySource:n,pointer:e,type:"entity",iri:c.iri,ok:!1,status:c.status,value:c.value,reason:c.reason});return}if(c.type==="alternative-success"){u.result.push({keySource:n,pointer:e,type:"alternative",contentType:c.integration.contentType,integration:c.integration});return}let p=c.value;if(fe(p)){if(s==null)s=new Set([p["@id"]]);else if(!s.has(p["@id"]))s.add(p["@id"]);else throw new Et("Circular selection loop detected");return _e({keySource:n,pointer:e,iri:p["@id"],filter:l,selector:a,details:u,store:i,handledIRIs:s})}if(!(typeof l=="string"&&!kt({filter:l,value:p}))){if(typeof a=="undefined"){u.result.push({keySource:n,pointer:e,type:"entity",iri:c.iri,ok:!0,value:c.value});return}Ge({keySource:n,pointer:e,value:p,selector:a,store:i,details:u})}}var ut=n=>{let e=n.attrs,t,r={};function o(){let a=!1,{parentArgs:i,selectionArgs:u}=e,s=[];for(let p=0;p<t.result.length;p++){let f=t.result[p];if(s.push(f.pointer),r[f.pointer]!=null){let{rendererArgs:g,octiron:A}=r[f.pointer],O=P=>i.updatePointer(f.pointer,P,u);g.value=A.value=f.value,g.spec=f.spec,g.update=O;continue}a=!0;let d=g=>i.updatePointer(f.pointer,g,u),m={index:p,value:f.actionValue,propType:f.propType},y=ae(e.args,i,m),S={index:p,update:d,actionValue:y,pointer:f.pointer,propType:f.propType,value:f.value,spec:f.spec},b=rn(e.args,i,S);r[f.pointer]={rendererArgs:S,selection:y,octiron:b,selectionResult:f}}let c=Object.keys(r);for(let p of c)s.includes(p)||(a=!0,delete r[p]);a&&typeof window!="undefined"&&k()}function l(){let{selector:a,value:i,actionValue:u}=e,{store:s}=e.parentArgs;v(i)&&(t=Je({selector:a,store:s,actionValue:u,value:i,defaultValue:e.args.initialValue}),o())}return{oninit:({attrs:a})=>{e=a,l()},onbeforeupdate:({attrs:a})=>{e=a;for(let i of Object.values(r))i.octiron._updateArgs("args",a.args);l()},view:({attrs:{view:a,args:i}})=>{if(t==null)return null;let{pre:u,sep:s,post:c,fallback:p}=i;if(typeof a=="undefined")return;let f=Object.values(r),d=[u];for(let m=0;m<f.length;m++){let{octiron:y,selectionResult:S}=f[m];y.position=m+1,m!==0&&d.push(s),S.value==null&&typeof p=="function"?d.push(null):S.value==null&&p!=null?d.push(p):d.push(a(y))}return d.push(c),d}}};function un(n,e,t){let r=Object.assign(Object.create(null),n),o=Object.create(null),l;if(v(n.initialPayload))for(let[d,m]of Object.entries(n.initialPayload))o[e.store.expand(d)]=m;function a(){return E(this,null,function*(){let{url:d,method:m,body:y,contentType:S,encodingType:b}=xt({payload:o,action:t.value,store:e.store});c.submitting=!0,c.url=new URL(d,c.store.rootIRI),k();try{l=yield e.store.submit(d,{method:m,body:y,contentType:S,encodingType:b})}catch(g){console.error(g)}c.submitting=!1,k()})}function i(d){let m=o,y=U(U({},m),d);typeof n.interceptor=="function"?o=n.interceptor(y,m,e.parent.value):o=y,s.value=c.value=d,k()}let s={value:o,submitting:!1,submit:a,updatePointer:(d,m,y)=>{let S=Object.assign({},o),b=oe.create(d);m==null?b.unset(S):b.set(S,m,!0),i(S)}},c=ue("action",r,e,t,s);c.value=o,c.action=e.parent,c.actionValue=t.actionValue,s.action=c,s.submitting=c.submitting,c.select=(d,m,y)=>{let[S,b,g]=ee(d,m,y);return Dt(ut,{parentArgs:s,selector:S,value:c.value,actionValue:e.parent.value,args:b,view:g})},c.submit=function(d){return E(this,null,function*(){return typeof d=="function"?i(d(o)):d!=null&&i(d),yield a()})},c.update=function(d,m){return E(this,null,function*(){typeof d=="function"?i(d(o)):d!=null&&i(d),m!=null&&m.submit||m!=null&&m.submitOnChange?yield a():k()})},c.append=(d,m={},y={})=>{let S=e.store.expand(d);if(!v(c.value))return;let b=c.value[S],g=[];return b!=null&&!Array.isArray(b)?g.push(b):Array.isArray(b)&&(g=[...b.filter(A=>A!=null)]),g.push(m),c.update(Z(U({},c.value),{[S]:g}),y)};let p=d=>m=>Dt(Tt,{not:d,type:"initial",args:{},submitResult:l,parentArgs:s},m),f=(d,m)=>(y,S,b)=>{let[g,A,O]=ee(y,S,b);return Dt(Tt,{not:m,type:d,selector:g,args:A,view:O,submitResult:l,parentArgs:s})};c.initial=p(),c.not.initial=p(!0),c.success=f("success"),c.not.success=f("success",!0),c.failure=f("failure"),c.not.failure=f("failure",!0);try{let d=xt({payload:c.value,action:t.value,store:e.store});c.url=new URL(d.url),c.method=d.method}catch(d){console.error(d)}return c.url!=null&&(l=e.store.entity(c.url.toString())),(typeof window=="undefined"&&n.submitOnInit&&l==null||typeof window!="undefined"&&n.submitOnInit)&&c.submit(),c}var pn=({attrs:n})=>{let e=Symbol("PerformRenderer"),t=n,r,o={};function l(){let s=!1,{args:c,parentArgs:p}=t,f=[];for(let m=0;m<r.result.length;m++){let y=r.result[m];if(f.push(y.pointer),Object.hasOwn(o,y.pointer)){let O=y,P=o[y.pointer].selectionResult;if(P.type==="value"&&O.type==="value"&&O.value===P.value)continue;if(P.type==="entity"&&O.type==="entity"&&(O.ok!==P.ok||O.status!==P.status||O.value!==P.value))continue;continue}s=!0;let S={index:m,value:y.value},b=ae(c,p,S),g={index:m,value:y.value,actionValue:b},A=un(c,p,g);o[y.pointer]={action:A,octiron:b,selectionResult:y}}let d=Object.keys(o);for(let m of d)f.includes(m)||(s=!0,delete o[m]);s&&k()}function a(s){return E(this,null,function*(){if(s.length===0)return;let c=[];for(let p of s)c.push(t.parentArgs.store.fetch(p));yield Promise.allSettled(c)})}function i(s){let c=[];if(typeof r=="undefined")c=s.required;else for(let p of s.required)r.required.includes(p)||c.push(p);r=s,c.length>0&&a(c),l()}function u(){let{selector:s,parentArgs:c}=t;if(s==null){let p;K(c.parent.value)?p={pointer:"/local",key:Symbol.for("/local"),type:"entity",iri:c.parent.value["@id"],ok:!0,value:c.parent.value}:p={pointer:"/local",key:Symbol.for("/local"),type:"value",value:c.parent.value},r={selector:"",complete:!0,hasErrors:!1,hasMissing:!1,dependencies:[],required:[],result:[p]}}else r=c.store.subscribe({key:e,selector:s,value:c.parent.value,listener:i}),a(r.required);l()}return{oninit:({attrs:s})=>{t=s,u()},onbeforeupdate:({attrs:s})=>{s.selector!==t.selector&&(s.parentArgs.store.unsubscribe(e),u()),t=s;for(let c of Object.values(o))c.action._updateArgs("args",s.args)},onbeforeremove:({attrs:s})=>{t=s,s.parentArgs.store.unsubscribe(e)},view:({attrs:{view:s,args:c}})=>{if(r==null||!r.complete)return c.loading;let{pre:p,sep:f,post:d,fallback:m}=c;if(typeof s=="undefined")return;let y=Object.values(o),S=[p];for(let b=0;b<y.length;b++){let{selectionResult:g,action:A,octiron:O}=y[b];A.position=b+1,b!==0&&S.push(f),g.type==="value"?S.push(s(A)):!g.ok&&typeof m=="function"?S.push(m(O,g.reason)):g.ok?S.push(s(A)):S.push(m)}return S.push(d),S}}};var ye={root:0,selection:1,action:2,"action-selection":3};function ue(n,e,t,r={},o={}){var s,c,p,f,d,m;let l=ye[n],a=K(r.value)?r.value["@id"]:(s=r.propType)!=null?s:"octiron",i={[a]:(y,S)=>y(i)?S:null}[a];i.id=t.store.key(),i.isOctiron=!0,i.octironType=n,i.readonly=!0,i.value=(c=r.value)!=null?c:null,i.store=t.store,i.index=(p=r.index)!=null?p:0,i.position=-1,o.parent=i,o.store=(f=e.store)!=null?f:t.store,o.typeDefs=(d=e.typeDefs)!=null?d:t.typeDefs,l!==ye.root&&(i.propType=r.propType,i.dataType=lt(r.value)),i.not=(y,S)=>i==null||y(i)?null:S,i.get=y=>{var g,A;if(!v(i.value))return null;if(y.startsWith("@"))return i.value[y];let S=i.store.expand(y),b=(g=i.value[S])!=null?g:null;return _(b)?te(b):(A=i.value[S])!=null?A:null},i.enter=(y,S,b)=>{let[g,A,O]=ee(y,S,b);return ze(st,{entity:!0,selector:g,args:A,view:O,parentArgs:o})};let u=Z(U({},o),{value:(m=t.store.entity(t.store.rootIRI))==null?void 0:m.value});switch(i.root=(y,S,b)=>{let g,[A,O,P]=ee(y,S,b);return A==null?g=t.store.rootIRI:g=`${t.store.rootIRI} ${A}`,ze(st,{entity:!0,selector:g,args:O,view:P,parentArgs:u})},l){case ye.root:i.select=i.root;break;case ye.selection:i.select=(y,S,b)=>{let[g,A,O]=ee(y,S,b);return v(r.value)?ze(st,{selector:g,args:A,view:O,parentArgs:o}):null}}switch(l){case ye.root:i.present=i.root;break;default:i.present=y=>ze(_t,{o:i,args:y,factoryArgs:e,parentArgs:t,rendererArgs:r})}switch(i.default=y=>i.present(Object.assign({component:null},y)),l){case ye.root:i.perform=(y,S,b)=>typeof y=="string"?i.root(y,g=>g.perform(S,b)):i.root(g=>g.perform(S,b));break;default:{i.perform=(y,S,b)=>{let[g,A,O]=ee(y,S,b);return typeof g=="string"?i.select(g,P=>P.perform(A,O)):ze(pn,{selector:g,args:A,view:O,parentArgs:o})};break}}if(l!==ye.root){let y=(S,b)=>{let g=S==="args"?e:S==="parent"?t:r;for(let A of Object.keys(g))delete g[A];for(let[A,O]of Object.entries(b))g[A]=O};i._updateArgs=y}return i}function Nt(n){return ue("root",{},n)}import Vt from"mithril";import{processTemplate as Lt}from"@longform/longform";function Bn(n){let e="";for(let t=0;t<n.length;t++)e+=n[t].outerHTML;return e}var Kn=()=>{let n,e;function t(o){var u;if(n===o.fragment)return;if(n=o.fragment,o.fragment==null){e=o.output.root;return}let[l,a]=o.fragment.split("?");if(a==null){e=(u=o.output.fragments[l])==null?void 0:u.html;return}let i=o.output.templates[l];if(i!=null)try{let s=Object.fromEntries(new URLSearchParams(a));e=Lt(i,s,c=>{var p;return(p=o.output.fragments[c])==null?void 0:p.html})}catch(s){console.error(s)}}function r(o){if(o.fragment==null){if(o.output.root!=null&&o.output.dom==null){let s=document.createElement("template");s.innerHTML=o.output.root,o.output.dom=Array.from(s.content.children)}e=o.output.dom;return}let[l,a]=o.fragment.split("?");if(!(a!=null||o.output.templates[l]!=null)){let s=o.output.fragments[l];if(s==null)return;if(s.type==="text"){e=s.html;return}else if(s.dom==null&&s.html!=null){let c=document.createElement("template");c.innerHTML=s.html,s.dom=Array.from(c.content.children)}else if(s.dom==null)return;e=s.dom;return}let u=o.output.templates[l];if(u!=null)try{let s=Object.fromEntries(new URLSearchParams(a));e=Lt(u,s,c=>{var p;return o.output.fragments[c]!=null&&o.output.fragments[c].html==null&&o.output.fragments[c].dom!=null&&(o.output.fragments[c].html=Bn(o.output.fragments[c].dom)),(p=o.output.fragments[c])==null?void 0:p.html})}catch(s){console.error(s)}}return{oninit({attrs:o}){pe?r(o):t(o)},view(){return pe&&Array.isArray(e)?Vt.dom(e):typeof e=="string"?Vt.trust(e):null}}},Ee,ke,he,Se,mt,D,Me,ft,dt=class dt{constructor(e,{iri:t,contentType:r,output:o}){I(this,Me);bt(this,"integrationType","html-fragments");I(this,Ee,!1);I(this,ke,new Set);I(this,he);I(this,Se);I(this,mt);I(this,D);M(this,mt,e),M(this,he,t),M(this,Se,r),M(this,D,o)}get iri(){return h(this,he)}get contentType(){return h(this,Se)}get output(){return h(this,D)}getFragment(e){var t,r,o;return e!=null?(r=(t=h(this,D).fragments[e])==null?void 0:t.html)!=null?r:null:(o=h(this,D).root)!=null?o:null}text(e){if(e==null)return this.output.root==null&&h(this,D).dom&&(this.output.root=$(this,Me,ft).call(this,h(this,D).dom)),this.output.root;let[t,r]=e.split("?");if(r==null){let l=h(this,D).fragments[t];return l==null?void 0:(l.html==null&&l.dom&&(l.html=$(this,Me,ft).call(this,l.dom)),l.html)}let o=h(this,D).templates[t];if(o!=null)try{let l=Object.fromEntries(new URLSearchParams(r));return Lt(o,l,a=>{let i=h(this,D).fragments[a];if(i!=null)return i.html==null&&i.dom!=null&&(i.html=$(this,Me,ft).call(this,i.dom)),i.html})}catch(l){console.error(l)}}render(e,t){return pe||(t==null?M(this,Ee,!0):h(this,ke).add(t)),Vt(Kn,{o:e,integration:this,fragment:t,output:h(this,D)})}getStateInfo(){let e={},t=[],r=Object.values(h(this,D).fragments);for(let o=0;o<r.length;o++)r[o].type==="text"?e[r[o].id]=r[o].html:t.push({id:r[o].id,type:r[o].type,selector:r[o].selector,rendered:h(this,ke).has(r[o].id)});return{iri:h(this,he),contentType:h(this,Se),rendered:h(this,Ee),selector:h(this,D).selector,templates:h(this,D).templates,texts:e,fragments:t}}toInitialState(){let e="",t=Object.values(h(this,D).fragments);h(this,D).root!=null&&!h(this,Ee)&&(e+=`<template id="htmlfrag:${h(this,he)}|${h(this,Se)}">${h(this,D).root}</template>
`);for(let r=0;r<t.length;r++)t[r].type!=="text"&&(h(this,ke).has(t[r].id)||(e+=`<template data-htmlfrag="${t[r].id}">${t[r].html}</template>
`));return e}static fromInitialState(e,{iri:t,contentType:r,rendered:o,selector:l,texts:a,fragments:i,templates:u}){let s=Object.create(null);if(s.fragments=Object.create(null),s.templates=u,l!=null&&o){let p=document.querySelector(l);p!=null&&(s.root=p.outerHTML)}else if(l!=null){let p=document.getElementById(`htmlfrag:${t}|${r}`);s.root=p==null?void 0:p.textContent}let c=Object.entries(a);for(let p=0;p<c.length;p++)s.fragments[c[p][0]]={id:c[p][0],type:"text",html:c[p][1],selector:""};for(let p=0;p<i.length;p++){let f=i[p],d=document.createDocumentFragment();if(f.rendered){let m;switch(f.type){case"embed":{if(m=document.getElementById(f.id),m==null)break;s.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"bare":{if(m=document.querySelector(f.selector),m==null)break;s.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"range":{let y=document.querySelectorAll(f.selector);s.fragments[f.id]={id:f.id,type:f.type,selector:f.selector,dom:Array.from(y)}}}}else{let m=document.querySelector(`[data-htmlfrag="${f.id}"]`);if(m==null)continue;s.fragments[f.id]={id:f.id,type:f.type,dom:Array.from(m.content.children),selector:f.selector}}}return new dt(e,{contentType:r,iri:t,output:s})}};Ee=new WeakMap,ke=new WeakMap,he=new WeakMap,Se=new WeakMap,mt=new WeakMap,D=new WeakMap,Me=new WeakSet,ft=function(e){let t="";for(let r=0;r<e.children.length;r++)t+=e.children[r].outerHTML;return t},bt(dt,"type","html-fragments");var De=dt;var Ne,Qe,gt=class{constructor(e,t){I(this,Ne);I(this,Qe);M(this,Ne,e),M(this,Qe,t)}get status(){return h(this,Ne)}get res(){return h(this,Qe)}undefined(){return null}http(e){return typeof e=="function"?e(h(this,Ne)):e}unparserable(){return null}};Ne=new WeakMap,Qe=new WeakMap;function Ve(n,e=[]){if(Array.isArray(n))for(let t of n)Ve(t,e);else if(v(n)){if(fe(n))return e;if(K(n)&&e.push(n),Ie(n))Ve(n["@value"],e);else if(_(n))Ve(te(n),e);else for(let[t,r]of Object.entries(n))t.startsWith("@")||Ve(r,e)}return e}var Ae="application/problem+json, application/ld+json",Wn={[De.type]:De};function Gn(n,e){let t=new Map,r={};if(n!=null&&(r["@vocab"]=n),e==null)return[t,r];for(let[o,l]of Object.entries(e))r[o]=l,t.set(o,l);return[t,r]}function _n(n,e){let t=new Headers([["accept",Ae]]),r=new Map;if(n!=null)for(let[o,l]of Object.entries(n))t.set(o,l);if(e!=null)for(let[o,l]of Object.entries(e)){let a=new Headers([["accept",Ae]]);for(let[i,u]of Object.entries(l))a.set(i,u);r.set(o,a)}return[t,r]}var Ye,Ze,ie,be,Oe,Le,z,He,me,et,tt,nt,rt,Fe,Ue,re,we,se,H,Ht,Ft,Ut,fn,$t,Xe=class Xe{constructor(e){I(this,H);I(this,Ye);I(this,Ze);I(this,ie);I(this,be);I(this,Oe);I(this,Le);I(this,z,new Map);I(this,He,new Set);I(this,me,new Map);I(this,et);I(this,tt,new Set);I(this,nt);I(this,rt,new Map);I(this,Fe);I(this,Ue);I(this,re,new Map);I(this,we,new Map);I(this,se,new Map);var t,r;M(this,Ye,e.rootIRI),M(this,Ze,new URL(e.rootIRI).origin),M(this,Oe,e.vocab),M(this,Fe,e.fetcher),M(this,Ue,e.responseHook),[qe(this,ie)._,qe(this,be)._]=_n(e.headers,e.origins),[qe(this,Le)._,qe(this,nt)._]=Gn(e.vocab,e.aliases),M(this,et,new Map((r=(t=e.handlers)==null?void 0:t.map)==null?void 0:r.call(t,o=>[o.contentType,o]))),e.primary!=null&&M(this,z,new Map(Object.entries(e.primary))),h(this,ie).has("accept")||h(this,ie).set("accept",Ae);for(let o of Object.values(h(this,be)))o.has("accept")||o.set("accept",Ae);if(e.acceptMap!=null)for(let[o,l]of Object.entries(e.acceptMap))h(this,se).set(o,new Map(l));e.alternatives!=null&&M(this,me,e.alternatives)}get rootIRI(){return h(this,Ye)}entity(e,t){var l,a,i,u;if(t==null)return(l=h(this,z).get(e))!=null?l:null;let r=(i=(a=h(this,se).get(e))==null?void 0:a.get)==null?void 0:i.call(a,t);if(r==null)return null;let o=(u=h(this,me).get(r))==null?void 0:u.get(e);return o==null?null:{type:"alternative-success",iri:e,loading:!1,ok:!0,integration:o}}text(e,t){let[r,o]=e.split("#"),l=this.entity(r,t);if(l!=null&&(l==null?void 0:l.type)==="alternative-success")return l.integration.text(o)}get vocab(){return h(this,Oe)}get aliases(){return Object.fromEntries(h(this,Le).entries().map(([e,t])=>[e.replace(/^/,""),t]))}get context(){return h(this,nt)}expand(e){let t=Symbol.for(e),r=h(this,rt).get(t);if(r!=null)return r;let o;if(h(this,Oe)!=null&&!/^[\w\d]+\:/.test(e))o=h(this,Oe)+e;else if(/https?:\/\//.test(e))o=e;else for(let[l,a]of h(this,Le)){let i=new RegExp(`^${l}:`);if(i.test(e)){o=e.replace(i,a);break}}return h(this,rt).set(t,o!=null?o:e),o!=null?o:e}select(e,t,{accept:r}={}){return Je({selector:e,value:t,accept:r,store:this})}key(){for(;;){let e=`oct-${Math.random().toString(36).slice(2,7)}`;if(!h(this,tt).has(e))return h(this,tt).add(e),e}}isLoading(e){let t=$(this,H,Ft).call(this,e,"get");return h(this,He).has(t)}handleResponse(r){return E(this,arguments,function*(e,t=e.url.toString()){var a,i,u;let o=(u=(i=(a=e.headers.get("content-type"))==null?void 0:a.split)==null?void 0:i.call(a,";"))==null?void 0:u[0];if(o==null)throw new Error("Content type not specified in response");let l=h(this,et).get(o);if(l==null)throw new Error(`No handler configured for content type "${o}"`);if(l.integrationType==="jsonld"){let s=yield l.handler({res:e,store:this});$(this,H,fn).call(this,{iri:t,res:e,output:s})}else{if(l.integrationType==="problem-details")throw new Error("Problem details response types not supported yet");if(l.integrationType==="html-fragments"){let s=yield l.handler({res:e,store:this}),c=h(this,me).get(o);c==null&&(c=new Map,h(this,me).set(o,c)),c.set(t,new De(l,{iri:t,contentType:o,output:s}))}}l.integrationType!=="jsonld"&&$(this,H,Ut).call(this,t,o)})}subscribe({key:e,selector:t,fragment:r,accept:o,value:l,listener:a}){let i=Je({selector:t,fragment:r,accept:o,value:l,store:this}),u=$(this,H,Ht).call(this,e,i);for(let s of i.dependencies){let c=h(this,re).get(s);c==null?h(this,re).set(s,new Set([e])):c.add(e)}return h(this,we).set(e,{key:e,selector:t,value:l,fragment:r,accept:o,required:i.required,dependencies:i.dependencies,listener:a,cleanup:u}),i}unsubscribe(e){var t;(t=h(this,we).get(e))==null||t.cleanup()}fetch(e,t){return E(this,null,function*(){return yield $(this,H,$t).call(this,e,{accept:t}),h(this,z).get(e)})}submit(e,t){return E(this,null,function*(){return yield $(this,H,$t).call(this,e,Z(U({},t),{contentType:"application/ld+json"})),this.entity(e)})}static fromInitialState({disableLogs:e,rootIRI:t,vocab:r,aliases:o,headers:l,origins:a,handlers:i=[]}){performance.mark("octiron:from-initial-state:start");let u={rootIRI:t,vocab:r,aliases:o,handlers:i,headers:l,origins:a};try{let s=document.getElementById("oct-state");if(s==null)return e||console.warn("Failed to construct Octiron state from initial state"),new Xe(u);let c=JSON.parse(s.innerText),p=new Map,f=i.reduce((m,y)=>Z(U({},m),{[y.contentType]:y}),{});for(let[m,y]of Object.entries(c.alternatives))for(let S of y){let b=f[S.contentType],g=Wn[m];if(g.type!==b.integrationType)continue;let A=g.fromInitialState(b,S);if(A==null)continue;let O=p.get(A.contentType);O==null&&(O=new Map,p.set(A.contentType,O)),O.set(A.iri,A)}let d=new Xe(Z(U({},u),{alternatives:p,primary:c.primary,acceptMap:c.acceptMap}));return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),d}catch(s){e||(console.warn("Failed to construct Octiron state from initial state"),console.error(s));let c=new Xe(u);return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),c}}toInitialState(){let e="",t={primary:Object.fromEntries(h(this,z)),alternatives:{},acceptMap:{}};for(let[r,o]of h(this,se).entries())t.acceptMap[r]=Array.from(o.entries());for(let r of h(this,me).values())for(let o of r.values())t.alternatives[o.integrationType]==null?t.alternatives[o.integrationType]=[o.getStateInfo()]:t.alternatives[o.integrationType].push(o.getStateInfo()),e+=o.toInitialState();return e+=`<script id="oct-state" type="application/json">${JSON.stringify(t)}<\/script>`,e}};Ye=new WeakMap,Ze=new WeakMap,ie=new WeakMap,be=new WeakMap,Oe=new WeakMap,Le=new WeakMap,z=new WeakMap,He=new WeakMap,me=new WeakMap,et=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,re=new WeakMap,we=new WeakMap,se=new WeakMap,H=new WeakSet,Ht=function(e,t){return()=>{h(this,we).delete(e);for(let r of t.dependencies)h(this,re).delete(r),pe&&setTimeout(()=>{var o;((o=h(this,re).get(r))==null?void 0:o.size)===0&&h(this,z).delete(r)},5e3)}},Ft=function(e,t,r){var o;return r=(o=r!=null?r:h(this,ie).get("accept"))!=null?o:Ae,`${t==null?void 0:t.toLowerCase()}|${e}|${r.toLowerCase()}`},Ut=function(e,t){let r=h(this,re).get(e);if(r!=null)for(let o of r){let l=h(this,we).get(o);if(l==null)continue;let a=Je({selector:l.selector,value:l.value,fragment:l.fragment,accept:l.accept,store:this}),i=$(this,H,Ht).call(this,o,a);for(let u of a.dependencies){let s=h(this,re).get(u);s==null?(s=new Set([o]),h(this,re).set(u,s)):s.add(o)}l.cleanup=i,l.listener(a)}},fn=function({iri:e,res:t,output:r}){let o=[e];if(t.ok)h(this,z).set(e,{type:"entity-success",iri:e,loading:!1,ok:!0,value:r.jsonld});else{let l=new gt(t.status,t);h(this,z).set(e,{type:"entity-failure",iri:e,loading:!1,ok:!1,value:r.jsonld,status:t.status,reason:l})}for(let l of Ve(r.jsonld))o.includes(l["@id"])||h(this,z).set(l["@id"],{type:"entity-success",iri:l["@id"],loading:!1,ok:!0,value:l});for(let l of o)$(this,H,Ut).call(this,l)},$t=function(r){return E(this,arguments,function*(e,t={}){var p,f;let o,l=new URL(e),a=t.method||"get",i=(f=(p=t.accept)!=null?p:h(this,ie).get("accept"))!=null?f:Ae;l.hash="";let u=l.toString(),s=$(this,H,Ft).call(this,u,a,t.accept);if(l.origin===h(this,Ze))o=new Headers(h(this,ie));else if(h(this,be).has(l.origin))o=new Headers(h(this,be).get(l.origin));else throw new Error("Unconfigured origin");t.body!=null&&t.contentType!=null&&o.set("content-type",t.contentType),i!=null?o.set("accept",i):o.get("accept")==null&&o.set("accept",Ae),h(this,He).add(s),k();let c=new Promise(d=>{E(this,null,function*(){var y;let m=null;h(this,Fe)!=null?m=yield h(this,Fe).call(this,u,{method:a,headers:o,body:t.body}):m=yield fetch(u,{method:a,headers:o,body:t.body}),t.accept!=null&&h(this,se).has(u)?(y=h(this,se).get(u))==null||y.set(t.accept,m.headers.get("content-type")):t.accept!=null&&h(this,se).set(u,new Map([[t.accept,m.headers.get("content-type")]])),yield this.handleResponse(m,e),h(this,He).delete(s),k(),d(m)})});h(this,Ue)!=null&&h(this,Ue).call(this,c),yield c})};var Re=Xe;function qt(n,...e){let t={};if(n instanceof Re)for(let r of e)t[n.expand(r.type)]=r;else{t[n.type]=n;for(let r of e)t[r.type]=r}return t}function mn(...n){let e=[];for(let t of n)if(!(typeof t=="undefined"||t===null))if(typeof t=="string")e.push(t);else if(Array.isArray(t))for(let r of t)e.push(r);else for(let[r,o]of Object.entries(t))o&&e.push(r);return e.join(" ")}function Ri(n){return n}import dn from"jsonld";var ji={integrationType:"jsonld",contentType:"application/ld+json",handler:e=>E(null,[e],function*({res:n}){let t=yield n.json();if(!v(t)&&!Array.isArray(t))throw new Error("JSON-LD Document should be an object");let r=yield dn.expand(t,{documentLoader:l=>E(null,null,function*(){let i=yield(yield fetch(l,{headers:{accept:"application/ld+json"}})).json();return{documentUrl:l,document:i}})});return{jsonld:yield dn.compact(r,{})}})};import{longform as zn}from"@longform/longform";var Ji={integrationType:"html-fragments",contentType:"text/longform",handler:e=>E(null,[e],function*({res:n}){return zn(yield n.text())})};import T from"mithril";var Bt=()=>{function n(i){return T("code",[T("span.oct-json-quote",'"'),T("a.oct-json-iri",{href:i},i),T("span.oct-json-quote",'"')])}function e(i){let u=typeof i=="boolean"?"oct-json-boolean":typeof i=="number"?"oct-json-number":"oct-json-string",s;return typeof i=="boolean"&&i?s="true":typeof i=="boolean"||(typeof i=="string"?s=[T("span.oct-json-quote",'"'),i,T("span.oct-json-quote",'"')]:s=i),T("code",{className:u},s)}function t(i,u,s=""){let c=[];for(let p=0;p<i.length;p++){let f=i[p];c.push(T("li.oct-json-arr-item",l(null,f,u,s)))}return T("ul.oct-json-arr",c)}let r=["@id","@type","@context"];function o(i,u,s=""){let c=[],p=Object.entries(i).toSorted();for(let f=0;f<p.length;f++){let[d,m]=p[f],y,S=[T("span.oct-json-quote",'"'),T("span.oct-json-obj-key",d),T("span.oct-json-quote",'"'),T("span.oct-json-obj-colon",": ")];if(d==="@id")y=[T("code",S),n(m)];else if(u==null||r.includes(d))y=l(S,m);else if(d.startsWith("@"))y=l(S,m,u,s);else{let b=`${s} ${d}`,g=new URL(u);g.searchParams.set("selector",b);let A=[T("span.oct-json-quote",'"'),T("span.oct-json-obj-key",T("a",{href:g},d)),T("span.oct-json-quote",'"'),T("span.oct-json-obj-colon",": ")];y=l(A,m,u,b)}c.push(T("li.oct-json-obj-item",y))}return T("ul.oct-json-obj",c)}function l(i,u,s,c=""){return v(u)?[T("details.oct-json-details",{open:!0},T("summary.oct-json-details-sum",T("code",i,T("span.oct-json-obj-open","{"))),a(u,s,c)),T("code.oct-json-obj-close","}")]:Array.isArray(u)?[T("details.oct-json-details",{open:!0},T("summary.oct-json-details-sum",T("code",i,T("span.oct-json-obj-open","["))),a(u,s,c)),T("code.oct-json-obj-close","]")]:[T("code",i),a(u,s,c)]}function a(i,u,s=""){return v(i)?o(i,u,s):Array.isArray(i)?t(i,u,s):e(i)}return{view:({attrs:{value:i,selector:u,location:s}})=>{let c=s!=null?new URL(s):void 0;return T(".oct-json",[l(null,i,c,typeof u=="string"?u.trim():void 0)])}}};import Q from"mithril";var yt=({attrs:n})=>{var s;let e=n,t=n.o.value,r,o=(s=n.initialPresentationStyle)!=null?s:"value";function l(c=!0){let{o:p}=e;o==="value"?r=Q(Bt,{value:t,selector:e.selector,location:e.location}):o==="action-value"&&(p.octironType==="action"||p.octironType==="action-selection")&&(r=Q(Bt,{value:p.actionValue.value,selector:e.selector,location:e.location})),c&&k()}function a(c){c.redraw=!1,o="value",l()}function i(c){c.redraw=!1,o="action-value",l()}function u(c){c.redraw=!1,o="component",l()}return{oninit:({attrs:c})=>{e=c,l(!1)},onbeforeupdate:({attrs:c})=>{c.o.value!==t&&(t=c.o.value,l(!0))},view:({attrs:{o:c,availableControls:p}})=>{let f,d,m=[];return o==="component"?f=Q(".oct-debug-body",c.default()):f=Q(".oct-debug-body",r),(c.octironType==="action"||c.octironType==="action-selection")&&(d=Q("button.oct-button",{type:"button",onclick:i},"Action value")),p==null||p.includes("value")?m.push(Q("button.oct-button",{type:"button",onclick:a},"Value")):d!=null&&(p==null||p.includes("action-value"))?m.push(d):p==null||p.includes("component")?m.push(Q("button.oct-button",{type:"button",onclick:u},"Component")):(p==null||p.includes("log"))&&m.push(Q("button.oct-button",{type:"button",onclick:()=>console.debug(c)},"Log")),Q("aside.oct-debug",Q(".oct-debug-controls",Q(".oct-button-group",...m)),f)}}};import V from"mithril";var qi=({attrs:n})=>{let e=n.selector||"",t=e,r=e,o=n.presentationStyle||"debug",l=n.onChange,a={view:({attrs:{o:f}})=>V(yt,{o:f,location:n.location})};function i(f){e=f.target.value}function u(f){f.key==="Enter"&&s()}function s(){r=e,typeof l=="function"&&l(r,o)}function c(f){f.preventDefault(),o="debug",typeof l=="function"&&l(r,o)}function p(f){f.preventDefault(),o="components",typeof l=="function"&&l(r,o)}return{oninit:({attrs:f})=>{l=f.onChange},onbeforeupdate:({attrs:f})=>{var d;r=(d=f.selector)!=null?d:"",r!==t&&(e=t=r),l=f.onChange},view:({attrs:{autofocus:f,o:d}})=>{var g,A;let m,y,S,b;if(r.length!==0&&o==="debug"?m=d.root(r,O=>V(yt,{o:O,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?[]:void 0})):r.length!==0?m=d.root(r,O=>V("div",O.default({fallbackComponent:a,attrs:{selector:r}}))):o==="debug"?m=d.root(O=>V(yt,{o:O,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?void 0:[]})):m=d.root(O=>V("div",O.default({fallbackComponent:a,attrs:{selector:r}}))),n.location!=null&&r.length!==0){let O=n.selector.trim().includes(" ")?n.selector.replace(/\s+([^\s]+)$/,""):"";y=new URL(n.location),O!=null?y.searchParams.set("selector",O):y.searchParams.delete("selector")}return n.location!=null&&(S=new URL(n.location),b=new URL(n.location),S.searchParams.set("presentationStyle","debug"),b.searchParams.set("presentationStyle","components")),V(".oct-explorer",V(".oct-explorer-controls",V("form.oct-form-group",{action:(A=(g=n.location)==null?void 0:g.toString)==null?void 0:A.call(g),onsubmit:O=>{O.preventDefault(),s()}},[y!=null?V("a.oct-button",{href:y.toString()},"Up"):V("button.oct-button",{type:"button",disabled:!0},"Up"),V("input",{name:"selector",value:e,autofocus:f,oninput:i,onkeypress:u}),V("button.oct-button",{type:"submit",disabled:r===e&&typeof window!="undefined"},"Apply")]),V(".oct-button-group",o==="debug"||S==null?V("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:c},"Debug"):V("a.oct-button",{href:S.toString(),onclick:c},"Debug"),o==="components"||b==null?V("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:p},"Components"):V("a.oct-button",{href:b.toString(),onclick:p},"Components"))),V("pre.oct-explorer-body",m))}}};import Qn from"mithril";var Wi=n=>{var o;let t=((o=n.attrs.o.method)==null?void 0:o.toUpperCase())||"POST",r={GET:"application/x-www-form-urlencoded",POST:"multipart/form-data"};return{view:u=>{var s=u,{attrs:c}=s,p=c,{o:l}=p,a=de(p,["o"]),{children:i}=s;return Qn("form.oct-form",Z(U({},a),{method:t,enctype:r[t||"GET"],action:l.url,onsubmit:f=>{f.preventDefault(),l.submit()}}),i)}}};import Xn from"mithril";var Xi=()=>({view:({attrs:n,children:e})=>Xn("button.oct-button.oct-submit-button",{id:n.id,type:"submit",class:mn(n.class)},e)});function gn(t){var r=t,{typeDefs:n}=r,e=de(r,["typeDefs"]);let o=new Re(e),l=n!=null?qt(o,...n):{};return Nt({store:o,typeDefs:l})}gn.fromInitialState=t=>{var r=t,{typeDefs:n}=r,e=de(r,["typeDefs"]);let o=Re.fromInitialState(U({},e)),l=n!=null?qt(o,...n):{};return Nt({store:o,typeDefs:l})};export{yt as OctironDebug,qi as OctironExplorer,Wi as OctironForm,Bt as OctironJSON,Xi as OctironSubmitButton,Re as Store,mn as classes,gn as default,ji as jsonLDHandler,Ji as longformHandler,Ri as makeTypeDef,qt as makeTypeDefs};
//# sourceMappingURL=octiron.min.js.map
