var hn=Object.create;var At=Object.defineProperty,Sn=Object.defineProperties,An=Object.getOwnPropertyDescriptor,bn=Object.getOwnPropertyDescriptors,On=Object.getOwnPropertyNames,it=Object.getOwnPropertySymbols,wn=Object.getPrototypeOf,bt=Object.prototype.hasOwnProperty,Wt=Object.prototype.propertyIsEnumerable;var Gt=n=>{throw TypeError(n)};var St=(n,e,t)=>e in n?At(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$=(n,e)=>{for(var t in e||(e={}))bt.call(e,t)&&St(n,t,e[t]);if(it)for(var t of it(e))Wt.call(e,t)&&St(n,t,e[t]);return n},te=(n,e)=>Sn(n,bn(e));var de=(n,e)=>{var t={};for(var r in n)bt.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&it)for(var r of it(n))e.indexOf(r)<0&&Wt.call(n,r)&&(t[r]=n[r]);return t};var Rn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var vn=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of On(e))!bt.call(n,o)&&o!==t&&At(n,o,{get:()=>e[o],enumerable:!(r=An(e,o))||r.enumerable});return n};var Cn=(n,e,t)=>(t=n!=null?hn(wn(n)):{},vn(e||!n||!n.__esModule?At(t,"default",{value:n,enumerable:!0}):t,n));var Ot=(n,e,t)=>St(n,typeof e!="symbol"?e+"":e,t),wt=(n,e,t)=>e.has(n)||Gt("Cannot "+t);var S=(n,e,t)=>(wt(n,e,"read from private field"),t?t.call(n):e.get(n)),I=(n,e,t)=>e.has(n)?Gt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),N=(n,e,t,r)=>(wt(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),q=(n,e,t)=>(wt(n,e,"access private method"),t);var qe=(n,e,t,r)=>({set _(o){N(n,e,o,t)},get _(){return S(n,e,r)}});var E=(n,e,t)=>new Promise((r,o)=>{var l=u=>{try{i(t.next(u))}catch(c){o(c)}},a=u=>{try{i(t.throw(u))}catch(c){o(c)}},i=u=>u.done?r(u.value):Promise.resolve(u.value).then(l,a);i((t=t.apply(n,e)).next())});var tn=Rn((en,at)=>{(function(n,e){typeof define=="function"&&define.amd?define("uri-templates",[],e):typeof at!="undefined"&&at.exports?at.exports=e():n.UriTemplate=e()})(en,function(){var n={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},e={"*":!0},t=/[:/&?#]/;function r(i){return encodeURI(i).replace(/%25[0-9][0-9]/g,function(u){return"%"+u.substring(3)})}function o(i){return i=i.replace(/%../g,""),encodeURIComponent(i)===i}function l(i){var u="";n[i.charAt(0)]&&(u=i.charAt(0),i=i.substring(1));var c="",s="",p=!0,f=!1,d=!1;u=="+"?p=!1:u=="."?(s=".",c="."):u=="/"?(s="/",c="/"):u=="#"?(s="#",p=!1):u==";"?(s=";",c=";",f=!0,d=!0):u=="?"?(s="?",c="&",f=!0):u=="&"&&(s="&",c="&",f=!0);for(var m=[],g=i.split(","),h=[],O={},y=0;y<g.length;y++){var A=g[y],b=null;if(A.indexOf(":")!=-1){var P=A.split(":");A=P[0],b=parseInt(P[1])}for(var M={};e[A.charAt(A.length-1)];)M[A.charAt(A.length-1)]=!0,A=A.substring(0,A.length-1);var F={truncate:b,name:A,suffices:M};h.push(F),O[A]=F,m.push(A)}var B=function(R){for(var C="",H=0,K=0;K<h.length;K++){var j=h[K],w=R(j.name);if(w==null||Array.isArray(w)&&w.length==0||typeof w=="object"&&Object.keys(w).length==0){H++;continue}if(K==H?C+=s:C+=c||",",Array.isArray(w)){f&&(C+=j.name+"=");for(var Z=0;Z<w.length;Z++)Z>0&&(C+=j.suffices["*"]&&c||",",j.suffices["*"]&&f&&(C+=j.name+"=")),C+=p?encodeURIComponent(w[Z]).replace(/!/g,"%21"):r(w[Z])}else if(typeof w=="object"){f&&!j.suffices["*"]&&(C+=j.name+"=");var x=!0;for(var J in w)x||(C+=j.suffices["*"]&&c||","),x=!1,C+=p?encodeURIComponent(J).replace(/!/g,"%21"):r(J),C+=j.suffices["*"]?"=":",",C+=p?encodeURIComponent(w[J]).replace(/!/g,"%21"):r(w[J])}else f&&(C+=j.name,(!d||w!="")&&(C+="=")),j.truncate!=null&&(w=w.substring(0,j.truncate)),C+=p?encodeURIComponent(w).replace(/!/g,"%21"):r(w)}return C},ae=function(R,C,H){if(s&&(R=R.substring(s.length)),h.length==1&&h[0].suffices["*"]){for(var K=h[0],j=K.name,w=K.suffices["*"]?R.split(c||","):[R],Z=p&&R.indexOf("=")!=-1,x=1;x<w.length;x++){var R=w[x];Z&&R.indexOf("=")==-1&&(w[x-1]+=(c||",")+R,w.splice(x,1),x--)}for(var x=0;x<w.length;x++){var R=w[x];p&&R.indexOf("=")!=-1&&(Z=!0);var J=R.split(",");J.length==1?w[x]=J[0]:w[x]=J}if(f||Z){for(var ee=C[j]||{},V=0;V<w.length;V++){var ve=R;if(!(f&&!ve)){if(typeof w[V]=="string"){var R=w[V],G=R.split("=",1)[0],R=R.substring(G.length+1);if(p){if(H&&!o(R))return;R=decodeURIComponent(R)}ve=R}else{var R=w[V][0],G=R.split("=",1)[0],R=R.substring(G.length+1);if(p){if(H&&!o(R))return;R=decodeURIComponent(R)}w[V][0]=R,ve=w[V]}if(p){if(H&&!o(G))return;G=decodeURIComponent(G)}ee[G]!==void 0?Array.isArray(ee[G])?ee[G].push(ve):ee[G]=[ee[G],ve]:ee[G]=ve}}Object.keys(ee).length==1&&ee[j]!==void 0?C[j]=ee[j]:C[j]=ee}else{if(p)for(var V=0;V<w.length;V++){var J=w[V];if(Array.isArray(J))for(var $e=0;$e<J.length;$e++){if(H&&!o(J[$e]))return;J[$e]=decodeURIComponent(J[$e])}else{if(H&&!o(J))return;w[V]=decodeURIComponent(J)}}C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(w):C[j]=[C[j]].concat(w):w.length==1&&!K.suffices["*"]?C[j]=w[0]:C[j]=w}}else{for(var w=h.length==1?[R]:R.split(c||","),ot={},x=0;x<w.length;x++){for(var Ce=0;Ce<h.length-1&&Ce<x&&!h[Ce].suffices["*"];Ce++);if(Ce==x){ot[x]=x;continue}else{for(var Pe=h.length-1;Pe>0&&h.length-Pe<w.length-x&&!h[Pe].suffices["*"];Pe--);if(h.length-Pe==w.length-x){ot[x]=Pe;continue}}ot[x]=Ce}for(var x=0;x<w.length;x++){var R=w[x];if(!(!R&&f)){var J=R.split(","),Z=!1;if(f){var R=J[0],j=R.split("=",1)[0],R=R.substring(j.length+1);J[0]=R;var K=O[j]||h[0]}else var K=h[ot[x]],j=K.name;for(var V=0;V<J.length;V++)if(p){if(H&&!o(J[V]))return;J[V]=decodeURIComponent(J[V])}(f||K.suffices["*"])&&C[j]!==void 0?Array.isArray(C[j])?C[j]=C[j].concat(J):C[j]=[C[j]].concat(J):J.length==1&&!K.suffices["*"]?C[j]=J[0]:C[j]=J}}}return 1};return{varNames:m,prefix:s,substitution:B,unSubstitution:ae}}function a(i){if(!(this instanceof a))return new a(i);for(var u=i.split("{"),c=[u.shift()],s=[],p=[],f=[],d=[];u.length>0;){var m=u.shift(),g=m.split("}")[0],h=m.substring(g.length+1),O=l(g);p.push(O.substitution),f.push(O.unSubstitution),s.push(O.prefix),c.push(h),d=d.concat(O.varNames)}this.fill=function(y){if(y&&typeof y!="function"){var A=y;y=function(F){return A[F]}}for(var b=c[0],P=0;P<p.length;P++){var M=p[P];b+=M(y),b+=c[P+1]}return b},this.fromUri=function(y,A){A=A||{};for(var b={},P=0;P<c.length;P++){var M=c[P];if(y.substring(0,M.length)!==M)return;if(y=y.substring(M.length),P>=c.length-1){if(y=="")break;return}var F=s[P];if(!(F&&y.substring(0,F.length)!==F)){for(var B=c[P+1],ae=P;;){if(ae==c.length-2){var R=y.substring(y.length-B.length);if(R!==B)return;var C=y.substring(0,y.length-B.length);y=R}else if(B){var H=y.indexOf(B),C=y.substring(0,H);y=y.substring(H)}else if(s[ae+1]){var H=y.indexOf(s[ae+1]);H===-1&&(H=y.length);var C=y.substring(0,H);y=y.substring(H)}else if(c.length>ae+2){ae++,B=c[ae+1];continue}else{var C=y;y=""}break}if(!f[P](C,b,A.strict))return}}return b},this.varNames=d,this.template=i}return a.prototype={toString:function(){return this.template},fillFromObject:function(i){return this.fill(i)},test:function(i,u){return!!this.fromUri(i,u)}},a})});import ze from"mithril";function v(n){return typeof n=="object"&&!Array.isArray(n)&&n!==null}function z(n,e,t){let r,o={},l;return typeof n=="string"?r=n:typeof n=="function"?l=n:n!=null&&(o=n),typeof e=="function"?l=e:e!=null&&(o=e),typeof t=="function"&&(l=t),typeof l=="undefined"&&(l=(a=>a.default(o))),[r,o,l]}import ge from"mithril";function ue(n,e,t){let r=Object.assign({},n),o={value:t.value};return pe("selection",r,e,t,o)}import Pn from"mithril";var ne=typeof window!="undefined";function k(){ne&&Pn.redraw()}var pr=Symbol.for("@pre"),fr=Symbol.for("@post");function jn(n,e){return n.parentArgs.store!==e.parentArgs.store||n.selector!==e.selector||n.parentArgs.value!==e.parentArgs.value}var st=n=>{let e=Symbol("SelectionRenderer"),t=!1,r=n.attrs,o,l={};function a(){let s=!1,p=o==null,f=[];if(o==null){let m=Reflect.ownKeys(l);for(let g of m)f.includes(g)||(s=!0,delete l[g]);s&&k();return}for(let m=0;m<o.result.length;m++){let g=o.result[m],h=Symbol.for(g.pointer);if(f.push(h),Object.hasOwn(l,h)){let A=g,b=l[h].selectionResult;if(b.type==="value"&&A.type==="value"&&A.value===b.value)continue;if(b.type==="entity"&&A.type==="entity"&&A.ok===b.ok&&A.status===b.status&&A.value===b.value)continue}s=!0;let O={index:m,value:g.value,propType:g.type==="entity"?void 0:g.propType},y=ue(r.args,r.parentArgs,O);l[h]={octiron:y,selectionResult:g}}let d=Reflect.ownKeys(l);for(let m of d)f.includes(m)||(s=!0,delete l[m]);!p&&s&&k()}function i(s){return E(this,null,function*(){if(console.log("SHOULD DEFER?",r.args.defer),s.length===0)return;if(!ne&&!r.args.mainEntity&&r.args.defer){t=!0;return}let p=[];for(let f of s)p.push(r.parentArgs.store.fetch(f,r.args.accept));yield Promise.allSettled(p)})}function u(s){let p=[];if(typeof o=="undefined")p=s.required;else for(let f of s.required)o.required.includes(f)||p.push(f);o=s,p.length>0&&i(p),a()}function c(){let{entity:s,selector:p,parentArgs:{value:f,store:d}}=r;if(!s&&!v(f)){d.unsubscribe(e),a();return}o=d.subscribe({key:e,selector:p,fragment:r.args.fragment,accept:r.args.accept,value:s?void 0:f,listener:u}),i(o.required),a()}return{oninit:({attrs:s})=>{r=s,c()},onbeforeupdate:({attrs:s})=>{let p=jn(s,r);r=s,p&&(s.parentArgs.store.unsubscribe(e),c())},onbeforeremove:({attrs:s})=>{r=s,s.parentArgs.store.unsubscribe(e)},view:({attrs:s})=>{if(t)return r.args.loading;if(o==null||!o.complete)return s.args.loading;if((o.hasErrors||o.hasMissing)&&typeof s.args.fallback!="function")return s.args.fallback;if(o.result[0]!=null&&o.result[0].type==="alternative")return o.result[0].integration.render(null,s.args.fragment);let p=s.view,{pre:f,sep:d,post:m,start:g,end:h,predicate:O,loading:y,fallback:A}=r.args,b=[],P=Reflect.ownKeys(l).map((M=>{let F=l[M];return F.octiron.position=-1,F}));(g!=null||h!=null)&&(P=P.slice(g!=null?g:0,h)),O!=null&&(P=P.filter(({octiron:M})=>O(M))),f!=null&&b.push(ge.fragment({},[f]));for(let M=0;M<P.length;M++){let{selectionResult:F,octiron:B}=P[M];B.position=M+1,M!==0&&b.push(ge.fragment({},[d])),F.type==="value"?b.push(ge.fragment({},[p(B)])):!F.ok&&typeof A=="function"?b.push(ge.fragment({},[A(B,F.reason)])):F.ok?b.push(ge.fragment({},[p(B)])):b.push(ge.fragment({},[A]))}return m!=null&&b.push(ge.fragment({},[m])),b}}};import Tn from"mithril";function _t({style:n,propType:e,type:t,firstPickComponent:r,typeDefs:o,fallbackComponent:l}){var a,i,u;if(r!=null)return r;if(e!=null&&((a=o[e])==null?void 0:a[n])!=null)return o[e][n];if(!Array.isArray(t)&&t!=null&&((i=o[t])==null?void 0:i[n])!=null)return o[t][n];if(Array.isArray(t)){for(let c of t)if(((u=o[c])==null?void 0:u[n])!=null)return o[c][n]}if(l!=null)return l}function je(n){if(v(n)){if(typeof n["@type"]=="string")return!0;if(!Array.isArray(n["@type"]))return!1}else return!1;for(let e of n["@type"])if(typeof e!="string")return!1;return!0}function lt(n){if(je(n))return n["@type"]}var Te=(n,e,t,r,o)=>{var c,s,p,f;let l=Object.assign({},(c=r==null?void 0:r.attrs)!=null?c:o==null?void 0:o.attrs),a=(s=r==null?void 0:r.component)!=null?s:(r==null?void 0:r.component)!==null?o==null?void 0:o.component:null,i=(p=r==null?void 0:r.fallbackComponent)!=null?p:(r==null?void 0:r.component)!==null?o==null?void 0:o.fallbackComponent:null,u=_t({style:n,propType:t==null?void 0:t.propType,type:lt(t.value),firstPickComponent:a,fallbackComponent:i,typeDefs:(f=r==null?void 0:r.typeDefs)!=null?f:e.typeDefs});return[l,u]};var zt=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=Te("present",t,r,n,e);return{view({attrs:{o:a,rendererArgs:i},children:u}){return l==null?null:Tn(l,{o:a,renderType:"present",value:i.value,attrs:o},u)}}};function Q(n){if(Array.isArray(n))return!0;if(v(n)){if(Array.isArray(n["@list"]))return!0;if(Array.isArray(n["@set"]))return!0}return!1}function re(n){return Array.isArray(n)?n:Array.isArray(n["@list"])?n["@list"]:Array.isArray(n["@set"])?n["@set"]:[]}import Mt from"mithril";function oe(n,e,t){let r="",o=n,l=0,a=-1;for(;(a=o.indexOf(e))>-1;)r+=n.substring(l,l+a)+t,o=o.substring(a+e.length,o.length),l+=a+e.length;return o.length>0&&(r+=n.substring(n.length-o.length,n.length)),r}function xn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(decodeURIComponent(n[e]),"~1","/"),"~0","~"):r[e]=n[e];return r}function In(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=encodeURIComponent(oe(oe(n[e],"~","~0"),"/","~1")):r[e]=n[e];return r}function Yt(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(n[e],"~1","/"),"~0","~"):r[e]=n[e];return r}function Jn(n){let e=-1,t=n.length,r=new Array(t);for(;++e<t;)typeof n[e]=="string"?r[e]=oe(oe(n[e],"~","~0"),"/","~1"):r[e]=n[e];return r}function En(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0)return[];if(n[0]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax. Non-empty pointer must begin with a solidus `/`.");return Yt(n.substring(1).split("/"))}function Be(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"":"/".concat(Jn(n).join("/"))}function kn(n){if(typeof n!="string")throw new TypeError("Invalid type: JSON Pointers are represented as strings.");if(n.length===0||n[0]!=="#")throw new ReferenceError("Invalid JSON Pointer syntax; URI fragment identifiers must begin with a hash.");if(n.length===1)return[];if(n[1]!=="/")throw new ReferenceError("Invalid JSON Pointer syntax.");return xn(n.substring(2).split("/"))}function xe(n){if(!n||n&&!Array.isArray(n))throw new TypeError("Invalid type: path must be an array of segments.");return n.length===0?"#":"#/".concat(In(n).join("/"))}var Rt="Invalid Relative JSON Pointer syntax. Relative pointer must begin with a non-negative integer, followed by either the number sign (#), or a JSON Pointer.";function Qt(n){if(typeof n!="string")throw new TypeError("Invalid type: Relative JSON Pointers are represented as strings.");if(n.length===0)throw new ReferenceError(Rt);let e=n.split("/"),t=e[0];if(t[t.length-1]=="#"){if(e.length>1)throw new ReferenceError(Rt);t=t.substr(0,t.length-1)}let r=-1,o=t.length;for(;++r<o;)if(t[r]<"0"||t[r]>"9")throw new ReferenceError(Rt);let l=Yt(e.slice(1));return l.unshift(e[0]),l}function jt(n,e){if(typeof e=="number")return e;let t=e.length;if(!t)return-1;let r=0;if(t===1&&e[0]==="-")return Array.isArray(n)?n.length:0;for(;++r<t;)if(e[r]<"0"||e[r]>"9")return-1;return parseInt(e,10)}function Nn(n){let e="if (typeof(it) !== 'undefined'";return n.length===0?t=>t:(e=n.reduce((t,r,o)=>t+`
	&& it !== null && typeof((it = it['`+oe(oe(n[o]+"","\\","\\\\"),"'","\\'")+"'])) !== 'undefined'","if (typeof(it) !== 'undefined'"),e=e+`) {
	return it;
 }`,new Function("it",e))}function Dn(n,e,t,r=!1){if(t.length===0)throw new Error("Cannot set the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot set values on undefined");let o=n,l=t.length,a=t.length-1,i,u=-1,c,s;for(;++u<l;){if(i=t[u],typeof i!="string"&&typeof i!="number")throw new TypeError("PathSegments must be a string or a number.");if(i==="__proto__"||i==="constructor"||i==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(o)){if(i==="-"&&u===a){o.push(e);return}if(s=jt(o,i),o.length>s){if(u===a){c=o[s],o[s]=e;break}o=o[s]}else if(u===a&&s===o.length){if(r){o.push(e);return}}else r&&(o=o[s]=u===a?e:{})}else{if(typeof o[i]=="undefined"){if(r){if(u===a){o[i]=e;return}let p=Number(t[u+1]);if(Number.isInteger(p)&&jt(o[i],p)!==-1){o=o[i]=[];continue}o=o[i]={};continue}return}if(u===a){c=o[i],o[i]=e;break}o=o[i]}}return c}function Mn(n,e){if(e.length===0)throw new Error("Cannot unset the root object; assign it directly.");if(typeof n=="undefined")throw new TypeError("Cannot unset values on undefined");let t=n,r=e.length,o=e.length-1,l,a=-1,i,u;for(;++a<r;){if(l=e[a],typeof l!="string"&&typeof l!="number")throw new TypeError("PathSegments must be a string or a number.");if(l==="__proto__"||l==="constructor"||l==="prototype")throw new Error("Attempted prototype pollution disallowed.");if(Array.isArray(t)){if(u=jt(t,l),u>=t.length)return;if(a===o){i=t[u],delete t[u];break}t=t[u]}else{if(typeof t[l]=="undefined")return;if(a===o){i=t[l],delete t[l];break}t=t[l]}}return i}function Vn(n){return typeof n=="string"&&n.length>0&&n[0]==="#"}function Zt(n){return Vn(n)?kn:En}function Xt(n){return Array.isArray(n)?n.slice(0):Zt(n)(n)}function Tt(n){return typeof n=="object"&&n!==null}function Ln(n){return Tt(n)&&!We.isReference(n)}function Ke(n,e,t){let r=new Map,o=[{obj:n,path:[]}];for(;o.length;){let{obj:l,path:a}=o.shift();if(e(t(a),l),Ln(l))if(r.set(l,new se(xe(a))),Array.isArray(l)){let i=-1,u=l.length;for(;++i<u;){let c=l[i];Tt(c)&&r.has(c)?o.push({obj:new We(r.get(c)),path:a.concat([i+""])}):o.push({obj:c,path:a.concat([i+""])})}}else{let i=Object.keys(l),u=i.length,c=-1;for(;++c<u;){let s=l[i[c]];Tt(s)&&r.has(s)?o.push({obj:new We(r.get(s)),path:a.concat(i[c])}):o.push({obj:s,path:a.concat(i[c])})}}}}var vt=Symbol("pointer"),Ct=Symbol("fragmentId"),Pt=Symbol("getter"),se=class n{constructor(e){this.path=Xt(e)}static create(e){return new n(e)}static has(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.has(e)}static get(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.get(e)}static set(e,t,r,o=!1){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.set(e,r,o)}static unset(e,t){return(typeof t=="string"||Array.isArray(t))&&(t=new n(t)),t.unset(e)}static decode(e){return Zt(e)(e)}static visit(e,t,r=!1){Ke(e,t,r?xe:Be)}static listPointers(e){let t=[];return Ke(e,(r,o)=>{t.push({pointer:r,value:o})},Be),t}static listFragmentIds(e){let t=[];return Ke(e,(r,o)=>{t.push({fragmentId:r,value:o})},xe),t}static flatten(e,t=!1){let r={};return Ke(e,(o,l)=>{r[o]=l},t?xe:Be),r}static map(e,t=!1){let r=new Map;return Ke(e,r.set.bind(r),t?xe:Be),r}get(e){return this[Pt]||(this[Pt]=Nn(this.path)),this[Pt](e)}set(e,t,r=!1){return Dn(e,t,this.path,r)}unset(e){return Mn(e,this.path)}has(e){return typeof this.get(e)!="undefined"}parent(e){let t=this.path;return t.length==1?void 0:new n(t.slice(0,t.length-1)).get(e)}relative(e){let t=this.path,r=Qt(e),o=parseInt(r[0]);if(o>t.length)throw new Error("Relative location does not exist.");let l=t.slice(0,t.length-o).concat(r.slice(1));if(r[0][r[0].length-1]=="#"){let a=l[l.length-1];throw new Error(`We won't compile a pointer that will always return '${a}'. Use JsonPointer.rel(target, ptr) instead.`)}return new n(l)}rel(e,t){let r=this.path,o=Qt(t),l=parseInt(o[0]);if(l>r.length)return;let a=r.slice(0,r.length-l).concat(o.slice(1)),i=new n(a);if(o[0][o[0].length-1]=="#"){let u=a[a.length-1],c=i.parent(e);return Array.isArray(c)?parseInt(u,10):u}return i.get(e)}concat(e){return new n(this.path.concat(e instanceof n?e.path:Xt(e)))}get pointer(){return this[vt]===void 0&&(this[vt]=Be(this.path)),this[vt]}get uriFragmentIdentifier(){return this[Ct]||(this[Ct]=xe(this.path)),this[Ct]}toString(){return this.pointer}},ct=Symbol("pointer"),We=class{constructor(e){this[ct]=e instanceof se?e:new se(e),this.$ref=this[ct].uriFragmentIdentifier}static isReference(e){if(!e)return!1;let t=e;return typeof t.$ref=="string"&&typeof t.resolve=="function"}resolve(e){return this[ct].get(e)}pointer(){return this[ct]}toString(){return this.$ref}};var xt=()=>{let n,e;function t(r){if(r.submitResult==null)n=void 0,e=void 0;else if(n==null||r.submitResult.ok!==n.ok||r.submitResult.status!==n.status||r.submitResult.value!==n.value){n=r.submitResult;let o={index:0,value:r.submitResult.value};e=ue(r.args,r.parentArgs,o)}}return{oninit:({attrs:r})=>{t(r)},onbeforeupdate:({attrs:r})=>{t(r)},view:c=>{var s=c,{attrs:p}=s,f=p,{type:r,selector:o,args:l,view:a}=f,i=de(f,["type","selector","args","view"]),{children:u}=s;if(r==="initial"&&n==null)return u;if(n==null||e==null)return null;let d=r==="success"&&n.ok||r==="failure"&&!n.ok;return i.not&&(d=!d),e.position=1,d&&o!=null?e.select(o,l,a):d&&a!=null?a(e):d&&l!=null?e.present(l):(e.position=-1,null)}}};var nn=Cn(tn());function It({payload:n,action:e}){let t,r,o="get",l,a,i=e["https://schema.org/target"];if(Array.isArray(i)){for(let f of i)if(f==="string"){i=f;break}else if(v(i)&&(i["https://schema.org/contentType"]==null||i["https://schema.org/contentType"]==="mutipart/form-data"||i["https://schema.org/contentType"]==="application/ld+json")){i=f;break}}if(typeof i=="string"?t=i:v(i)&&(typeof i["https://schema.org/urlTemplate"]=="string"&&(t=i["https://schema.org/urlTemplate"]),typeof i["https://schema.org/httpMethod"]=="string"&&(o=i["https://schema.org/httpMethod"].toLowerCase()),typeof i["https://schema.org/contentType"]=="string"&&(l=i["https://schema.org/contentType"]),typeof i["https://schema.org/encodingType"]=="string"&&(a=i["https://schema.org/encodingType"])),typeof t!="string")throw new Error("Action has invalid https://schema.org/target");let u={},c=Object.assign({},n);for(let[f,d]of Object.entries(e)){if(!je(d)||d["@type"]!=="https://schema.org/PropertyValueSpecification")continue;let m=d["https://schema.org/valueName"];if(m!=null){let g=f.replace(/-input$/,"");u[m]=n[g],delete c[m]}}let p=(0,nn.default)(t).fill(u);return o!=="get"&&o!=="delete"?r=JSON.stringify(c):(l=void 0,a=void 0),{url:p,method:o,contentType:l,encodingType:a,body:r}}import Jt from"mithril";import Hn from"mithril";var rn=({attrs:{args:n,factoryArgs:e,parentArgs:t,rendererArgs:r}})=>{let[o,l]=Te("edit",t,r,n,e);return{view({attrs:{o:a,rendererArgs:i},children:u}){return l==null?null:Hn(l,{o:a,attrs:o,renderType:"edit",name:a.inputName,value:i.value,spec:i.spec,onchange:i.update,onChange:i.update},u)}}};function ut(n,e){let t={};for(let[r,o]of Object.entries(e))t[n.expand(r)]=o;return t}function on(n,e,t){var a,i,u;let r=Object.assign({},n),o={action:e.action,submitting:e.submitting,value:t.value},l=pe("action-selection",r,e,t,o);return l.readonly=t.spec==null?!0:(a=t.spec.readonly)!=null?a:!1,l.inputName=((i=t.spec)==null?void 0:i.name)!=null?(u=t.spec)==null?void 0:u.name:t.propType,l.submitting=e.submitting,l.action=e.action,o.updatePointer=(c,s,p,f=r.interceptor)=>{var h;let d=t.value;if(!v(d)){console.warn("Non object action change intercepted.");return}let m=Object.assign({},d),g=se.create(c);s==null?g.unset(m):g.set(m,s,!0),typeof f=="function"&&(m=f(m,d,(h=t.actionValue)==null?void 0:h.value)),e.updatePointer(t.pointer,m,p)},l.update=(c,s)=>E(null,null,function*(){let p=t.value;if(!v(p))throw new Error("Cannot call update on a non object selection instance");typeof c=="function"?t.update(c(p)):c!=null&&t.update(c),s!=null&&s.submit||s!=null&&s.submitOnChange?yield e.submit():k()}),l.submit=()=>e.submit(),l.select=(c,s,p)=>{if(!v(t.value))return null;let[f,d,m]=z(c,s,p);return Jt(pt,{parentArgs:o,selector:f,value:t.value,actionValue:t.actionValue.value,args:d,view:m})},l.edit=c=>l.readonly?l.present(c):Jt(rn,{o:l,args:c,factoryArgs:r,parentArgs:e,rendererArgs:t}),l.default=c=>l.edit(Object.assign({component:null},c)),l.initial=e.action.initial,l.success=e.action.success,l.failure=e.action.failure,l.remove=(c={})=>{if(t.propType==null)return;let s=e.parent.value,p=s[t.propType];if(Q(p)){let f=re(p);f.splice(l.index,1),f.length===0&&delete s[t.propType]}else v(p)&&delete s[t.propType];k()},l.append=(c,s={},p={})=>{if(!v(t.value)){console.warn(`Attempt to append to non object octiron selection ${c}`);return}let f,d=e.store.expand(c),m=t.value[d];return v(s)&&(s=ut(l.store,s)),m==null?f=s:Array.isArray(m)?f=[...m,s]:f=[m,s],e.updatePointer(t.pointer,Object.assign({},t.value,{[d]:f}),p)},l}function sn(...n){return`${n.map(t=>t.replace(/~/g,"~0").replace(/\//g,"~1")).join("/")}`}function W(n){return v(n)&&typeof n["@id"]=="string"&&n["@id"]!==""}function fe(n){let e=Object.keys(n);if(e.length===0)return!1;for(let t of e)if(!t.startsWith("@")||t==="@value"||t==="@list"||t==="@set")return!1;return!0}function Ie(n){return typeof n["@value"]!="undefined"}var Fn=new RegExp("\\s*(?<subject>([^\\[\\s]+))(\\[(?<filter>([^\\]])+)\\])?\\s*","g");function Et(n,e){var o,l;let t,r=[];for(;t=Fn.exec(n);){let a=(o=t.groups)==null?void 0:o.subject,i=(l=t.groups)==null?void 0:l.filter;if(typeof i=="string"&&typeof a=="string")r.push({subject:e.expand(a),filter:i});else if(typeof a=="string")r.push({subject:e.expand(a)});else throw new Error(`Invalid selector: ${n}`)}return r}var Un=/^https?\:\/\//,ln=/^https?\:\/\/schema\.org/,$n=new RegExp("^https?\\:\\/\\/schema\\.org\\/(?<term>(readonlyValue|valueName|valueRequired|defaultValue|minValue|maxValue|stepValue|valuePattern|multipleValues|valueMinLength|valueMaxLength))");function cn({spec:n,store:e}){var l;let t={readonlyValue:!1,valueRequired:!1},r,o=e.vocab==null?!1:ln.test(e.vocab);for(let[a,i]of Object.entries(e.aliases))if(ln.test(i)){r=[a,i];break}for(let[a,i]of Object.entries(n)){let u;if(Un.test(a)?u=a:o&&!a.includes(":")?u=`${e.vocab}${a}`:r&&a.startsWith(`${r[0]}:`)&&(u=a.replace(`${r[0]}:`,r[1])),!u)continue;let c=$n.exec(u);(l=c==null?void 0:c.groups)!=null&&l.term&&(t[c.groups.term]=i)}return{readonly:t.readonlyValue,required:t.valueRequired,name:t.valueName,min:t.minValue,max:t.maxValue,step:t.stepValue,pattern:t.valuePattern,multiple:t.multipleValues,minLength:t.valueMinLength,maxLength:t.valueMaxLength}}var kt=class extends Error{};function an(n){for(let e=0;e<n.result.length;e++){let t=n.result[e];t.key=Symbol.for(t.keySource),delete t.keySource}return n}function Je({selector:n,value:e,fragment:t,accept:r,actionValue:o,defaultValue:l,store:a}){let i={selector:n,complete:!1,hasErrors:!1,hasMissing:!1,required:[],dependencies:[],result:[]};if(e==null){let[{subject:c,filter:s},...p]=Et(n,a),[f,d]=c.split("#");return _e({keySource:"",pointer:"",iri:f,fragment:d!=null?d:t,accept:r,filter:s,selector:p.length>0?p:void 0,store:a,details:i}),i.complete=i.required.length===0,an(i)}let u=Et(n,a);Ge({keySource:"",pointer:"",value:e,actionValue:o,selector:u,store:a,details:i,defaultValue:l}),i.complete=i.required.length===0;for(let c=0;c<i.result.length;c++){let s=i.result[c];s.key=Symbol.for(s.keySource)}return an(i)}function _(n,e){return`${n}/${sn(e.toString())}`}function Nt({value:n,filter:e}){return typeof e!="string"?!0:Array.isArray(n["@type"])?n["@type"].includes(e):n["@type"]===e}function Dt(n){return n!==null&&typeof n!="undefined"&&typeof n!="boolean"&&typeof n!="number"&&typeof n!="string"}function ft({keySource:n,pointer:e,value:t,propType:r,filter:o,spec:l,actionValue:a,store:i,details:u}){if(t===void 0){u.hasMissing=!0;return}else if(t===null&&v(a)){for(let c of Object.values(a))if(je(c)&&c["@type"]==="https://schema.org/PropertyValueSpecification")return}if(l!=null&&(!Q(t)||!v(a))){let c=cn({spec:l,store:i});v(t)&&Ie(t)&&(t=t["@value"]),u.result.push({keySource:e,pointer:e,type:"action-value",propType:r,value:t,actionValue:a,spec:c,readonly:c.readonly});return}if(Dt(t)){if(Q(t)){let c=re(t);for(let s=0;s<c.length;s++){let p=c[s];if(W(p)||(n=_(n,s)),ft({keySource:n,pointer:_(e,s),value:p,spec:l,actionValue:a,propType:r,filter:o,store:i,details:u}),u.hasErrors||u.hasMissing)return}return}}else{u.result.push({keySource:e,pointer:e,type:"value",propType:r,value:t});return}if(!(typeof o=="string"&&!Nt({value:t,filter:o}))){if(Ie(t)){ft({keySource:n,pointer:e,value:t["@value"],propType:r,store:i,details:u});return}else if(fe(t)){_e({keySource:n,pointer:e,iri:t["@id"],filter:o,store:i,details:u});return}if(W(t)){let c=t["@id"];u.result.push({keySource:n,pointer:e,type:"entity",iri:c,ok:!0,value:t});return}u.result.push({keySource:n,pointer:e,type:"value",propType:r,value:t})}}function un({keySource:n,pointer:e,propType:t,value:r,actionValue:o,filter:l,store:a,details:i}){if(e=_(e,t),!Dt(r))return;if(Q(r)){let c=re(r);for(let s=0;s<c.length;s++){let p=c[s];if(W(p)||(n=_(n,s)),un({keySource:n,pointer:_(e,s),propType:t,value:p,actionValue:o,filter:l,store:a,details:i}),i.hasErrors||i.hasMissing)return}return}if(fe(r)&&W(r)){_e({keySource:n,pointer:e,iri:r["@id"],selector:[{subject:t,filter:l}],store:a,details:i});return}else if(fe(r))return;let u;v(o)&&o[`${t}-input`]==null||(v(o)&&(u=o[`${t}-input`]),ft({keySource:n,pointer:e,value:r[t],spec:u,actionValue:o==null?void 0:o[t],propType:t,filter:l,store:a,details:i}))}function Ge({keySource:n,pointer:e,selector:t,value:r,actionValue:o,store:l,details:a,defaultValue:i}){if(t.length===0)return;if(!Dt(r))return;if(Q(r)){let d=re(r);for(let m=0;m<d.length;m++){let g=d[m];if(W(g)||(n=_(n,m)),Ge({keySource:n,pointer:_(e,m),selector:t,value:g,actionValue:o,store:l,details:a,defaultValue:i}),a.hasErrors||a.hasMissing)return}return}else Ie(r)&&Ge({keySource:n,pointer:e,selector:t,value:r["@value"],actionValue:o,store:l,details:a,defaultValue:i});if(fe(r)&&W(r)){_e({keySource:n,pointer:e,selector:t,iri:r["@id"],store:l,details:a});return}v(r)&&o!==void 0&&r[t[0].subject]==null&&(r={[t[0].subject]:i!=null?i:null});let[u,...c]=t,{subject:s,filter:p}=u;if(r[s]===void 0){a.hasMissing=!0;return}if(c.length===0&&v(o==null?void 0:o[s])){e=_(e,s),ft({keySource:e,pointer:e,value:r[s],propType:s,details:a,store:l,actionValue:o==null?void 0:o[s],spec:o[`${s}-input`],filter:p});return}else if(c.length===0){un({keySource:n,pointer:e,propType:s,filter:p,value:r,actionValue:o,store:l,details:a});return}if(typeof p=="string"&&!Nt({value:r,filter:p}))return;let f;v(o==null?void 0:o[s])&&(f=o[s]),Ge({keySource:_(n,s),pointer:_(e,s),selector:c,value:r[s],actionValue:f,store:l,details:a})}function _e({keySource:n,pointer:e,iri:t,fragment:r,accept:o,filter:l,selector:a,store:i,details:u,handledIRIs:c}){n=_(n,t),e=_(e,t);let s=i.entity(t,o);if(u.dependencies.push(t),s==null||s.loading){u.required.includes(t)||(u.required.push(t),u.accept=o,u.fragment=r);return}if(!s.ok){if(u.hasErrors=!0,a==null||a.length===0)return;u.result.push({keySource:n,pointer:e,type:"entity",iri:s.iri,ok:!1,status:s.status,value:s.value,reason:s.reason});return}if(s.type==="alternative-success"){u.result.push({keySource:n,pointer:e,type:"alternative",contentType:s.integration.contentType,integration:s.integration});return}let p=s.value;if(fe(p)){if(c==null)c=new Set([p["@id"]]);else if(!c.has(p["@id"]))c.add(p["@id"]);else throw new kt("Circular selection loop detected");return _e({keySource:n,pointer:e,iri:p["@id"],filter:l,selector:a,details:u,store:i,handledIRIs:c})}if(!(typeof l=="string"&&!Nt({filter:l,value:p}))){if(typeof a=="undefined"){u.result.push({keySource:n,pointer:e,type:"entity",iri:s.iri,ok:!0,value:s.value});return}Ge({keySource:n,pointer:e,value:p,selector:a,store:i,details:u})}}var pt=n=>{let e=n.attrs,t,r={};function o(){let a=!1,{parentArgs:i,selectionArgs:u}=e,c=[];for(let p=0;p<t.result.length;p++){let f=t.result[p];if(c.push(f.pointer),r[f.pointer]!=null){let{rendererArgs:y,octiron:A}=r[f.pointer],b=P=>i.updatePointer(f.pointer,P,u);y.value=A.value=f.value,y.spec=f.spec,y.update=b;continue}a=!0;let d=y=>i.updatePointer(f.pointer,y,u),m={index:p,value:f.actionValue,propType:f.propType},g=ue(e.args,i,m),h={index:p,update:d,actionValue:g,pointer:f.pointer,propType:f.propType,value:f.value,spec:f.spec},O=on(e.args,i,h);r[f.pointer]={rendererArgs:h,selection:g,octiron:O,selectionResult:f}}let s=Object.keys(r);for(let p of s)c.includes(p)||(a=!0,delete r[p]);a&&typeof window!="undefined"&&k()}function l(){let{selector:a,value:i,actionValue:u}=e,{store:c}=e.parentArgs;v(i)&&(t=Je({selector:a,store:c,actionValue:u,value:i,defaultValue:e.args.initialValue}),o())}return{oninit:({attrs:a})=>{e=a,l()},onbeforeupdate:({attrs:a})=>{e=a;for(let i of Object.values(r))i.octiron._updateArgs("args",a.args);l()},view:({attrs:{view:a,args:i}})=>{if(t==null)return null;let{pre:u,sep:c,post:s,fallback:p}=i;if(typeof a=="undefined")return;let f=Object.values(r),d=[u];for(let m=0;m<f.length;m++){let{octiron:g,selectionResult:h}=f[m];g.position=m+1,m!==0&&d.push(c),h.value==null&&typeof p=="function"?d.push(null):h.value==null&&p!=null?d.push(p):d.push(a(g))}return d.push(s),d}}};function pn(n,e,t){let r=Object.assign(Object.create(null),n),o=Object.create(null),l;v(n.initialValue)?o=ut(e.store,n.initialValue):n.initialValue!=null&&console.warn("o.perform() only supports receiving JSON objects as initial values.");function a(){return E(this,null,function*(){let{url:d,method:m,body:g,contentType:h,encodingType:O}=It({payload:o,action:t.value,store:e.store});s.submitting=!0,s.url=new URL(d,s.store.rootIRI),k();try{l=yield e.store.submit(d,{method:m,body:g,contentType:h,encodingType:O})}catch(y){console.error(y)}s.submitting=!1,k()})}function i(d){let m=o,g=$($({},m),d);typeof n.interceptor=="function"?o=n.interceptor(g,m,e.parent.value):o=g,c.value=s.value=d,k()}let c={value:o,submitting:!1,submit:a,updatePointer:(d,m,g)=>{let h=Object.assign({},o),O=se.create(d);m==null?O.unset(h):O.set(h,m,!0),i(h)}},s=pe("action",r,e,t,c);s.value=o,s.action=e.parent,s.actionValue=t.actionValue,c.action=s,c.submitting=s.submitting,s.select=(d,m,g)=>{let[h,O,y]=z(d,m,g);return Mt(pt,{parentArgs:c,selector:h,value:s.value,actionValue:e.parent.value,args:O,view:y})},s.submit=function(d){return E(this,null,function*(){return typeof d=="function"?i(d(o)):d!=null&&i(d),yield a()})},s.update=function(d,m){return E(this,null,function*(){typeof d=="function"?i(d(o)):d!=null&&i(d),m!=null&&m.submit||m!=null&&m.submitOnChange?yield a():k()})},s.append=(d,m={},g={})=>{let h=e.store.expand(d);if(!v(s.value))return;let O=s.value[h],y=[];return O!=null&&!Array.isArray(O)?y.push(O):Array.isArray(O)&&(y=[...O.filter(A=>A!=null)]),y.push(m),s.update(te($({},s.value),{[h]:y}),g)};let p=d=>m=>Mt(xt,{not:d,type:"initial",args:{},submitResult:l,parentArgs:c},m),f=(d,m)=>(g,h,O)=>{let[y,A,b]=z(g,h,O);return Mt(xt,{not:m,type:d,selector:y,args:A,view:b,submitResult:l,parentArgs:c})};s.initial=p(),s.not.initial=p(!0),s.success=f("success"),s.not.success=f("success",!0),s.failure=f("failure"),s.not.failure=f("failure",!0);try{let d=It({payload:s.value,action:t.value,store:e.store});s.url=new URL(d.url),s.method=d.method}catch(d){console.error(d)}return s.url!=null&&(l=e.store.entity(s.url.toString())),(typeof window=="undefined"&&n.submitOnInit&&l==null||typeof window!="undefined"&&n.submitOnInit)&&s.submit(),s}var fn=({attrs:n})=>{let e=Symbol("PerformRenderer"),t=n,r,o={};function l(){let c=!1,{args:s,parentArgs:p}=t,f=[];for(let m=0;m<r.result.length;m++){let g=r.result[m];if(f.push(g.pointer),Object.hasOwn(o,g.pointer)){let b=g,P=o[g.pointer].selectionResult;if(P.type==="value"&&b.type==="value"&&b.value===P.value)continue;if(P.type==="entity"&&b.type==="entity"&&(b.ok!==P.ok||b.status!==P.status||b.value!==P.value))continue;continue}c=!0;let h={index:m,value:g.value},O=ue(s,p,h),y={index:m,value:g.value,actionValue:O},A=pn(s,p,y);o[g.pointer]={action:A,octiron:O,selectionResult:g}}let d=Object.keys(o);for(let m of d)f.includes(m)||(c=!0,delete o[m]);c&&k()}function a(c){return E(this,null,function*(){if(c.length===0)return;let s=[];for(let p of c)s.push(t.parentArgs.store.fetch(p));yield Promise.allSettled(s)})}function i(c){let s=[];if(typeof r=="undefined")s=c.required;else for(let p of c.required)r.required.includes(p)||s.push(p);r=c,s.length>0&&a(s),l()}function u(){let{selector:c,parentArgs:s}=t;if(c==null){let p;W(s.parent.value)?p={pointer:"/local",key:Symbol.for("/local"),type:"entity",iri:s.parent.value["@id"],ok:!0,value:s.parent.value}:p={pointer:"/local",key:Symbol.for("/local"),type:"value",value:s.parent.value},r={selector:"",complete:!0,hasErrors:!1,hasMissing:!1,dependencies:[],required:[],result:[p]}}else r=s.store.subscribe({key:e,selector:c,value:s.parent.value,listener:i}),a(r.required);l()}return{oninit:({attrs:c})=>{t=c,u()},onbeforeupdate:({attrs:c})=>{c.selector!==t.selector&&(c.parentArgs.store.unsubscribe(e),u()),t=c;for(let s of Object.values(o))s.action._updateArgs("args",c.args)},onbeforeremove:({attrs:c})=>{t=c,c.parentArgs.store.unsubscribe(e)},view:({attrs:{view:c,args:s}})=>{if(r==null||!r.complete)return s.loading;let{pre:p,sep:f,post:d,fallback:m}=s;if(typeof c=="undefined")return;let g=Object.values(o),h=[p];for(let O=0;O<g.length;O++){let{selectionResult:y,action:A,octiron:b}=g[O];A.position=O+1,O!==0&&h.push(f),y.type==="value"?h.push(c(A)):!y.ok&&typeof m=="function"?h.push(m(b,y.reason)):y.ok?h.push(c(A)):h.push(m)}return h.push(d),h}}};var ye={root:0,selection:1,action:2,"action-selection":3};function pe(n,e,t,r={},o={}){var c,s,p,f,d,m;let l=ye[n],a=W(r.value)?r.value["@id"]:(c=r.propType)!=null?c:"octiron",i={[a]:(g,h)=>g(i)?h:null}[a];i.id=t.store.key(),i.isOctiron=!0,i.octironType=n,i.readonly=!0,i.value=(s=r.value)!=null?s:null,i.store=t.store,i.index=(p=r.index)!=null?p:0,i.position=-1,i.expand=g=>t.store.expand(g),o.parent=i,o.store=(f=e.store)!=null?f:t.store,o.typeDefs=(d=e.typeDefs)!=null?d:t.typeDefs,l!==ye.root&&(i.propType=r.propType,i.dataType=lt(r.value)),i.not=(g,h)=>i==null||g(i)?null:h,i.get=g=>{var y,A;if(!v(i.value))return null;if(g.startsWith("@"))return i.value[g];let h=i.store.expand(g),O=(y=i.value[h])!=null?y:null;return Q(O)?re(O):(A=i.value[h])!=null?A:null},i.enter=(g,h,O)=>{let[y,A,b]=z(g,h,O);return ze(st,{entity:!0,selector:y,args:A,view:b,parentArgs:o})};let u=te($({},o),{value:(m=t.store.entity(t.store.rootIRI))==null?void 0:m.value});switch(i.root=(g,h,O)=>{let y,[A,b,P]=z(g,h,O);return A==null?y=t.store.rootIRI:y=`${t.store.rootIRI} ${A}`,ze(st,{entity:!0,selector:y,args:b,view:P,parentArgs:u})},l){case ye.root:i.select=i.root;break;case ye.selection:i.select=(g,h,O)=>{let[y,A,b]=z(g,h,O);return v(r.value)?ze(st,{selector:y,args:A,view:b,parentArgs:o}):null}}switch(l){case ye.root:i.present=i.root;break;default:i.present=g=>ze(zt,{o:i,args:g,factoryArgs:e,parentArgs:t,rendererArgs:r})}switch(i.default=g=>i.present(Object.assign({component:null},g)),l){case ye.root:i.perform=(g,h,O)=>{let[y,A,b]=z(g,h,O);return i.root(y,A,P=>P.perform(A,b))};break;default:{i.perform=(g,h,O)=>{let[y,A,b]=z(g,h,O);return typeof y=="string"?i.select(y,A,P=>P.perform(A,b)):ze(fn,{selector:y,args:A,view:b,parentArgs:o})};break}}if(l!==ye.root){let g=(h,O)=>{let y=h==="args"?e:h==="parent"?t:r;for(let A of Object.keys(y))delete y[A];for(let[A,b]of Object.entries(O))y[A]=b};i._updateArgs=g}return i}function Vt(n){return pe("root",{},n)}import Lt from"mithril";import{processTemplate as Ht}from"@longform/longform";function qn(n){let e="";for(let t=0;t<n.length;t++)e+=n[t].outerHTML;return e}var Bn=()=>{let n,e;function t(o){var u;if(n===o.fragment)return;if(n=o.fragment,o.fragment==null){e=o.output.root;return}let[l,a]=o.fragment.split("?");if(a==null){e=(u=o.output.fragments[l])==null?void 0:u.html;return}let i=o.output.templates[l];if(i!=null)try{let c=Object.fromEntries(new URLSearchParams(a));e=Ht(i,c,s=>{var p;return(p=o.output.fragments[s])==null?void 0:p.html})}catch(c){console.error(c)}}function r(o){if(o.fragment==null){if(o.output.root!=null&&o.output.dom==null){let c=document.createElement("template");c.innerHTML=o.output.root,o.output.dom=Array.from(c.content.children)}e=o.output.dom;return}let[l,a]=o.fragment.split("?");if(!(a!=null||o.output.templates[l]!=null)){let c=o.output.fragments[l];if(c==null)return;if(c.type==="text"){e=c.html;return}else if(c.dom==null&&c.html!=null){let s=document.createElement("template");s.innerHTML=c.html,c.dom=Array.from(s.content.children)}else if(c.dom==null)return;e=c.dom;return}let u=o.output.templates[l];if(u!=null)try{let c=Object.fromEntries(new URLSearchParams(a));e=Ht(u,c,s=>{var p;return o.output.fragments[s]!=null&&o.output.fragments[s].html==null&&o.output.fragments[s].dom!=null&&(o.output.fragments[s].html=qn(o.output.fragments[s].dom)),(p=o.output.fragments[s])==null?void 0:p.html})}catch(c){console.error(c)}}return{oninit({attrs:o}){ne?r(o):t(o)},view(){return ne&&Array.isArray(e)?Lt.dom(e):typeof e=="string"?Lt.trust(e):null}}},Ee,ke,he,Se,dt,D,Ne,mt,gt=class gt{constructor(e,{iri:t,contentType:r,output:o}){I(this,Ne);Ot(this,"integrationType","html-fragments");I(this,Ee,!1);I(this,ke,new Set);I(this,he);I(this,Se);I(this,dt);I(this,D);N(this,dt,e),N(this,he,t),N(this,Se,r),N(this,D,o)}get iri(){return S(this,he)}get contentType(){return S(this,Se)}get output(){return S(this,D)}getFragment(e){var t,r,o;return e!=null?(r=(t=S(this,D).fragments[e])==null?void 0:t.html)!=null?r:null:(o=S(this,D).root)!=null?o:null}text(e){if(e==null)return this.output.root==null&&S(this,D).dom&&(this.output.root=q(this,Ne,mt).call(this,S(this,D).dom)),this.output.root;let[t,r]=e.split("?");if(r==null){let l=S(this,D).fragments[t];return l==null?void 0:(l.html==null&&l.dom&&(l.html=q(this,Ne,mt).call(this,l.dom)),l.html)}let o=S(this,D).templates[t];if(o!=null)try{let l=Object.fromEntries(new URLSearchParams(r));return Ht(o,l,a=>{let i=S(this,D).fragments[a];if(i!=null)return i.html==null&&i.dom!=null&&(i.html=q(this,Ne,mt).call(this,i.dom)),i.html})}catch(l){console.error(l)}}render(e,t){return ne||(t==null?N(this,Ee,!0):S(this,ke).add(t)),Lt(Bn,{o:e,integration:this,fragment:t,output:S(this,D)})}getStateInfo(){let e={},t=[],r=Object.values(S(this,D).fragments);for(let o=0;o<r.length;o++)r[o].type==="text"?e[r[o].id]=r[o].html:t.push({id:r[o].id,type:r[o].type,selector:r[o].selector,rendered:S(this,ke).has(r[o].id)});return{iri:S(this,he),contentType:S(this,Se),rendered:S(this,Ee),selector:S(this,D).selector,templates:S(this,D).templates,texts:e,fragments:t}}toInitialState(){let e="",t=Object.values(S(this,D).fragments);S(this,D).root!=null&&!S(this,Ee)&&(e+=`<template id="htmlfrag:${S(this,he)}|${S(this,Se)}">${S(this,D).root}</template>
`);for(let r=0;r<t.length;r++)t[r].type!=="text"&&(S(this,ke).has(t[r].id)||(e+=`<template data-htmlfrag="${t[r].id}">${t[r].html}</template>
`));return e}static fromInitialState(e,{iri:t,contentType:r,rendered:o,selector:l,texts:a,fragments:i,templates:u}){let c=Object.create(null);if(c.fragments=Object.create(null),c.templates=u,l!=null&&o){let p=document.querySelector(l);p!=null&&(c.root=p.outerHTML)}else if(l!=null){let p=document.getElementById(`htmlfrag:${t}|${r}`);c.root=p==null?void 0:p.textContent}let s=Object.entries(a);for(let p=0;p<s.length;p++)c.fragments[s[p][0]]={id:s[p][0],type:"text",html:s[p][1],selector:""};for(let p=0;p<i.length;p++){let f=i[p],d=document.createDocumentFragment();if(f.rendered){let m;switch(f.type){case"embed":{if(m=document.getElementById(f.id),m==null)break;c.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"bare":{if(m=document.querySelector(f.selector),m==null)break;c.fragments[f.id]={id:f.id,type:f.type,dom:[m],selector:f.selector};break}case"range":{let g=document.querySelectorAll(f.selector);c.fragments[f.id]={id:f.id,type:f.type,selector:f.selector,dom:Array.from(g)}}}}else{let m=document.querySelector(`[data-htmlfrag="${f.id}"]`);if(m==null)continue;c.fragments[f.id]={id:f.id,type:f.type,dom:Array.from(m.content.children),selector:f.selector}}}return new gt(e,{contentType:r,iri:t,output:c})}};Ee=new WeakMap,ke=new WeakMap,he=new WeakMap,Se=new WeakMap,dt=new WeakMap,D=new WeakMap,Ne=new WeakSet,mt=function(e){let t="";for(let r=0;r<e.children.length;r++)t+=e.children[r].outerHTML;return t},Ot(gt,"type","html-fragments");var De=gt;var Me,Qe,yt=class{constructor(e,t){I(this,Me);I(this,Qe);N(this,Me,e),N(this,Qe,t)}get status(){return S(this,Me)}get res(){return S(this,Qe)}undefined(){return null}http(e){return typeof e=="function"?e(S(this,Me)):e}unparserable(){return null}};Me=new WeakMap,Qe=new WeakMap;function Ve(n,e=[]){if(Array.isArray(n))for(let t of n)Ve(t,e);else if(v(n)){if(fe(n))return e;if(W(n)&&e.push(n),Ie(n))Ve(n["@value"],e);else if(Q(n))Ve(re(n),e);else for(let[t,r]of Object.entries(n))t.startsWith("@")||Ve(r,e)}return e}var Ae="application/problem+json, application/ld+json",Kn={[De.type]:De};function Wn(n,e){let t=new Map,r={};if(n!=null&&(r["@vocab"]=n),e==null)return[t,r];for(let[o,l]of Object.entries(e))r[o]=l,t.set(o,l);return[t,r]}function Gn(n,e){let t=new Headers([["accept",Ae]]),r=new Map;if(n!=null)for(let[o,l]of Object.entries(n))t.set(o,l);if(e!=null)for(let[o,l]of Object.entries(e)){let a=new Headers([["accept",Ae]]);for(let[i,u]of Object.entries(l))a.set(i,u);r.set(o,a)}return[t,r]}var Ye,Ze,le,be,Oe,Le,X,He,me,et,tt,nt,rt,Fe,Ue,ie,we,ce,U,Ft,Ut,$t,mn,qt,Xe=class Xe{constructor(e){I(this,U);I(this,Ye);I(this,Ze);I(this,le);I(this,be);I(this,Oe);I(this,Le);I(this,X,new Map);I(this,He,new Set);I(this,me,new Map);I(this,et);I(this,tt,new Set);I(this,nt);I(this,rt,new Map);I(this,Fe);I(this,Ue);I(this,ie,new Map);I(this,we,new Map);I(this,ce,new Map);var t,r;N(this,Ye,e.rootIRI),N(this,Ze,new URL(e.rootIRI).origin),N(this,Oe,e.vocab),N(this,Fe,e.fetcher),N(this,Ue,e.responseHook),[qe(this,le)._,qe(this,be)._]=Gn(e.headers,e.origins),[qe(this,Le)._,qe(this,nt)._]=Wn(e.vocab,e.aliases),N(this,et,new Map((r=(t=e.handlers)==null?void 0:t.map)==null?void 0:r.call(t,o=>[o.contentType,o]))),e.primary!=null&&N(this,X,new Map(Object.entries(e.primary))),S(this,le).has("accept")||S(this,le).set("accept",Ae);for(let o of Object.values(S(this,be)))o.has("accept")||o.set("accept",Ae);if(e.acceptMap!=null)for(let[o,l]of Object.entries(e.acceptMap))S(this,ce).set(o,new Map(l));e.alternatives!=null&&N(this,me,e.alternatives)}get rootIRI(){return S(this,Ye)}entity(e,t){var l,a,i,u;if(t==null)return(l=S(this,X).get(e))!=null?l:null;let r=(i=(a=S(this,ce).get(e))==null?void 0:a.get)==null?void 0:i.call(a,t);if(r==null)return null;let o=(u=S(this,me).get(r))==null?void 0:u.get(e);return o==null?null:{type:"alternative-success",iri:e,loading:!1,ok:!0,integration:o}}text(e,t){let[r,o]=e.split("#"),l=this.entity(r,t);if(l!=null&&(l==null?void 0:l.type)==="alternative-success")return l.integration.text(o)}get vocab(){return S(this,Oe)}get aliases(){return Object.fromEntries(S(this,Le).entries().map(([e,t])=>[e.replace(/^/,""),t]))}get context(){return S(this,nt)}expand(e){let t=Symbol.for(e),r=S(this,rt).get(t);if(r!=null)return r;let o;if(S(this,Oe)!=null&&!/^[\w\d]+\:/.test(e))o=S(this,Oe)+e;else if(/https?:\/\//.test(e))o=e;else for(let[l,a]of S(this,Le)){let i=new RegExp(`^${l}:`);if(i.test(e)){o=e.replace(i,a);break}}return S(this,rt).set(t,o!=null?o:e),o!=null?o:e}select(e,t,{accept:r}={}){return Je({selector:e,value:t,accept:r,store:this})}key(){for(;;){let e=`oct-${Math.random().toString(36).slice(2,7)}`;if(!S(this,tt).has(e))return S(this,tt).add(e),e}}isLoading(e){let t=q(this,U,Ut).call(this,e,"get");return S(this,He).has(t)}handleResponse(r){return E(this,arguments,function*(e,t=e.url.toString()){var a,i,u;let o=(u=(i=(a=e.headers.get("content-type"))==null?void 0:a.split)==null?void 0:i.call(a,";"))==null?void 0:u[0];if(o==null)throw new Error("Content type not specified in response");let l=S(this,et).get(o);if(l==null)throw new Error(`No handler configured for content type "${o}"`);if(l.integrationType==="jsonld"){let c=yield l.handler({res:e,store:this});q(this,U,mn).call(this,{iri:t,res:e,output:c})}else{if(l.integrationType==="problem-details")throw new Error("Problem details response types not supported yet");if(l.integrationType==="html-fragments"){let c=yield l.handler({res:e,store:this}),s=S(this,me).get(o);s==null&&(s=new Map,S(this,me).set(o,s)),s.set(t,new De(l,{iri:t,contentType:o,output:c}))}}l.integrationType!=="jsonld"&&q(this,U,$t).call(this,t,o)})}subscribe({key:e,selector:t,fragment:r,accept:o,value:l,listener:a}){let i=Je({selector:t,fragment:r,accept:o,value:l,store:this}),u=q(this,U,Ft).call(this,e,i);for(let c of i.dependencies){let s=S(this,ie).get(c);s==null?S(this,ie).set(c,new Set([e])):s.add(e)}return S(this,we).set(e,{key:e,selector:t,value:l,fragment:r,accept:o,required:i.required,dependencies:i.dependencies,listener:a,cleanup:u}),i}unsubscribe(e){var t;(t=S(this,we).get(e))==null||t.cleanup()}fetch(e,t){return E(this,null,function*(){return yield q(this,U,qt).call(this,e,{accept:t}),S(this,X).get(e)})}submit(e,t){return E(this,null,function*(){return yield q(this,U,qt).call(this,e,te($({},t),{contentType:"application/ld+json"})),this.entity(e)})}static fromInitialState({disableLogs:e,rootIRI:t,vocab:r,aliases:o,headers:l,origins:a,handlers:i=[]}){performance.mark("octiron:from-initial-state:start");let u={rootIRI:t,vocab:r,aliases:o,handlers:i,headers:l,origins:a};try{let c=document.getElementById("oct-state");if(c==null)return e||console.warn("Failed to construct Octiron state from initial state"),new Xe(u);let s=JSON.parse(c.innerText),p=new Map,f=i.reduce((m,g)=>te($({},m),{[g.contentType]:g}),{});for(let[m,g]of Object.entries(s.alternatives))for(let h of g){let O=f[h.contentType],y=Kn[m];if(y.type!==O.integrationType)continue;let A=y.fromInitialState(O,h);if(A==null)continue;let b=p.get(A.contentType);b==null&&(b=new Map,p.set(A.contentType,b)),b.set(A.iri,A)}let d=new Xe(te($({},u),{alternatives:p,primary:s.primary,acceptMap:s.acceptMap}));return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),d}catch(c){e||(console.warn("Failed to construct Octiron state from initial state"),console.error(c));let s=new Xe(u);return performance.mark("octiron:from-initial-state:end"),performance.measure("octiron:from-initial-state:duration","octiron:from-initial-state:start","octiron:from-initial-state:end"),s}}toInitialState(){let e="",t={primary:Object.fromEntries(S(this,X)),alternatives:{},acceptMap:{}};for(let[r,o]of S(this,ce).entries())t.acceptMap[r]=Array.from(o.entries());for(let r of S(this,me).values())for(let o of r.values())t.alternatives[o.integrationType]==null?t.alternatives[o.integrationType]=[o.getStateInfo()]:t.alternatives[o.integrationType].push(o.getStateInfo()),e+=o.toInitialState();return e+=`<script id="oct-state" type="application/json">${JSON.stringify(t)}<\/script>`,e}};Ye=new WeakMap,Ze=new WeakMap,le=new WeakMap,be=new WeakMap,Oe=new WeakMap,Le=new WeakMap,X=new WeakMap,He=new WeakMap,me=new WeakMap,et=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,ie=new WeakMap,we=new WeakMap,ce=new WeakMap,U=new WeakSet,Ft=function(e,t){return()=>{S(this,we).delete(e);for(let r of t.dependencies)S(this,ie).delete(r),ne&&setTimeout(()=>{var o;((o=S(this,ie).get(r))==null?void 0:o.size)===0&&S(this,X).delete(r)},5e3)}},Ut=function(e,t,r){var o;return r=(o=r!=null?r:S(this,le).get("accept"))!=null?o:Ae,`${t==null?void 0:t.toLowerCase()}|${e}|${r.toLowerCase()}`},$t=function(e,t){let r=S(this,ie).get(e);if(r!=null)for(let o of r){let l=S(this,we).get(o);if(l==null)continue;let a=Je({selector:l.selector,value:l.value,fragment:l.fragment,accept:l.accept,store:this}),i=q(this,U,Ft).call(this,o,a);for(let u of a.dependencies){let c=S(this,ie).get(u);c==null?(c=new Set([o]),S(this,ie).set(u,c)):c.add(o)}l.cleanup=i,l.listener(a)}},mn=function({iri:e,res:t,output:r}){let o=[e];if(t.ok)S(this,X).set(e,{type:"entity-success",iri:e,loading:!1,ok:!0,value:r.jsonld});else{let l=new yt(t.status,t);S(this,X).set(e,{type:"entity-failure",iri:e,loading:!1,ok:!1,value:r.jsonld,status:t.status,reason:l})}for(let l of Ve(r.jsonld))o.includes(l["@id"])||S(this,X).set(l["@id"],{type:"entity-success",iri:l["@id"],loading:!1,ok:!0,value:l});for(let l of o)q(this,U,$t).call(this,l)},qt=function(r){return E(this,arguments,function*(e,t={}){var p,f;let o,l=new URL(e),a=t.method||"get",i=(f=(p=t.accept)!=null?p:S(this,le).get("accept"))!=null?f:Ae;l.hash="";let u=l.toString(),c=q(this,U,Ut).call(this,u,a,t.accept);if(l.origin===S(this,Ze))o=new Headers(S(this,le));else if(S(this,be).has(l.origin))o=new Headers(S(this,be).get(l.origin));else throw new Error("Unconfigured origin");t.body!=null&&t.contentType!=null&&o.set("content-type",t.contentType),i!=null?o.set("accept",i):o.get("accept")==null&&o.set("accept",Ae),S(this,He).add(c),k();let s=new Promise(d=>{E(this,null,function*(){var g;let m=null;S(this,Fe)!=null?m=yield S(this,Fe).call(this,u,{method:a,headers:o,body:t.body}):m=yield fetch(u,{method:a,headers:o,body:t.body}),t.accept!=null&&S(this,ce).has(u)?(g=S(this,ce).get(u))==null||g.set(t.accept,m.headers.get("content-type")):t.accept!=null&&S(this,ce).set(u,new Map([[t.accept,m.headers.get("content-type")]])),yield this.handleResponse(m,e),S(this,He).delete(c),k(),d(m)})});S(this,Ue)!=null&&S(this,Ue).call(this,s),yield s})};var Re=Xe;function Bt(n,...e){let t={};if(n instanceof Re)for(let r of e)t[n.expand(r.type)]=r;else{t[n.type]=n;for(let r of e)t[r.type]=r}return t}function dn(...n){let e=[];for(let t of n)if(!(typeof t=="undefined"||t===null))if(typeof t=="string")e.push(t);else if(Array.isArray(t))for(let r of t)e.push(r);else for(let[r,o]of Object.entries(t))o&&e.push(r);return e.join(" ")}function Ti(n){return n}import gn from"jsonld";var Ei={integrationType:"jsonld",contentType:"application/ld+json",handler:e=>E(null,[e],function*({res:n}){let t=yield n.json();if(!v(t)&&!Array.isArray(t))throw new Error("JSON-LD Document should be an object");let r=yield gn.expand(t,{documentLoader:l=>E(null,null,function*(){let i=yield(yield fetch(l,{headers:{accept:"application/ld+json"}})).json();return{documentUrl:l,document:i}})});return{jsonld:yield gn.compact(r,{})}})};import{longform as _n}from"@longform/longform";var Mi={integrationType:"html-fragments",contentType:"text/longform",handler:e=>E(null,[e],function*({res:n}){return _n(yield n.text())})};import T from"mithril";var Kt=()=>{function n(i){return T("code",[T("span.oct-json-quote",'"'),T("a.oct-json-iri",{href:i},i),T("span.oct-json-quote",'"')])}function e(i){let u=typeof i=="boolean"?"oct-json-boolean":typeof i=="number"?"oct-json-number":"oct-json-string",c;return typeof i=="boolean"&&i?c="true":typeof i=="boolean"||(typeof i=="string"?c=[T("span.oct-json-quote",'"'),i,T("span.oct-json-quote",'"')]:c=i),T("code",{className:u},c)}function t(i,u,c=""){let s=[];for(let p=0;p<i.length;p++){let f=i[p];s.push(T("li.oct-json-arr-item",l(null,f,u,c)))}return T("ul.oct-json-arr",s)}let r=["@id","@type","@context"];function o(i,u,c=""){let s=[],p=Object.entries(i).toSorted();for(let f=0;f<p.length;f++){let[d,m]=p[f],g,h=[T("span.oct-json-quote",'"'),T("span.oct-json-obj-key",d),T("span.oct-json-quote",'"'),T("span.oct-json-obj-colon",": ")];if(d==="@id")g=[T("code",h),n(m)];else if(u==null||r.includes(d))g=l(h,m);else if(d.startsWith("@"))g=l(h,m,u,c);else{let O=`${c} ${d}`,y=new URL(u);y.searchParams.set("selector",O);let A=[T("span.oct-json-quote",'"'),T("span.oct-json-obj-key",T("a",{href:y},d)),T("span.oct-json-quote",'"'),T("span.oct-json-obj-colon",": ")];g=l(A,m,u,O)}s.push(T("li.oct-json-obj-item",g))}return T("ul.oct-json-obj",s)}function l(i,u,c,s=""){return v(u)?[T("details.oct-json-details",{open:!0},T("summary.oct-json-details-sum",T("code",i,T("span.oct-json-obj-open","{"))),a(u,c,s)),T("code.oct-json-obj-close","}")]:Array.isArray(u)?[T("details.oct-json-details",{open:!0},T("summary.oct-json-details-sum",T("code",i,T("span.oct-json-obj-open","["))),a(u,c,s)),T("code.oct-json-obj-close","]")]:[T("code",i),a(u,c,s)]}function a(i,u,c=""){return v(i)?o(i,u,c):Array.isArray(i)?t(i,u,c):e(i)}return{view:({attrs:{value:i,selector:u,location:c}})=>{let s=c!=null?new URL(c):void 0;return T(".oct-json",[l(null,i,s,typeof u=="string"?u.trim():void 0)])}}};import Y from"mithril";var ht=({attrs:n})=>{var c;let e=n,t=n.o.value,r,o=(c=n.initialPresentationStyle)!=null?c:"value";function l(s=!0){let{o:p}=e;o==="value"?r=Y(Kt,{value:t,selector:e.selector,location:e.location}):o==="action-value"&&(p.octironType==="action"||p.octironType==="action-selection")&&(r=Y(Kt,{value:p.actionValue.value,selector:e.selector,location:e.location})),s&&k()}function a(s){s.redraw=!1,o="value",l()}function i(s){s.redraw=!1,o="action-value",l()}function u(s){s.redraw=!1,o="component",l()}return{oninit:({attrs:s})=>{e=s,l(!1)},onbeforeupdate:({attrs:s})=>{s.o.value!==t&&(t=s.o.value,l(!0))},view:({attrs:{o:s,availableControls:p}})=>{let f,d,m=[];return o==="component"?f=Y(".oct-debug-body",s.default()):f=Y(".oct-debug-body",r),(s.octironType==="action"||s.octironType==="action-selection")&&(d=Y("button.oct-button",{type:"button",onclick:i},"Action value")),p==null||p.includes("value")?m.push(Y("button.oct-button",{type:"button",onclick:a},"Value")):d!=null&&(p==null||p.includes("action-value"))?m.push(d):p==null||p.includes("component")?m.push(Y("button.oct-button",{type:"button",onclick:u},"Component")):(p==null||p.includes("log"))&&m.push(Y("button.oct-button",{type:"button",onclick:()=>console.debug(s)},"Log")),Y("aside.oct-debug",Y(".oct-debug-controls",Y(".oct-button-group",...m)),f)}}};import L from"mithril";var _i=({attrs:n})=>{let e=n.selector||"",t=e,r=e,o=n.presentationStyle||"debug",l=n.onChange,a={view:({attrs:{o:f}})=>L(ht,{o:f,location:n.location})};function i(f){e=f.target.value}function u(f){f.key==="Enter"&&c()}function c(){r=e,typeof l=="function"&&l(r,o)}function s(f){f.preventDefault(),o="debug",typeof l=="function"&&l(r,o)}function p(f){f.preventDefault(),o="components",typeof l=="function"&&l(r,o)}return{oninit:({attrs:f})=>{l=f.onChange},onbeforeupdate:({attrs:f})=>{var d;r=(d=f.selector)!=null?d:"",r!==t&&(e=t=r),l=f.onChange},view:({attrs:{autofocus:f,o:d}})=>{var y,A;let m,g,h,O;if(r.length!==0&&o==="debug"?m=d.root(r,b=>L(ht,{o:b,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?[]:void 0})):r.length!==0?m=d.root(r,b=>L("div",b.default({fallbackComponent:a,attrs:{selector:r}}))):o==="debug"?m=d.root(b=>L(ht,{o:b,selector:r,location:n.location,initialPresentaionStyle:n.presentationStyle,availableControls:n.childControls?void 0:[]})):m=d.root(b=>L("div",b.default({fallbackComponent:a,attrs:{selector:r}}))),n.location!=null&&r.length!==0){let b=n.selector.trim().includes(" ")?n.selector.replace(/\s+([^\s]+)$/,""):"";g=new URL(n.location),b!=null?g.searchParams.set("selector",b):g.searchParams.delete("selector")}return n.location!=null&&(h=new URL(n.location),O=new URL(n.location),h.searchParams.set("presentationStyle","debug"),O.searchParams.set("presentationStyle","components")),L(".oct-explorer",L(".oct-explorer-controls",L("form.oct-form-group",{action:(A=(y=n.location)==null?void 0:y.toString)==null?void 0:A.call(y),onsubmit:b=>{b.preventDefault(),c()}},[g!=null?L("a.oct-button",{href:g.toString()},"Up"):L("button.oct-button",{type:"button",disabled:!0},"Up"),L("input",{name:"selector",value:e,autofocus:f,oninput:i,onkeypress:u}),L("button.oct-button",{type:"submit",disabled:r===e&&typeof window!="undefined"},"Apply")]),L(".oct-button-group",o==="debug"||h==null?L("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:s},"Debug"):L("a.oct-button",{href:h.toString(),onclick:s},"Debug"),o==="components"||O==null?L("button.oct-button",{type:"button",disabled:typeof window=="undefined",onclick:p},"Components"):L("a.oct-button",{href:O.toString(),onclick:p},"Components"))),L("pre.oct-explorer-body",m))}}};import zn from"mithril";var Xi=n=>{var o;let t=((o=n.attrs.o.method)==null?void 0:o.toUpperCase())||"POST",r={GET:"application/x-www-form-urlencoded",POST:"multipart/form-data"};return{view:u=>{var c=u,{attrs:s}=c,p=s,{o:l}=p,a=de(p,["o"]),{children:i}=c;return zn("form.oct-form",te($({},a),{method:t,enctype:r[t||"GET"],action:l.url,onsubmit:f=>{f.preventDefault(),l.submit()}}),i)}}};import Qn from"mithril";var ns=()=>({view:({attrs:n,children:e})=>Qn("button.oct-button.oct-submit-button",{id:n.id,type:"submit",class:dn(n.class)},e)});function yn(t){var r=t,{typeDefs:n}=r,e=de(r,["typeDefs"]);let o=new Re(e),l=n!=null?Bt(o,...n):{};return Vt({store:o,typeDefs:l})}yn.fromInitialState=t=>{var r=t,{typeDefs:n}=r,e=de(r,["typeDefs"]);let o=Re.fromInitialState($({},e)),l=n!=null?Bt(o,...n):{};return Vt({store:o,typeDefs:l})};export{ht as OctironDebug,_i as OctironExplorer,Xi as OctironForm,Kt as OctironJSON,ns as OctironSubmitButton,Re as Store,dn as classes,yn as default,Ei as jsonLDHandler,Mi as longformHandler,Ti as makeTypeDef,Bt as makeTypeDefs};
//# sourceMappingURL=octiron.min.js.map
